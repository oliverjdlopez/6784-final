{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.32660969090995506}, "default_policy": {"total_loss": 0.32660969090995506, "policy_loss": 0.07668667628334513, "vf_loss": 10.0, "vf_loss_unclipped": 22128.29731226679, "vf_explained_var": -0.00046682834371066553, "entropy": 8.692080396070663, "mean_kl_loss": 0.49974337811884517, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 373.5151283924191, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 10709.047, "sample_time_ms": 7331.608, "synch_weights_time_ms": 1.463}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "0bf95_00000", "date": "2023-12-14_19-30-09", "timestamp": 1702600209, "time_this_iter_s": 10.710519075393677, "time_total_s": 10.710519075393677, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10.710519075393677, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.49375, "ram_util_percent": 83.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.40012499976005633}, "default_policy": {"total_loss": 0.40012499976005633, "policy_loss": 0.06741367241711235, "vf_loss": 9.999480851423511, "vf_loss_unclipped": 23534.7311350613, "vf_explained_var": -0.0001952090243032492, "entropy": 8.357662498823869, "mean_kl_loss": 0.5171478043910045, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 640.9982342496876, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8474.65, "sample_time_ms": 5098.537, "synch_weights_time_ms": 1.689}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "0bf95_00000", "date": "2023-12-14_19-30-15", "timestamp": 1702600215, "time_this_iter_s": 6.241645812988281, "time_total_s": 16.952164888381958, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 16.952164888381958, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.55555555555555, "ram_util_percent": 83.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24430691403175978}, "default_policy": {"total_loss": 0.24430691403175978, "policy_loss": -0.0028288511758936302, "vf_loss": 10.0, "vf_loss_unclipped": 22967.431715585022, "vf_explained_var": -8.09877793163633e-05, "entropy": 8.345045800910576, "mean_kl_loss": 0.2179789116073932, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0125000476837158}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 654.0899157959258, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 7688.218, "sample_time_ms": 4327.591, "synch_weights_time_ms": 1.64}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "0bf95_00000", "date": "2023-12-14_19-30-22", "timestamp": 1702600222, "time_this_iter_s": 6.116904973983765, "time_total_s": 23.069069862365723, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 23.069069862365723, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.9375, "ram_util_percent": 82.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3102826391741919}, "default_policy": {"total_loss": 0.3102826391741919, "policy_loss": 0.012712627329351281, "vf_loss": 10.0, "vf_loss_unclipped": 23737.49608542111, "vf_explained_var": 0.0001215339342414189, "entropy": 8.172719505550003, "mean_kl_loss": 0.195130870445693, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 650.0707098268487, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 7304.454, "sample_time_ms": 3949.25, "synch_weights_time_ms": 1.594}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "0bf95_00000", "date": "2023-12-14_19-30-28", "timestamp": 1702600228, "time_this_iter_s": 6.154553174972534, "time_total_s": 29.223623037338257, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 29.223623037338257, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.299999999999997, "ram_util_percent": 82.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24049648119093003}, "default_policy": {"total_loss": 0.24049648119093003, "policy_loss": -0.0116911469804826, "vf_loss": 9.998494807082707, "vf_loss_unclipped": 20978.596891033114, "vf_explained_var": 0.00010075872895051676, "entropy": 8.137292676388837, "mean_kl_loss": 0.10021575451143451, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.278125047683716}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 658.8158235494271, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 7057.861, "sample_time_ms": 3710.985, "synch_weights_time_ms": 1.575}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "0bf95_00000", "date": "2023-12-14_19-30-34", "timestamp": 1702600234, "time_this_iter_s": 6.0725321769714355, "time_total_s": 35.29615521430969, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 35.29615521430969, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.788888888888888, "ram_util_percent": 83.15555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2838922503755799}, "default_policy": {"total_loss": 0.2838922503755799, "policy_loss": -0.019638228153726504, "vf_loss": 10.0, "vf_loss_unclipped": 31497.074148995536, "vf_explained_var": 0.0005538291387212302, "entropy": 8.113235152860694, "mean_kl_loss": 0.08934122490365731, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 3.4171876907348633}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 665.9803839803631, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 6882.58, "sample_time_ms": 3538.043, "synch_weights_time_ms": 1.546}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "0bf95_00000", "date": "2023-12-14_19-30-40", "timestamp": 1702600240, "time_this_iter_s": 6.007349014282227, "time_total_s": 41.30350422859192, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 41.30350422859192, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.8375, "ram_util_percent": 82.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5561139231869406}, "default_policy": {"total_loss": 0.5561139231869406, "policy_loss": 0.007654586168470731, "vf_loss": 10.0, "vf_loss_unclipped": 40329.75636327292, "vf_explained_var": -5.3928922742668756e-05, "entropy": 7.992571076350425, "mean_kl_loss": 0.13123637921384612, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 5.125781536102295}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 659.2536913625125, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 6766.133, "sample_time_ms": 3423.367, "synch_weights_time_ms": 1.575}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "0bf95_00000", "date": "2023-12-14_19-30-46", "timestamp": 1702600246, "time_this_iter_s": 6.068710803985596, "time_total_s": 47.372215032577515, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 47.372215032577515, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.822222222222223, "ram_util_percent": 82.74444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3166268916685444}, "default_policy": {"total_loss": 0.3166268916685444, "policy_loss": -0.0366320868523152, "vf_loss": 10.0, "vf_loss_unclipped": 50131.47174007196, "vf_explained_var": -0.0001202427756303409, "entropy": 8.071305055862297, "mean_kl_loss": 0.049408851316256296, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 7.688672065734863}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 652.0785927845519, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 6687.142, "sample_time_ms": 3345.022, "synch_weights_time_ms": 1.584}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "0bf95_00000", "date": "2023-12-14_19-30-52", "timestamp": 1702600252, "time_this_iter_s": 6.135554075241089, "time_total_s": 53.5077691078186, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 53.5077691078186, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.533333333333335, "ram_util_percent": 82.87777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2846082920299918}, "default_policy": {"total_loss": 0.2846082920299918, "policy_loss": -0.036333864454233616, "vf_loss": 10.0, "vf_loss_unclipped": 57152.02843067031, "vf_explained_var": -2.847132143943803e-05, "entropy": 8.07442510356781, "mean_kl_loss": 0.02873606173124766, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 11.533008575439453}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 652.3146588228689, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 6625.46, "sample_time_ms": 3283.769, "synch_weights_time_ms": 1.568}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "0bf95_00000", "date": "2023-12-14_19-30-58", "timestamp": 1702600258, "time_this_iter_s": 6.133210897445679, "time_total_s": 59.64098000526428, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 59.64098000526428, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.050000000000004, "ram_util_percent": 82.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7839078308740405}, "default_policy": {"total_loss": 0.7839078308740405, "policy_loss": -0.0008909247828268213, "vf_loss": 10.0, "vf_loss_unclipped": 63881.124677255466, "vf_explained_var": -3.8890187928417343e-05, "entropy": 8.062222470098467, "mean_kl_loss": 0.05937728673810569, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.29951286315918}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 646.3250822679528, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 6581.797, "sample_time_ms": 3240.145, "synch_weights_time_ms": 1.564}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "0bf95_00000", "date": "2023-12-14_19-31-04", "timestamp": 1702600264, "time_this_iter_s": 6.190343856811523, "time_total_s": 65.8313238620758, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 65.8313238620758, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.28888888888889, "ram_util_percent": 82.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.29943152638608966}, "default_policy": {"total_loss": 0.29943152638608966, "policy_loss": -0.022819386836864165, "vf_loss": 10.0, "vf_loss_unclipped": 60323.251245169246, "vf_explained_var": -0.00010765069074976419, "entropy": 8.054126115241793, "mean_kl_loss": 0.012847235393448562, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.29951286315918}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 650.8809475047241, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 6125.443, "sample_time_ms": 2788.098, "synch_weights_time_ms": 1.564}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "0bf95_00000", "date": "2023-12-14_19-31-11", "timestamp": 1702600271, "time_this_iter_s": 6.146775722503662, "time_total_s": 71.97809958457947, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 71.97809958457947, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.911111111111108, "ram_util_percent": 82.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5870515930849606}, "default_policy": {"total_loss": 0.5870515930849606, "policy_loss": -0.006546785662780756, "vf_loss": 10.0, "vf_loss_unclipped": 61088.303613073025, "vf_explained_var": 7.2580410727559885e-06, "entropy": 8.006356464011837, "mean_kl_loss": 0.028532501522152285, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.949268341064453}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 642.7707079784722, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 6123.722, "sample_time_ms": 2789.883, "synch_weights_time_ms": 1.561}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "0bf95_00000", "date": "2023-12-14_19-31-17", "timestamp": 1702600277, "time_this_iter_s": 6.224440097808838, "time_total_s": 78.2025396823883, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 78.2025396823883, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.11111111111111, "ram_util_percent": 82.62222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2788291844064747}, "default_policy": {"total_loss": 0.2788291844064747, "policy_loss": -0.02516054199250943, "vf_loss": 10.0, "vf_loss_unclipped": 36412.08852674407, "vf_explained_var": 9.501603112291934e-06, "entropy": 7.963760704882364, "mean_kl_loss": 0.00786109757799709, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.949268341064453}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 632.8517141188694, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 6144.246, "sample_time_ms": 2789.388, "synch_weights_time_ms": 1.563}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "0bf95_00000", "date": "2023-12-14_19-31-23", "timestamp": 1702600283, "time_this_iter_s": 6.321744918823242, "time_total_s": 84.52428460121155, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 84.52428460121155, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 36.544444444444444, "ram_util_percent": 82.47777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.37061799012585234}, "default_policy": {"total_loss": 0.37061799012585234, "policy_loss": -0.02404061161743195, "vf_loss": 10.0, "vf_loss_unclipped": 31090.793140533384, "vf_explained_var": 8.846040981919018e-05, "entropy": 7.942697927641716, "mean_kl_loss": 0.011355179811677262, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.949268341064453}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 615.3733295050125, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 6178.939, "sample_time_ms": 2807.299, "synch_weights_time_ms": 1.635}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "0bf95_00000", "date": "2023-12-14_19-31-30", "timestamp": 1702600290, "time_this_iter_s": 6.502237796783447, "time_total_s": 91.026522397995, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 91.026522397995, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 32.53333333333333, "ram_util_percent": 82.68888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2529878102814846}, "default_policy": {"total_loss": 0.2529878102814846, "policy_loss": -0.020695528366726074, "vf_loss": 10.0, "vf_loss_unclipped": 20183.48102990905, "vf_explained_var": 2.4612969172788834e-05, "entropy": 7.887603090770209, "mean_kl_loss": 0.006693188462504661, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.949268341064453}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 648.2013503756926, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 6188.88, "sample_time_ms": 2815.333, "synch_weights_time_ms": 1.64}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "0bf95_00000", "date": "2023-12-14_19-31-36", "timestamp": 1702600296, "time_this_iter_s": 6.172017335891724, "time_total_s": 97.19853973388672, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 97.19853973388672, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.74444444444445, "ram_util_percent": 83.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2658893636215343}, "default_policy": {"total_loss": 0.2658893636215343, "policy_loss": -0.014546874410677344, "vf_loss": 9.999910852802333, "vf_loss_unclipped": 20325.356849263728, "vf_explained_var": 5.754275616806453e-05, "entropy": 7.842183503006567, "mean_kl_loss": 0.006953457425916451, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.949268341064453}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 654.8843135230484, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 6199.057, "sample_time_ms": 2829.839, "synch_weights_time_ms": 1.658}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "0bf95_00000", "date": "2023-12-14_19-31-42", "timestamp": 1702600302, "time_this_iter_s": 6.109047174453735, "time_total_s": 103.30758690834045, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 103.30758690834045, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 33.44444444444444, "ram_util_percent": 83.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4765491964164446}, "default_policy": {"total_loss": 0.4765491964164446, "policy_loss": -0.01444454965437812, "vf_loss": 9.997477673772556, "vf_loss_unclipped": 19807.496483125666, "vf_explained_var": -3.191136093790343e-06, "entropy": 7.851025667271888, "mean_kl_loss": 0.015068593346173125, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.949268341064453}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 644.4395192251922, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 6213.005, "sample_time_ms": 2833.434, "synch_weights_time_ms": 1.67}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "0bf95_00000", "date": "2023-12-14_19-31-48", "timestamp": 1702600308, "time_this_iter_s": 6.208630084991455, "time_total_s": 109.51621699333191, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 109.51621699333191, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 33.37777777777777, "ram_util_percent": 82.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22921847695433129}, "default_policy": {"total_loss": 0.22921847695433129, "policy_loss": -0.00939760093084737, "vf_loss": 10.0, "vf_loss_unclipped": 19837.021177247134, "vf_explained_var": 1.3658741135587062e-05, "entropy": 7.856302724464108, "mean_kl_loss": 0.005341810787068602, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.949268341064453}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.57660741466367, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 6458.733, "sample_time_ms": 3073.201, "synch_weights_time_ms": 1.654}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 18, "trial_id": "0bf95_00000", "date": "2023-12-14_19-31-57", "timestamp": 1702600317, "time_this_iter_s": 8.593111038208008, "time_total_s": 118.10932803153992, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 118.10932803153992, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.958333333333332, "ram_util_percent": 83.44166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.0112484057606665}, "default_policy": {"total_loss": 3.0112484057606665, "policy_loss": 0.024108844252227785, "vf_loss": 10.0, "vf_loss_unclipped": 23185.44703033382, "vf_explained_var": -2.8892684338697747e-05, "entropy": 7.770145908347579, "mean_kl_loss": 0.11126092376945229, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 634.4112930335905, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 76000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 6476.038, "sample_time_ms": 3084.79, "synch_weights_time_ms": 1.663}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 19, "trial_id": "0bf95_00000", "date": "2023-12-14_19-32-03", "timestamp": 1702600323, "time_this_iter_s": 6.306790828704834, "time_total_s": 124.41611886024475, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 124.41611886024475, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 28.84444444444445, "ram_util_percent": 83.34444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4778783020895046}, "default_policy": {"total_loss": 0.4778783020895046, "policy_loss": -0.006688463158095315, "vf_loss": 9.996376571370595, "vf_loss_unclipped": 15233.666746485207, "vf_explained_var": -1.6926956583441957e-06, "entropy": 7.7997915353348, "mean_kl_loss": 0.009880894642963168, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 658.1140530666025, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 80000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 6464.952, "sample_time_ms": 3080.156, "synch_weights_time_ms": 1.668}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 20, "trial_id": "0bf95_00000", "date": "2023-12-14_19-32-09", "timestamp": 1702600329, "time_this_iter_s": 6.079560279846191, "time_total_s": 130.49567914009094, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 130.49567914009094, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 31.0875, "ram_util_percent": 82.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7323558211469574}, "default_policy": {"total_loss": 0.7323558211469574, "policy_loss": -0.005073016391260855, "vf_loss": 9.997815328366212, "vf_loss_unclipped": 15211.183806136727, "vf_explained_var": -2.3910358770569758e-05, "entropy": 7.8148651666986915, "mean_kl_loss": 0.016376843311141486, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 625.2418788826259, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 84000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 6490.152, "sample_time_ms": 3081.199, "synch_weights_time_ms": 1.721}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 21, "trial_id": "0bf95_00000", "date": "2023-12-14_19-32-16", "timestamp": 1702600336, "time_this_iter_s": 6.3995959758758545, "time_total_s": 136.8952751159668, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 136.8952751159668, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 28.55, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2848461269458601}, "default_policy": {"total_loss": 0.2848461269458601, "policy_loss": -0.01666145040236636, "vf_loss": 9.997541107348543, "vf_loss_unclipped": 11656.191708172308, "vf_explained_var": -0.0001310329320334168, "entropy": 7.801036667976298, "mean_kl_loss": 0.005177594022088457, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 645.9666606641092, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 88000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 6487.073, "sample_time_ms": 3081.076, "synch_weights_time_ms": 1.686}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 22, "trial_id": "0bf95_00000", "date": "2023-12-14_19-32-22", "timestamp": 1702600342, "time_this_iter_s": 6.1937360763549805, "time_total_s": 143.08901119232178, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 143.08901119232178, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 34.2125, "ram_util_percent": 82.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4049944778892404}, "default_policy": {"total_loss": 0.4049944778892404, "policy_loss": -0.011872911574577155, "vf_loss": 10.0, "vf_loss_unclipped": 15718.817398429172, "vf_explained_var": -0.0001950161670570943, "entropy": 7.813020735661358, "mean_kl_loss": 0.008140688860639358, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 660.0738555575402, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 92000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 6461.007, "sample_time_ms": 3080.363, "synch_weights_time_ms": 1.687}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 23, "trial_id": "0bf95_00000", "date": "2023-12-14_19-32-28", "timestamp": 1702600348, "time_this_iter_s": 6.061134099960327, "time_total_s": 149.1501452922821, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 149.1501452922821, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.144444444444446, "ram_util_percent": 82.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6303392104995149}, "default_policy": {"total_loss": 0.6303392104995149, "policy_loss": -0.013473001246684109, "vf_loss": 10.0, "vf_loss_unclipped": 24801.34799565232, "vf_explained_var": -0.000209728601390619, "entropy": 7.852597505044836, "mean_kl_loss": 0.013971163078834684, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 642.3009675545903, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 96000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 6433.757, "sample_time_ms": 3068.197, "synch_weights_time_ms": 1.682}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 24, "trial_id": "0bf95_00000", "date": "2023-12-14_19-32-34", "timestamp": 1702600354, "time_this_iter_s": 6.228961706161499, "time_total_s": 155.3791069984436, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 155.3791069984436, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 31.700000000000003, "ram_util_percent": 82.36666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5302348953447362}, "default_policy": {"total_loss": 0.5302348953447362, "policy_loss": -0.017372493129988103, "vf_loss": 10.0, "vf_loss_unclipped": 39802.99661847015, "vf_explained_var": 0.00011602787574979543, "entropy": 7.870358676036029, "mean_kl_loss": 0.01149954989889519, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 640.4465515926365, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 100000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 6441.23, "sample_time_ms": 3067.073, "synch_weights_time_ms": 1.686}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 25, "trial_id": "0bf95_00000", "date": "2023-12-14_19-32-40", "timestamp": 1702600360, "time_this_iter_s": 6.246942043304443, "time_total_s": 161.62604904174805, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 161.62604904174805, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 30.533333333333335, "ram_util_percent": 82.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.40431493990965234}, "default_policy": {"total_loss": 0.40431493990965234, "policy_loss": -0.017112587984186658, "vf_loss": 10.0, "vf_loss_unclipped": 37127.64649478612, "vf_explained_var": -3.156542523837547e-05, "entropy": 7.861071699463737, "mean_kl_loss": 0.008257843844028506, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 618.0710265243993, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 104000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 6477.608, "sample_time_ms": 3071.606, "synch_weights_time_ms": 1.718}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 26, "trial_id": "0bf95_00000", "date": "2023-12-14_19-32-47", "timestamp": 1702600367, "time_this_iter_s": 6.47334098815918, "time_total_s": 168.09939002990723, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 168.09939002990723, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.411111111111115, "ram_util_percent": 82.32222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.35840041528759736}, "default_policy": {"total_loss": 0.35840041528759736, "policy_loss": -0.01729050321804324, "vf_loss": 10.0, "vf_loss_unclipped": 48035.929050339815, "vf_explained_var": 4.894564400857954e-05, "entropy": 7.86982374760642, "mean_kl_loss": 0.0070828175494733235, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 600.6756395097487, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 108000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 6522.831, "sample_time_ms": 3087.405, "synch_weights_time_ms": 1.695}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 27, "trial_id": "0bf95_00000", "date": "2023-12-14_19-32-54", "timestamp": 1702600374, "time_this_iter_s": 6.660607099533081, "time_total_s": 174.7599971294403, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 174.7599971294403, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 32.769999999999996, "ram_util_percent": 81.67}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3022891146097102}, "default_policy": {"total_loss": 0.3022891146097102, "policy_loss": -0.016184418988940335, "vf_loss": 10.0, "vf_loss_unclipped": 52836.34719607876, "vf_explained_var": 5.730897632997427e-05, "entropy": 7.866539225649478, "mean_kl_loss": 0.005612837062000723, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 581.6642122118928, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 6351.362, "sample_time_ms": 2906.962, "synch_weights_time_ms": 1.726}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 28, "trial_id": "0bf95_00000", "date": "2023-12-14_19-33-00", "timestamp": 1702600380, "time_this_iter_s": 6.878329753875732, "time_total_s": 181.63832688331604, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 181.63832688331604, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 38.333333333333336, "ram_util_percent": 82.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4086668816075396}, "default_policy": {"total_loss": 0.4086668816075396, "policy_loss": -0.017089029649463194, "vf_loss": 10.0, "vf_loss_unclipped": 48534.86093666711, "vf_explained_var": 4.2104835449251286e-05, "entropy": 7.8628547628805325, "mean_kl_loss": 0.008369044980954912, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 614.7095683989783, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 116000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 6371.57, "sample_time_ms": 2924.533, "synch_weights_time_ms": 1.724}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 29, "trial_id": "0bf95_00000", "date": "2023-12-14_19-33-07", "timestamp": 1702600387, "time_this_iter_s": 6.508444786071777, "time_total_s": 188.14677166938782, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 188.14677166938782, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 28.919999999999998, "ram_util_percent": 82.37}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.33576821788414707}, "default_policy": {"total_loss": 0.33576821788414707, "policy_loss": -0.015282681320053237, "vf_loss": 10.0, "vf_loss_unclipped": 38486.16468612573, "vf_explained_var": -2.5056191344759358e-05, "entropy": 7.8767719375553416, "mean_kl_loss": 0.0064497871731322865, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 623.5104064728592, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 120000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 6405.302, "sample_time_ms": 2931.419, "synch_weights_time_ms": 1.711}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 30, "trial_id": "0bf95_00000", "date": "2023-12-14_19-33-13", "timestamp": 1702600393, "time_this_iter_s": 6.416620969772339, "time_total_s": 194.56339263916016, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 194.56339263916016, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 33.76666666666667, "ram_util_percent": 82.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3179136246268048}, "default_policy": {"total_loss": 0.3179136246268048, "policy_loss": -0.019238214086451287, "vf_loss": 10.0, "vf_loss_unclipped": 23494.552502207156, "vf_explained_var": -4.189316906146149e-05, "entropy": 7.839013838818841, "mean_kl_loss": 0.00609270441306931, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.92390441894531}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 639.7390956622419, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 124000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 6390.804, "sample_time_ms": 2929.475, "synch_weights_time_ms": 1.697}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 31, "trial_id": "0bf95_00000", "date": "2023-12-14_19-33-20", "timestamp": 1702600400, "time_this_iter_s": 6.25437593460083, "time_total_s": 200.817768573761, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 200.817768573761, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 32.83333333333333, "ram_util_percent": 82.12222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2399137062288678}, "default_policy": {"total_loss": 0.2399137062288678, "policy_loss": -0.01862508382053494, "vf_loss": 9.994436120681925, "vf_loss_unclipped": 6292.398995861062, "vf_explained_var": -0.00013580244741460154, "entropy": 7.785589155611961, "mean_kl_loss": 0.004074473913562527, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.461952209472656}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 643.0692140470695, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 128000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 6393.594, "sample_time_ms": 2930.301, "synch_weights_time_ms": 1.71}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 32, "trial_id": "0bf95_00000", "date": "2023-12-14_19-33-26", "timestamp": 1702600406, "time_this_iter_s": 6.221668004989624, "time_total_s": 207.0394365787506, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 207.0394365787506, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 34.02222222222221, "ram_util_percent": 82.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2683866230298334}, "default_policy": {"total_loss": 0.2683866230298334, "policy_loss": -0.02486074393861361, "vf_loss": 9.997745360392752, "vf_loss_unclipped": 6989.861395797241, "vf_explained_var": -0.00012940130254098856, "entropy": 7.766896972778255, "mean_kl_loss": 0.009930654118470711, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.461952209472656}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 634.0838369964806, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 132000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 6418.431, "sample_time_ms": 2937.392, "synch_weights_time_ms": 1.704}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 33, "trial_id": "0bf95_00000", "date": "2023-12-14_19-33-32", "timestamp": 1702600412, "time_this_iter_s": 6.309633016586304, "time_total_s": 213.3490695953369, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 213.3490695953369, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 34.34444444444445, "ram_util_percent": 82.75555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.33784884880823113}, "default_policy": {"total_loss": 0.33784884880823113, "policy_loss": -0.023019763705100237, "vf_loss": 10.0, "vf_loss_unclipped": 7024.6961511152385, "vf_explained_var": 3.287221577121759e-05, "entropy": 7.73698669710139, "mean_kl_loss": 0.013404031256841472, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.461952209472656}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 644.2827658710336, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 136000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 6416.515, "sample_time_ms": 2929.137, "synch_weights_time_ms": 1.665}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 34, "trial_id": "0bf95_00000", "date": "2023-12-14_19-33-38", "timestamp": 1702600418, "time_this_iter_s": 6.210074186325073, "time_total_s": 219.559143781662, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 219.559143781662, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 33.875, "ram_util_percent": 81.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.41109913425531974}, "default_policy": {"total_loss": 0.41109913425531974, "policy_loss": -0.013560709425373308, "vf_loss": 9.11451509359803, "vf_loss_unclipped": 924.9969769012191, "vf_explained_var": -0.0023253880329986115, "entropy": 7.738380820003908, "mean_kl_loss": 0.017136754411830456, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.461952209472656}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}}, "episode_reward_max": -301284.22671343246, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -302680.2835292098, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871], "episode_lengths": [35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19482726411837206, "mean_inference_ms": 0.9747273703223582, "mean_action_processing_ms": 0.04843433930911553, "mean_env_wait_ms": 0.3654333072345637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.14992952346801758}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 669.446113793042, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 140000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 6389.46, "sample_time_ms": 2918.866, "synch_weights_time_ms": 1.645}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 35, "trial_id": "0bf95_00000", "date": "2023-12-14_19-33-44", "timestamp": 1702600424, "time_this_iter_s": 5.976346969604492, "time_total_s": 225.53549075126648, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 225.53549075126648, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 29.555555555555557, "ram_util_percent": 80.4111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3697545619677506}, "default_policy": {"total_loss": 0.3697545619677506, "policy_loss": -0.014387812143239354, "vf_loss": 9.115173145143716, "vf_loss_unclipped": 371.6742479450413, "vf_explained_var": -0.00030422757175177143, "entropy": 7.724709829033565, "mean_kl_loss": 0.015054535092529357, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.461952209472656}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 484.0232549739478, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 144000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 6568.693, "sample_time_ms": 3133.398, "synch_weights_time_ms": 1.617}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 36, "trial_id": "0bf95_00000", "date": "2023-12-14_19-33-53", "timestamp": 1702600433, "time_this_iter_s": 8.265796184539795, "time_total_s": 233.80128693580627, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 233.80128693580627, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 25.175, "ram_util_percent": 80.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4991703744389927}, "default_policy": {"total_loss": 0.4991703744389927, "policy_loss": -0.012340321267115028, "vf_loss": 9.090013612307974, "vf_loss_unclipped": 316.33277865411884, "vf_explained_var": -0.00034668577759504825, "entropy": 7.689824982746832, "mean_kl_loss": 0.021611940835785087, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 29.192928314208984}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 671.6123364354589, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 148000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 6498.358, "sample_time_ms": 3108.363, "synch_weights_time_ms": 1.603}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 37, "trial_id": "0bf95_00000", "date": "2023-12-14_19-33-59", "timestamp": 1702600439, "time_this_iter_s": 5.957563877105713, "time_total_s": 239.758850812912, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 239.758850812912, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 31.099999999999998, "ram_util_percent": 80.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.28249012678067315}, "default_policy": {"total_loss": 0.28249012678067315, "policy_loss": -0.01920350935004318, "vf_loss": 8.81914225926023, "vf_loss_unclipped": 212.07096017296635, "vf_explained_var": -0.0017983199182603914, "entropy": 7.670928722251453, "mean_kl_loss": 0.007313490885241987, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 29.192928314208984}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 649.6135590574255, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 152000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 6426.427, "sample_time_ms": 3049.628, "synch_weights_time_ms": 1.599}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 38, "trial_id": "0bf95_00000", "date": "2023-12-14_19-34-05", "timestamp": 1702600445, "time_this_iter_s": 6.159174203872681, "time_total_s": 245.91802501678467, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 245.91802501678467, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.200000000000003, "ram_util_percent": 81.24444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2921854431854128}, "default_policy": {"total_loss": 0.2921854431854128, "policy_loss": -0.020133389877890154, "vf_loss": 9.078510773969866, "vf_loss_unclipped": 276.43045152123295, "vf_explained_var": -0.0012156875021676265, "entropy": 7.666407100173202, "mean_kl_loss": 0.007588609345332059, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 29.192928314208984}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 644.5581867344433, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 156000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 6396.294, "sample_time_ms": 3015.605, "synch_weights_time_ms": 1.603}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 39, "trial_id": "0bf95_00000", "date": "2023-12-14_19-34-11", "timestamp": 1702600451, "time_this_iter_s": 6.207252025604248, "time_total_s": 252.12527704238892, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 252.12527704238892, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 33.32222222222222, "ram_util_percent": 81.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.44238628805287356}, "default_policy": {"total_loss": 0.44238628805287356, "policy_loss": -0.010635307972887352, "vf_loss": 8.960985695629486, "vf_loss_unclipped": 475.7158322202117, "vf_explained_var": 5.287046371492496e-05, "entropy": 7.666891851404837, "mean_kl_loss": 0.012448622408765257, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 29.192928314208984}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 668.234556749359, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 160000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 6353.357, "sample_time_ms": 3000.528, "synch_weights_time_ms": 1.628}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 40, "trial_id": "0bf95_00000", "date": "2023-12-14_19-34-17", "timestamp": 1702600457, "time_this_iter_s": 5.987223863601685, "time_total_s": 258.1125009059906, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 258.1125009059906, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 35.3875, "ram_util_percent": 80.63749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3012729129001403}, "default_policy": {"total_loss": 0.3012729129001403, "policy_loss": -0.02046205641588629, "vf_loss": 9.317171179663651, "vf_loss_unclipped": 2660.995555015515, "vf_explained_var": -0.005107871695622198, "entropy": 7.702451218928355, "mean_kl_loss": 0.007829405080765297, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 29.192928314208984}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 665.5561644496424, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 164000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 6329.103, "sample_time_ms": 2991.166, "synch_weights_time_ms": 1.603}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 41, "trial_id": "0bf95_00000", "date": "2023-12-14_19-34-23", "timestamp": 1702600463, "time_this_iter_s": 6.011361837387085, "time_total_s": 264.1238627433777, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 264.1238627433777, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 26.5, "ram_util_percent": 80.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.5862669019239037}, "default_policy": {"total_loss": 3.5862669019239037, "policy_loss": 0.025356346982775002, "vf_loss": 9.369244365549799, "vf_loss_unclipped": 7055.94239024262, "vf_explained_var": -0.0042336623170482575, "entropy": 7.609895791580428, "mean_kl_loss": 0.1187691096819375, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 43.789390563964844}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 667.6165798057359, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 168000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 6306.233, "sample_time_ms": 2975.079, "synch_weights_time_ms": 1.58}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 42, "trial_id": "0bf95_00000", "date": "2023-12-14_19-34-29", "timestamp": 1702600469, "time_this_iter_s": 5.993094205856323, "time_total_s": 270.116956949234, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 270.116956949234, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.4375, "ram_util_percent": 80.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.330666846708893}, "default_policy": {"total_loss": 0.330666846708893, "policy_loss": -0.013473955347691215, "vf_loss": 9.818083593331929, "vf_loss_unclipped": 11172.416628432935, "vf_explained_var": -0.0025483759989870635, "entropy": 7.7364850928788504, "mean_kl_loss": 0.00561688485850764, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 43.789390563964844}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 659.8219946905011, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 172000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 6281.627, "sample_time_ms": 2970.077, "synch_weights_time_ms": 1.592}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 43, "trial_id": "0bf95_00000", "date": "2023-12-14_19-34-35", "timestamp": 1702600475, "time_this_iter_s": 6.063653230667114, "time_total_s": 276.1806101799011, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 276.1806101799011, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 28.166666666666668, "ram_util_percent": 80.4111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3797139252728618}, "default_policy": {"total_loss": 0.3797139252728618, "policy_loss": -0.010754497970259791, "vf_loss": 9.865428043072665, "vf_loss_unclipped": 11829.284313047365, "vf_explained_var": -0.010076228870765995, "entropy": 7.741389639087831, "mean_kl_loss": 0.006664037456441393, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 43.789390563964844}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 622.5175082418409, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 176000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 6303.333, "sample_time_ms": 2973.801, "synch_weights_time_ms": 1.566}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 44, "trial_id": "0bf95_00000", "date": "2023-12-14_19-34-42", "timestamp": 1702600482, "time_this_iter_s": 6.426836967468262, "time_total_s": 282.6074471473694, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 282.6074471473694, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 33.81111111111111, "ram_util_percent": 80.5111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.7700944804846603}, "default_policy": {"total_loss": 3.7700944804846603, "policy_loss": 0.02927676050502783, "vf_loss": 9.878808379427456, "vf_loss_unclipped": 16049.79918561663, "vf_explained_var": -0.00989540756892548, "entropy": 7.6796174100212955, "mean_kl_loss": 0.08317150752428831, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 65.68408203125}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 622.946326273601, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 180000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 6347.934, "sample_time_ms": 2989.888, "synch_weights_time_ms": 1.634}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 45, "trial_id": "0bf95_00000", "date": "2023-12-14_19-34-48", "timestamp": 1702600488, "time_this_iter_s": 6.422490119934082, "time_total_s": 289.02993726730347, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 289.02993726730347, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 27.999999999999996, "ram_util_percent": 81.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.38856345878195153}, "default_policy": {"total_loss": 0.38856345878195153, "policy_loss": -0.008273619575116204, "vf_loss": 9.845851608430907, "vf_loss_unclipped": 11980.600233358615, "vf_explained_var": -0.008090838186268105, "entropy": 7.7288748689297675, "mean_kl_loss": 0.004542631140886756, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 32.842041015625}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 641.7711722946932, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 184000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 6144.802, "sample_time_ms": 2778.813, "synch_weights_time_ms": 1.644}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 46, "trial_id": "0bf95_00000", "date": "2023-12-14_19-34-54", "timestamp": 1702600494, "time_this_iter_s": 6.23390007019043, "time_total_s": 295.2638373374939, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 295.2638373374939, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 30.27777777777778, "ram_util_percent": 81.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.721170548766629}, "default_policy": {"total_loss": 0.721170548766629, "policy_loss": 0.00054651401392909, "vf_loss": 9.778062275477819, "vf_loss_unclipped": 14333.134439464317, "vf_explained_var": -0.0026832790390006515, "entropy": 7.703441632073571, "mean_kl_loss": 0.018964820287897977, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 32.842041015625}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 641.6915930763068, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 188000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 6172.573, "sample_time_ms": 2800.77, "synch_weights_time_ms": 1.657}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 47, "trial_id": "0bf95_00000", "date": "2023-12-14_19-35-01", "timestamp": 1702600501, "time_this_iter_s": 6.234742879867554, "time_total_s": 301.49858021736145, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 301.49858021736145, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 31.544444444444448, "ram_util_percent": 81.37777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.33951825006747804}, "default_policy": {"total_loss": 0.33951825006747804, "policy_loss": -0.013981789205548987, "vf_loss": 9.528053565320176, "vf_loss_unclipped": 5636.177310984272, "vf_explained_var": -0.005689256989371293, "entropy": 7.678797823025474, "mean_kl_loss": 0.007862468261638089, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 32.842041015625}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 651.1458400808424, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 192000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 6171.124, "sample_time_ms": 2804.689, "synch_weights_time_ms": 1.626}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 48, "trial_id": "0bf95_00000", "date": "2023-12-14_19-35-07", "timestamp": 1702600507, "time_this_iter_s": 6.144346237182617, "time_total_s": 307.64292645454407, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 307.64292645454407, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 31.08888888888889, "ram_util_percent": 81.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.30279388848239425}, "default_policy": {"total_loss": 0.30279388848239425, "policy_loss": -0.02339928886934575, "vf_loss": 9.430947018076361, "vf_loss_unclipped": 2800.7537523932547, "vf_explained_var": -0.005142745877633979, "entropy": 7.663067067864099, "mean_kl_loss": 0.007060575515692329, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 32.842041015625}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 657.708352812062, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 196000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 6158.716, "sample_time_ms": 2805.507, "synch_weights_time_ms": 1.615}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 49, "trial_id": "0bf95_00000", "date": "2023-12-14_19-35-13", "timestamp": 1702600513, "time_this_iter_s": 6.083091974258423, "time_total_s": 313.7260184288025, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 313.7260184288025, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 31.299999999999997, "ram_util_percent": 81.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22544286499765}, "default_policy": {"total_loss": 0.22544286499765, "policy_loss": -0.017473411535335853, "vf_loss": 8.727493551494216, "vf_loss_unclipped": 318.79461730111126, "vf_explained_var": -0.004066749676458363, "entropy": 7.645497619978655, "mean_kl_loss": 0.0047390885788435606, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.4210205078125}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 659.0135349982274, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 200000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 6167.092, "sample_time_ms": 2804.458, "synch_weights_time_ms": 1.619}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 50, "trial_id": "0bf95_00000", "date": "2023-12-14_19-35-19", "timestamp": 1702600519, "time_this_iter_s": 6.070890188217163, "time_total_s": 319.79690861701965, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 319.79690861701965, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 34.4625, "ram_util_percent": 80.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.26238047057139213}, "default_policy": {"total_loss": 0.26238047057139213, "policy_loss": -0.015364846085577505, "vf_loss": 8.903490658762104, "vf_loss_unclipped": 225.6241821093854, "vf_explained_var": 0.006541308944921758, "entropy": 7.597736795319677, "mean_kl_loss": 0.011492002696053657, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.4210205078125}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 664.6583891212784, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 204000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 6167.904, "sample_time_ms": 2811.066, "synch_weights_time_ms": 1.604}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 51, "trial_id": "0bf95_00000", "date": "2023-12-14_19-35-25", "timestamp": 1702600525, "time_this_iter_s": 6.01954197883606, "time_total_s": 325.8164505958557, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 325.8164505958557, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 30.911111111111115, "ram_util_percent": 80.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.44856500071185484}, "default_policy": {"total_loss": 0.44856500071185484, "policy_loss": -0.013807462107366336, "vf_loss": 8.958855267526753, "vf_loss_unclipped": 260.4431409774813, "vf_explained_var": 0.015125183281359643, "entropy": 7.488707548519696, "mean_kl_loss": 0.02270162872782496, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 24.63153076171875}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}}, "episode_reward_max": -292606.9845685117, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -297886.9290273583, "episode_len_mean": 35039.5, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117], "episode_lengths": [35039, 35040, 35040, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1953293619781373, "mean_inference_ms": 0.9795650608171789, "mean_action_processing_ms": 0.04869272044551476, "mean_env_wait_ms": 0.3355411821573522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032782554626464844, "StateBufferConnector_ms": 0.0021457672119140625, "ViewRequirementAgentConnector_ms": 0.13473033905029297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 658.16189287387, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 208000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 6176.511, "sample_time_ms": 2814.72, "synch_weights_time_ms": 1.638}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 52, "trial_id": "0bf95_00000", "date": "2023-12-14_19-35-31", "timestamp": 1702600531, "time_this_iter_s": 6.078794956207275, "time_total_s": 331.895245552063, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 331.895245552063, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 35.025000000000006, "ram_util_percent": 81.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.28590750253038494}, "default_policy": {"total_loss": 0.28590750253038494, "policy_loss": -0.008975800232036408, "vf_loss": 8.826885551786118, "vf_loss_unclipped": 249.0330286209009, "vf_explained_var": 0.009320096547669693, "entropy": 7.591812308154889, "mean_kl_loss": 0.008388209847380533, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 24.63153076171875}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.8964273996182, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 212000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 6393.507, "sample_time_ms": 3037.627, "synch_weights_time_ms": 1.635}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 53, "trial_id": "0bf95_00000", "date": "2023-12-14_19-35-39", "timestamp": 1702600539, "time_this_iter_s": 8.233982801437378, "time_total_s": 340.12922835350037, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 340.12922835350037, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 39.30833333333333, "ram_util_percent": 81.31666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.3620003152853135}, "default_policy": {"total_loss": 3.3620003152853135, "policy_loss": 0.0381402677172787, "vf_loss": 9.048683211747518, "vf_loss_unclipped": 297.0392852043038, "vf_explained_var": -1.235747896532006e-06, "entropy": 7.420294770299753, "mean_kl_loss": 0.13126968221896182, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 673.437509219657, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 216000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 6344.924, "sample_time_ms": 3022.857, "synch_weights_time_ms": 1.673}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 54, "trial_id": "0bf95_00000", "date": "2023-12-14_19-35-45", "timestamp": 1702600545, "time_this_iter_s": 5.941076040267944, "time_total_s": 346.0703043937683, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 346.0703043937683, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 42.455555555555556, "ram_util_percent": 81.23333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5095395523188974}, "default_policy": {"total_loss": 0.5095395523188974, "policy_loss": -0.0037376244447188084, "vf_loss": 8.915180840217737, "vf_loss_unclipped": 262.8948759188784, "vf_explained_var": -9.549452043545526e-07, "entropy": 7.546886026732195, "mean_kl_loss": 0.01147919913926008, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 628.6645458894853, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 220000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 6339.082, "sample_time_ms": 3019.236, "synch_weights_time_ms": 1.619}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 55, "trial_id": "0bf95_00000", "date": "2023-12-14_19-35-52", "timestamp": 1702600552, "time_this_iter_s": 6.364070892333984, "time_total_s": 352.4343752861023, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 352.4343752861023, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 39.22222222222222, "ram_util_percent": 82.2111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3816579831227946}, "default_policy": {"total_loss": 0.3816579831227946, "policy_loss": -0.009990348748471548, "vf_loss": 8.891015732466284, "vf_loss_unclipped": 213.3501889771744, "vf_explained_var": -9.549452043545526e-07, "entropy": 7.4315462137844515, "mean_kl_loss": 0.008193784328433394, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 659.6123352091239, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 224000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 6322.224, "sample_time_ms": 3003.128, "synch_weights_time_ms": 1.598}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 56, "trial_id": "0bf95_00000", "date": "2023-12-14_19-35-58", "timestamp": 1702600558, "time_this_iter_s": 6.065613031387329, "time_total_s": 358.4999883174896, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 358.4999883174896, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 30.9, "ram_util_percent": 82.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.26903193606250386}, "default_policy": {"total_loss": 0.26903193606250386, "policy_loss": -0.01487085346215919, "vf_loss": 8.904810286279934, "vf_loss_unclipped": 471.294351032802, "vf_explained_var": -1.065385367062046e-06, "entropy": 7.538120615456912, "mean_kl_loss": 0.005273855305098713, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 670.8475105708004, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 228000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 6295.132, "sample_time_ms": 2988.2, "synch_weights_time_ms": 1.58}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 57, "trial_id": "0bf95_00000", "date": "2023-12-14_19-36-04", "timestamp": 1702600564, "time_this_iter_s": 5.9639739990234375, "time_total_s": 364.46396231651306, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 364.46396231651306, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 29.188888888888886, "ram_util_percent": 81.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3811008409618823}, "default_policy": {"total_loss": 0.3811008409618823, "policy_loss": -0.011740449622873145, "vf_loss": 9.084922624803555, "vf_loss_unclipped": 846.8166824088676, "vf_explained_var": -9.568515362770065e-07, "entropy": 7.531492759423978, "mean_kl_loss": 0.008173590526353216, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 675.9550567592279, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 232000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 6272.586, "sample_time_ms": 2972.515, "synch_weights_time_ms": 1.581}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 58, "trial_id": "0bf95_00000", "date": "2023-12-14_19-36-10", "timestamp": 1702600570, "time_this_iter_s": 5.918910026550293, "time_total_s": 370.38287234306335, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 370.38287234306335, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 28.875, "ram_util_percent": 81.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6157545637267866}, "default_policy": {"total_loss": 0.6157545637267866, "policy_loss": -0.015179195611336545, "vf_loss": 9.471717496416462, "vf_loss_unclipped": 4557.3920009019275, "vf_explained_var": -9.834130943965303e-07, "entropy": 7.517138974244661, "mean_kl_loss": 0.014513012980177993, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 670.3192207856134, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 236000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 6261.144, "sample_time_ms": 2966.258, "synch_weights_time_ms": 1.61}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 59, "trial_id": "0bf95_00000", "date": "2023-12-14_19-36-16", "timestamp": 1702600576, "time_this_iter_s": 5.968691825866699, "time_total_s": 376.35156416893005, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 376.35156416893005, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 27.033333333333335, "ram_util_percent": 82.04444444444442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.48276057930738686}, "default_policy": {"total_loss": 0.48276057930738686, "policy_loss": -0.013840979805140733, "vf_loss": 9.807337647053734, "vf_loss_unclipped": 10970.12244441311, "vf_explained_var": -9.539284939959104e-07, "entropy": 7.515621596562075, "mean_kl_loss": 0.010786396390682127, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 638.6092300056068, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 240000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 6280.537, "sample_time_ms": 2980.105, "synch_weights_time_ms": 1.59}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 60, "trial_id": "0bf95_00000", "date": "2023-12-14_19-36-22", "timestamp": 1702600582, "time_this_iter_s": 6.264865875244141, "time_total_s": 382.6164300441742, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 382.6164300441742, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 29.444444444444443, "ram_util_percent": 82.11111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4243193425651171}, "default_policy": {"total_loss": 0.4243193425651171, "policy_loss": -0.012322002540288894, "vf_loss": 9.689202739739978, "vf_loss_unclipped": 7765.806986526131, "vf_explained_var": -9.612996440960654e-07, "entropy": 7.489127571394703, "mean_kl_loss": 0.009195512234050598, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 654.4911629811426, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 244000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 6289.886, "sample_time_ms": 2983.491, "synch_weights_time_ms": 1.598}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 61, "trial_id": "0bf95_00000", "date": "2023-12-14_19-36-28", "timestamp": 1702600588, "time_this_iter_s": 6.113166093826294, "time_total_s": 388.7295961380005, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 388.7295961380005, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 28.6625, "ram_util_percent": 81.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.49947542370731896}, "default_policy": {"total_loss": 0.49947542370731896, "policy_loss": -0.012417290373387605, "vf_loss": 9.867280689638052, "vf_loss_unclipped": 12069.42922459584, "vf_explained_var": -9.564702698925156e-07, "entropy": 7.5141068140326785, "mean_kl_loss": 0.011184036361414063, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 634.496515325104, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 248000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 6312.554, "sample_time_ms": 3007.895, "synch_weights_time_ms": 1.609}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 62, "trial_id": "0bf95_00000", "date": "2023-12-14_19-36-34", "timestamp": 1702600594, "time_this_iter_s": 6.305519104003906, "time_total_s": 395.0351152420044, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 395.0351152420044, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 31.244444444444444, "ram_util_percent": 81.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.35885440971233695}, "default_policy": {"total_loss": 0.35885440971233695, "policy_loss": -0.012463388905457375, "vf_loss": 9.875475163652952, "vf_loss_unclipped": 13740.404893171559, "vf_explained_var": -9.559619147131947e-07, "entropy": 7.501644406491505, "mean_kl_loss": 0.007377077037632564, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 622.8734974581579, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 252000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 6131.518, "sample_time_ms": 2796.536, "synch_weights_time_ms": 1.634}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 63, "trial_id": "0bf95_00000", "date": "2023-12-14_19-36-41", "timestamp": 1702600601, "time_this_iter_s": 6.4243268966674805, "time_total_s": 401.4594421386719, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 401.4594421386719, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 30.98, "ram_util_percent": 81.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.39849372199381083}, "default_policy": {"total_loss": 0.39849372199381083, "policy_loss": -0.015391633788775057, "vf_loss": 9.830178523114496, "vf_loss_unclipped": 10770.477526439025, "vf_explained_var": -9.574869802511577e-07, "entropy": 7.4874021107199855, "mean_kl_loss": 0.00854145231473466, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 628.4766651495314, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 256000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 6174.01, "sample_time_ms": 2836.233, "synch_weights_time_ms": 1.643}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 64, "trial_id": "0bf95_00000", "date": "2023-12-14_19-36-47", "timestamp": 1702600607, "time_this_iter_s": 6.366066217422485, "time_total_s": 407.82550835609436, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 407.82550835609436, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 27.922222222222224, "ram_util_percent": 81.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.33295037500512625}, "default_policy": {"total_loss": 0.33295037500512625, "policy_loss": -0.01517556200443364, "vf_loss": 9.744474188351173, "vf_loss_unclipped": 7366.848413788688, "vf_explained_var": -9.558348259183644e-07, "entropy": 7.450300810942009, "mean_kl_loss": 0.00678483177968191, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 648.7061751493403, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 260000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 6154.354, "sample_time_ms": 2834.522, "synch_weights_time_ms": 1.637}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 65, "trial_id": "0bf95_00000", "date": "2023-12-14_19-36-53", "timestamp": 1702600613, "time_this_iter_s": 6.16763710975647, "time_total_s": 413.99314546585083, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 413.99314546585083, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 26.9625, "ram_util_percent": 81.78750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3550431030248401}, "default_policy": {"total_loss": 0.3550431030248401, "policy_loss": -0.0195958708377698, "vf_loss": 9.50860003164328, "vf_loss_unclipped": 3535.8862867375683, "vf_explained_var": -9.538014052010803e-07, "entropy": 7.423481537589132, "mean_kl_loss": 0.007566263541203627, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.947296142578125}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 655.9059904944311, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 264000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 6157.781, "sample_time_ms": 2839.402, "synch_weights_time_ms": 1.626}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 66, "trial_id": "0bf95_00000", "date": "2023-12-14_19-36-59", "timestamp": 1702600619, "time_this_iter_s": 6.0998640060424805, "time_total_s": 420.0930094718933, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 420.0930094718933, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 29.58888888888889, "ram_util_percent": 81.47777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21548766110624587}, "default_policy": {"total_loss": 0.21548766110624587, "policy_loss": -0.01727951240779431, "vf_loss": 9.185891636399063, "vf_loss_unclipped": 574.886824032391, "vf_explained_var": -9.544368491752315e-07, "entropy": 7.4042541111456055, "mean_kl_loss": 0.0038137638184009494, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 644.1459227243708, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 268000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 6182.496, "sample_time_ms": 2839.146, "synch_weights_time_ms": 1.64}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 67, "trial_id": "0bf95_00000", "date": "2023-12-14_19-37-06", "timestamp": 1702600626, "time_this_iter_s": 6.211309194564819, "time_total_s": 426.30431866645813, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 426.30431866645813, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 32.65555555555556, "ram_util_percent": 81.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22566690874188694}, "default_policy": {"total_loss": 0.22566690874188694, "policy_loss": -0.02045918248051694, "vf_loss": 8.925907332251576, "vf_loss_unclipped": 331.5440146440128, "vf_explained_var": -9.419186028844512e-07, "entropy": 7.373034095967502, "mean_kl_loss": 0.00849139376582968, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 630.7373445310923, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 272000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 6224.919, "sample_time_ms": 2851.389, "synch_weights_time_ms": 1.658}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 68, "trial_id": "0bf95_00000", "date": "2023-12-14_19-37-12", "timestamp": 1702600632, "time_this_iter_s": 6.343015193939209, "time_total_s": 432.64733386039734, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 432.64733386039734, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 34.5, "ram_util_percent": 81.58888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2981469071130636}, "default_policy": {"total_loss": 0.2981469071130636, "policy_loss": -0.014459393045275227, "vf_loss": 9.075260887268001, "vf_loss_unclipped": 329.6389812802963, "vf_explained_var": -9.522763396631172e-07, "entropy": 7.304495599478293, "mean_kl_loss": 0.012009197649278385, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 633.0504132112906, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 276000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 6260.05, "sample_time_ms": 2859.866, "synch_weights_time_ms": 1.661}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 69, "trial_id": "0bf95_00000", "date": "2023-12-14_19-37-18", "timestamp": 1702600638, "time_this_iter_s": 6.320133209228516, "time_total_s": 438.96746706962585, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 438.96746706962585, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 35.87777777777778, "ram_util_percent": 81.66666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3185117807326668}, "default_policy": {"total_loss": 0.3185117807326668, "policy_loss": -0.015590012268618003, "vf_loss": 9.01060659290631, "vf_loss_unclipped": 305.3769530517969, "vf_explained_var": -9.416008808973755e-07, "entropy": 7.285471946700041, "mean_kl_loss": 0.013207771769865465, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}}, "episode_reward_max": -287660.3765691886, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -294514.45301883336, "episode_len_mean": 35039.333333333336, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1952281009828909, "mean_inference_ms": 0.9778290257169168, "mean_action_processing_ms": 0.04864249266368528, "mean_env_wait_ms": 0.3188094019440776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039021174112955728, "StateBufferConnector_ms": 0.002221266428629557, "ViewRequirementAgentConnector_ms": 0.14346837997436523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 654.0387140556712, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 280000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 6245.273, "sample_time_ms": 2856.909, "synch_weights_time_ms": 1.669}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 70, "trial_id": "0bf95_00000", "date": "2023-12-14_19-37-24", "timestamp": 1702600644, "time_this_iter_s": 6.117233037948608, "time_total_s": 445.08470010757446, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 445.08470010757446, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 32.74444444444444, "ram_util_percent": 81.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3281494190952163}, "default_policy": {"total_loss": 0.3281494190952163, "policy_loss": -0.01724720676876366, "vf_loss": 9.33587070060437, "vf_loss_unclipped": 466.97120542871926, "vf_explained_var": -8.42979976109096e-07, "entropy": 7.329738884846539, "mean_kl_loss": 0.01364310504003734, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 474.7278244732243, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 284000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 6476.7, "sample_time_ms": 3077.549, "synch_weights_time_ms": 1.672}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 71, "trial_id": "0bf95_00000", "date": "2023-12-14_19-37-33", "timestamp": 1702600653, "time_this_iter_s": 8.427340984344482, "time_total_s": 453.51204109191895, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 453.51204109191895, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 28.766666666666666, "ram_util_percent": 82.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4280231960657944}, "default_policy": {"total_loss": 0.4280231960657944, "policy_loss": -0.011736518969493253, "vf_loss": 9.09633675109603, "vf_loss_unclipped": 361.3167823514959, "vf_explained_var": -9.548181155597222e-07, "entropy": 7.2640885254467475, "mean_kl_loss": 0.018880750897022073, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 670.5900696949832, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 288000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 6442.769, "sample_time_ms": 3042.503, "synch_weights_time_ms": 1.623}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 72, "trial_id": "0bf95_00000", "date": "2023-12-14_19-37-39", "timestamp": 1702600659, "time_this_iter_s": 5.966460943222046, "time_total_s": 459.478502035141, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 459.478502035141, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 31.787499999999998, "ram_util_percent": 81.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.27088355282540005}, "default_policy": {"total_loss": 0.27088355282540005, "policy_loss": -0.017679825469827666, "vf_loss": 9.113313889452643, "vf_loss_unclipped": 295.97240719663057, "vf_explained_var": -9.558348259183644e-07, "entropy": 7.262533146181086, "mean_kl_loss": 0.010687127827549353, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 644.6771456767148, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 292000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 6421.049, "sample_time_ms": 3025.718, "synch_weights_time_ms": 1.642}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 73, "trial_id": "0bf95_00000", "date": "2023-12-14_19-37-45", "timestamp": 1702600665, "time_this_iter_s": 6.206068992614746, "time_total_s": 465.68457102775574, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 465.68457102775574, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 33.03333333333333, "ram_util_percent": 82.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.34772640967896495}, "default_policy": {"total_loss": 0.34772640967896495, "policy_loss": -0.01877792768065196, "vf_loss": 9.170934623238374, "vf_loss_unclipped": 409.8530371692389, "vf_explained_var": -9.546910267648921e-07, "entropy": 7.22790361467455, "mean_kl_loss": 0.01487497158810731, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 635.0024658686311, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 296000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 6414.509, "sample_time_ms": 3005.032, "synch_weights_time_ms": 1.59}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 74, "trial_id": "0bf95_00000", "date": "2023-12-14_19-37-51", "timestamp": 1702600671, "time_this_iter_s": 6.300555944442749, "time_total_s": 471.9851269721985, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 471.9851269721985, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 36.48888888888889, "ram_util_percent": 82.12222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3301207631159185}, "default_policy": {"total_loss": 0.3301207631159185, "policy_loss": -0.018827879144105195, "vf_loss": 9.014848791968339, "vf_loss_unclipped": 677.0913760585826, "vf_explained_var": -9.55580648328704e-07, "entropy": 7.22017417787743, "mean_kl_loss": 0.014009152957728989, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 665.9708405621155, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 300000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 6398.523, "sample_time_ms": 2997.448, "synch_weights_time_ms": 1.626}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 75, "trial_id": "0bf95_00000", "date": "2023-12-14_19-37-57", "timestamp": 1702600677, "time_this_iter_s": 6.00741982460022, "time_total_s": 477.9925467967987, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 477.9925467967987, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 30.04444444444444, "ram_util_percent": 81.3111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2672969564430114}, "default_policy": {"total_loss": 0.2672969564430114, "policy_loss": -0.026701472533458687, "vf_loss": 9.410808384799754, "vf_loss_unclipped": 3684.5765277805613, "vf_explained_var": -9.640955975823312e-07, "entropy": 7.239686261362104, "mean_kl_loss": 0.010820296444097635, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 671.0046033834723, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 304000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 6384.801, "sample_time_ms": 2988.217, "synch_weights_time_ms": 1.647}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 76, "trial_id": "0bf95_00000", "date": "2023-12-14_19-38-03", "timestamp": 1702600683, "time_this_iter_s": 5.962578058242798, "time_total_s": 483.9551248550415, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 483.9551248550415, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 28.612499999999997, "ram_util_percent": 81.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 2.3004785538243966}, "default_policy": {"total_loss": 2.3004785538243966, "policy_loss": 0.02549979975844211, "vf_loss": 9.372413854354988, "vf_loss_unclipped": 6732.811752604015, "vf_explained_var": -9.600287561477628e-07, "entropy": 7.2018093747624965, "mean_kl_loss": 0.11807384239539488, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 27.710472106933594}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 601.8072206395159, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 308000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 6428.489, "sample_time_ms": 3032.569, "synch_weights_time_ms": 1.724}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 77, "trial_id": "0bf95_00000", "date": "2023-12-14_19-38-10", "timestamp": 1702600690, "time_this_iter_s": 6.648077011108398, "time_total_s": 490.6032018661499, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 490.6032018661499, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 31.590000000000003, "ram_util_percent": 82.19}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3133802712757959}, "default_policy": {"total_loss": 0.3133802712757959, "policy_loss": -0.014188043352440873, "vf_loss": 9.872784063505973, "vf_loss_unclipped": 13456.316930400792, "vf_explained_var": -9.562160923028551e-07, "entropy": 7.36970278144137, "mean_kl_loss": 0.008258266746039083, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 27.710472106933594}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 612.1963993594297, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 312000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 6447.695, "sample_time_ms": 3057.109, "synch_weights_time_ms": 1.769}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 78, "trial_id": "0bf95_00000", "date": "2023-12-14_19-38-17", "timestamp": 1702600697, "time_this_iter_s": 6.5360801219940186, "time_total_s": 497.1392819881439, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 497.1392819881439, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 33.511111111111106, "ram_util_percent": 82.17777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.32358018745745676}, "default_policy": {"total_loss": 0.32358018745745676, "policy_loss": -0.015104006645259764, "vf_loss": 9.807210559275612, "vf_loss_unclipped": 11094.398338171464, "vf_explained_var": -9.59647489763272e-07, "entropy": 7.319487375491209, "mean_kl_loss": 0.008683074254052106, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 27.710472106933594}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 642.7791055229175, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 316000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 6438.132, "sample_time_ms": 3067.567, "synch_weights_time_ms": 1.749}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 79, "trial_id": "0bf95_00000", "date": "2023-12-14_19-38-23", "timestamp": 1702600703, "time_this_iter_s": 6.224412202835083, "time_total_s": 503.363694190979, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 503.363694190979, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 81.51111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 2.489128869765603}, "default_policy": {"total_loss": 2.489128869765603, "policy_loss": 0.0233961852376105, "vf_loss": 9.90164509104259, "vf_loss_unclipped": 17246.627701163547, "vf_explained_var": -9.550722931493829e-07, "entropy": 7.3114016305154825, "mean_kl_loss": 0.08540872976167664, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 41.56570816040039}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 639.873242883671, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 320000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 6451.671, "sample_time_ms": 3082.843, "synch_weights_time_ms": 1.734}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 80, "trial_id": "0bf95_00000", "date": "2023-12-14_19-38-29", "timestamp": 1702600709, "time_this_iter_s": 6.252550840377808, "time_total_s": 509.6162450313568, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 509.6162450313568, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 26.42222222222222, "ram_util_percent": 81.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.300763349996002}, "default_policy": {"total_loss": 0.300763349996002, "policy_loss": -0.008947376390176414, "vf_loss": 9.8700140798524, "vf_loss_unclipped": 12822.117908469649, "vf_explained_var": -9.626976208391983e-07, "entropy": 7.400779046991995, "mean_kl_loss": 0.005076554452150024, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 41.56570816040039}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 638.9836478355351, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 324000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 6235.077, "sample_time_ms": 2871.016, "synch_weights_time_ms": 1.731}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 81, "trial_id": "0bf95_00000", "date": "2023-12-14_19-38-35", "timestamp": 1702600715, "time_this_iter_s": 6.26124382019043, "time_total_s": 515.8774888515472, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 515.8774888515472, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 26.900000000000002, "ram_util_percent": 80.94444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4524125591762412}, "default_policy": {"total_loss": 0.4524125591762412, "policy_loss": -0.00867689986760889, "vf_loss": 9.813183544541218, "vf_loss_unclipped": 12928.328694894624, "vf_explained_var": -9.573598914563274e-07, "entropy": 7.394881537728218, "mean_kl_loss": 0.008732140863225749, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 41.56570816040039}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 640.7290032673436, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 328000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 6262.875, "sample_time_ms": 2901.638, "synch_weights_time_ms": 1.738}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 82, "trial_id": "0bf95_00000", "date": "2023-12-14_19-38-42", "timestamp": 1702600722, "time_this_iter_s": 6.244436979293823, "time_total_s": 522.1219258308411, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 522.1219258308411, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 26.899999999999995, "ram_util_percent": 80.25555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3565160767324189}, "default_policy": {"total_loss": 0.3565160767324189, "policy_loss": -0.00927223486782137, "vf_loss": 9.522645476530355, "vf_loss_unclipped": 6644.338162355078, "vf_explained_var": -9.587578681994603e-07, "entropy": 7.254385553189178, "mean_kl_loss": 0.006509256557308769, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 41.56570816040039}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 665.7918133860807, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 332000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 6243.198, "sample_time_ms": 2899.398, "synch_weights_time_ms": 1.701}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 83, "trial_id": "0bf95_00000", "date": "2023-12-14_19-38-48", "timestamp": 1702600728, "time_this_iter_s": 6.00924015045166, "time_total_s": 528.1311659812927, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 528.1311659812927, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 27.7, "ram_util_percent": 80.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.46378159767656185}, "default_policy": {"total_loss": 0.46378159767656185, "policy_loss": -0.014442375878483724, "vf_loss": 9.486382115370175, "vf_loss_unclipped": 2996.4942863155275, "vf_explained_var": -9.554535595338736e-07, "entropy": 7.200115839301396, "mean_kl_loss": 0.00922299114129141, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 41.56570816040039}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 667.0543751854037, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 336000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 6212.931, "sample_time_ms": 2884.179, "synch_weights_time_ms": 1.711}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 84, "trial_id": "0bf95_00000", "date": "2023-12-14_19-38-54", "timestamp": 1702600734, "time_this_iter_s": 5.997780084609985, "time_total_s": 534.1289460659027, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 534.1289460659027, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 25.03333333333333, "ram_util_percent": 80.0888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1996014746886962}, "default_policy": {"total_loss": 0.1996014746886962, "policy_loss": -0.012877331535790616, "vf_loss": 8.95593861120342, "vf_loss_unclipped": 379.6815136582104, "vf_explained_var": -9.548181155597222e-07, "entropy": 7.136161559172022, "mean_kl_loss": 0.0029572316134886655, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 20.782854080200195}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 675.1535504844729, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 340000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 6204.762, "sample_time_ms": 2875.663, "synch_weights_time_ms": 1.681}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 85, "trial_id": "0bf95_00000", "date": "2023-12-14_19-39-00", "timestamp": 1702600740, "time_this_iter_s": 5.925762176513672, "time_total_s": 540.0547082424164, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 540.0547082424164, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 29.762500000000003, "ram_util_percent": 79.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24267399893688368}, "default_policy": {"total_loss": 0.24267399893688368, "policy_loss": -0.017997726610403008, "vf_loss": 8.911744942288918, "vf_loss_unclipped": 275.723024449623, "vf_explained_var": -9.553264707390433e-07, "entropy": 7.126404608236447, "mean_kl_loss": 0.008254606224544794, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 20.782854080200195}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 676.3373696841815, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 344000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 6200.062, "sample_time_ms": 2873.667, "synch_weights_time_ms": 1.662}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 86, "trial_id": "0bf95_00000", "date": "2023-12-14_19-39-06", "timestamp": 1702600746, "time_this_iter_s": 5.915539979934692, "time_total_s": 545.9702482223511, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 545.9702482223511, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 26.43333333333333, "ram_util_percent": 79.48888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3782933530435443}, "default_policy": {"total_loss": 0.3782933530435443, "policy_loss": -0.012786306218921281, "vf_loss": 9.059263106348164, "vf_loss_unclipped": 288.1840014589875, "vf_explained_var": -9.563431810976854e-07, "entropy": 7.052649631683252, "mean_kl_loss": 0.014458410322939149, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 20.782854080200195}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}}, "episode_reward_max": -279408.49879403535, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -290782.79193254805, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19511069701430356, "mean_inference_ms": 0.9760152687953891, "mean_action_processing_ms": 0.04860713097069317, "mean_env_wait_ms": 0.3074684098180283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004118680953979492, "StateBufferConnector_ms": 0.0025153160095214844, "ViewRequirementAgentConnector_ms": 0.15760064125061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 676.6451689298315, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 348000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 6126.549, "sample_time_ms": 2820.946, "synch_weights_time_ms": 1.569}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 87, "trial_id": "0bf95_00000", "date": "2023-12-14_19-39-11", "timestamp": 1702600751, "time_this_iter_s": 5.912895917892456, "time_total_s": 551.8831441402435, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 551.8831441402435, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 31.8, "ram_util_percent": 79.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2401309965023481}, "default_policy": {"total_loss": 0.2401309965023481, "policy_loss": -0.010927487251116459, "vf_loss": 8.839269108863782, "vf_loss_unclipped": 242.81965897484883, "vf_explained_var": -9.55199381944213e-07, "entropy": 7.126080586711989, "mean_kl_loss": 0.007826922656662304, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 20.782854080200195}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 480.78863337110454, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 352000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 6305.131, "sample_time_ms": 3013.668, "synch_weights_time_ms": 1.535}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 88, "trial_id": "0bf95_00000", "date": "2023-12-14_19-39-20", "timestamp": 1702600760, "time_this_iter_s": 8.321815729141235, "time_total_s": 560.2049598693848, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 560.2049598693848, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 23.766666666666666, "ram_util_percent": 79.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 2.8929334893338146}, "default_policy": {"total_loss": 2.8929334893338146, "policy_loss": 0.03649033162234498, "vf_loss": 9.091233205693618, "vf_loss_unclipped": 324.61660019929474, "vf_explained_var": -9.540555827907407e-07, "entropy": 6.96653195484869, "mean_kl_loss": 0.1330679038356451, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 663.678772691503, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 356000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 6285.534, "sample_time_ms": 3002.878, "synch_weights_time_ms": 1.526}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 89, "trial_id": "0bf95_00000", "date": "2023-12-14_19-39-26", "timestamp": 1702600766, "time_this_iter_s": 6.028389930725098, "time_total_s": 566.2333498001099, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 566.2333498001099, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 30.2875, "ram_util_percent": 79.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.49763772190252603}, "default_policy": {"total_loss": 0.49763772190252603, "policy_loss": -0.00643488262116766, "vf_loss": 8.807229565150703, "vf_loss_unclipped": 215.59063790246114, "vf_explained_var": -9.543097603804014e-07, "entropy": 7.029495864534683, "mean_kl_loss": 0.013344342935008621, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 658.7630515528361, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 360000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 6267.609, "sample_time_ms": 2986.235, "synch_weights_time_ms": 1.53}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 90, "trial_id": "0bf95_00000", "date": "2023-12-14_19-39-32", "timestamp": 1702600772, "time_this_iter_s": 6.07335090637207, "time_total_s": 572.3067007064819, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 572.3067007064819, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 30.666666666666668, "ram_util_percent": 79.28888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3675448022830461}, "default_policy": {"total_loss": 0.3675448022830461, "policy_loss": -0.00882961497138709, "vf_loss": 8.93613225310596, "vf_loss_unclipped": 214.71253173437708, "vf_explained_var": -9.559619147131947e-07, "entropy": 7.015955331228944, "mean_kl_loss": 0.009206726685466892, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 667.129970808817, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 364000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 6241.198, "sample_time_ms": 2971.085, "synch_weights_time_ms": 1.516}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 91, "trial_id": "0bf95_00000", "date": "2023-12-14_19-39-38", "timestamp": 1702600778, "time_this_iter_s": 5.99714207649231, "time_total_s": 578.3038427829742, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 578.3038427829742, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 28.56666666666667, "ram_util_percent": 79.27777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2983053363462501}, "default_policy": {"total_loss": 0.2983053363462501, "policy_loss": -0.014380863232256126, "vf_loss": 8.874863161969541, "vf_loss_unclipped": 477.68211315537314, "vf_explained_var": -9.564702698925156e-07, "entropy": 7.07151406863605, "mean_kl_loss": 0.007183407574925181, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 671.234861802295, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 368000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 6212.827, "sample_time_ms": 2942.975, "synch_weights_time_ms": 1.513}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 92, "trial_id": "0bf95_00000", "date": "2023-12-14_19-39-44", "timestamp": 1702600784, "time_this_iter_s": 5.960481882095337, "time_total_s": 584.2643246650696, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 584.2643246650696, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 29.1, "ram_util_percent": 79.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5484269643261996}, "default_policy": {"total_loss": 0.5484269643261996, "policy_loss": -0.007473340192720342, "vf_loss": 9.014401974200185, "vf_loss_unclipped": 811.558610371181, "vf_explained_var": -9.573598914563274e-07, "entropy": 7.0933398153227785, "mean_kl_loss": 0.014940401619160592, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 651.0973975921232, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 372000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 6226.386, "sample_time_ms": 2960.244, "synch_weights_time_ms": 1.517}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 93, "trial_id": "0bf95_00000", "date": "2023-12-14_19-39-50", "timestamp": 1702600790, "time_this_iter_s": 6.145082235336304, "time_total_s": 590.4094069004059, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 590.4094069004059, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 30.488888888888894, "ram_util_percent": 79.1888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.526442833324231}, "default_policy": {"total_loss": 0.526442833324231, "policy_loss": -0.017751608860553866, "vf_loss": 9.460340326528813, "vf_loss_unclipped": 5316.02353167178, "vf_explained_var": -9.619350880702168e-07, "entropy": 7.125873337422353, "mean_kl_loss": 0.01442185703276305, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 668.5394456107306, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 376000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 6225.054, "sample_time_ms": 2959.852, "synch_weights_time_ms": 1.501}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 94, "trial_id": "0bf95_00000", "date": "2023-12-14_19-39-56", "timestamp": 1702600796, "time_this_iter_s": 5.9844651222229, "time_total_s": 596.3938720226288, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 596.3938720226288, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 27.4375, "ram_util_percent": 79.1375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5379096865812852}, "default_policy": {"total_loss": 0.5379096865812852, "policy_loss": -0.013210039266121031, "vf_loss": 9.689653301035671, "vf_loss_unclipped": 13206.881035176422, "vf_explained_var": -9.618079992753865e-07, "entropy": 7.247271234801075, "mean_kl_loss": 0.01457044576998161, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 650.449033572035, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 380000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 6247.555, "sample_time_ms": 2966.358, "synch_weights_time_ms": 1.518}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 95, "trial_id": "0bf95_00000", "date": "2023-12-14_19-40-02", "timestamp": 1702600802, "time_this_iter_s": 6.151133298873901, "time_total_s": 602.5450053215027, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 602.5450053215027, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 26.677777777777774, "ram_util_percent": 79.24444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5133765203310355}, "default_policy": {"total_loss": 0.5133765203310355, "policy_loss": -0.012278732095064639, "vf_loss": 9.680295194898333, "vf_loss_unclipped": 10641.56693609437, "vf_explained_var": -9.605371113270839e-07, "entropy": 7.200684465579132, "mean_kl_loss": 0.013756605530090232, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 624.4652873123069, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 384000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 6296.682, "sample_time_ms": 2996.17, "synch_weights_time_ms": 1.521}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 96, "trial_id": "0bf95_00000", "date": "2023-12-14_19-40-09", "timestamp": 1702600809, "time_this_iter_s": 6.4068357944488525, "time_total_s": 608.9518411159515, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 608.9518411159515, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 33.388888888888886, "ram_util_percent": 80.42222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4478162094347004}, "default_policy": {"total_loss": 0.4478162094347004, "policy_loss": -0.009419817654197532, "vf_loss": 9.966974124217085, "vf_loss_unclipped": 17265.537645807653, "vf_explained_var": -9.601558449425931e-07, "entropy": 7.340232771851107, "mean_kl_loss": 0.011469912273098288, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 644.3805359715992, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 388000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 6326.282, "sample_time_ms": 3012.719, "synch_weights_time_ms": 1.558}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 97, "trial_id": "0bf95_00000", "date": "2023-12-14_19-40-15", "timestamp": 1702600815, "time_this_iter_s": 6.208986759185791, "time_total_s": 615.1608278751373, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 615.1608278751373, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 30.37777777777778, "ram_util_percent": 80.4888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.42714134170048274}, "default_policy": {"total_loss": 0.42714134170048274, "policy_loss": -0.00841589773290737, "vf_loss": 9.924750758132447, "vf_loss_unclipped": 17661.968588367454, "vf_explained_var": -9.578682466356484e-07, "entropy": 7.375735084639429, "mean_kl_loss": 0.01078805051583758, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 643.4629728780225, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 392000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 6115.952, "sample_time_ms": 2805.776, "synch_weights_time_ms": 1.525}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 98, "trial_id": "0bf95_00000", "date": "2023-12-14_19-40-21", "timestamp": 1702600821, "time_this_iter_s": 6.21776270866394, "time_total_s": 621.3785905838013, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 621.3785905838013, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 29.522222222222222, "ram_util_percent": 80.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5322793694669758}, "default_policy": {"total_loss": 0.5322793694669758, "policy_loss": -0.008254360972788494, "vf_loss": 9.86817395509179, "vf_loss_unclipped": 15239.130725950066, "vf_explained_var": -9.573598914563274e-07, "entropy": 7.382978832289608, "mean_kl_loss": 0.014173605806167376, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 636.5878692053966, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 396000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 6141.601, "sample_time_ms": 2820.299, "synch_weights_time_ms": 1.532}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 99, "trial_id": "0bf95_00000", "date": "2023-12-14_19-40-27", "timestamp": 1702600827, "time_this_iter_s": 6.284779071807861, "time_total_s": 627.6633696556091, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 627.6633696556091, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 31.477777777777778, "ram_util_percent": 80.54444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4815351724592862}, "default_policy": {"total_loss": 0.4815351724592862, "policy_loss": -0.011718072322830717, "vf_loss": 9.716309970375825, "vf_loss_unclipped": 10301.150374585377, "vf_explained_var": -9.59647489763272e-07, "entropy": 7.230045559055515, "mean_kl_loss": 0.012705670066367672, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 651.2991498009908, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 400000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 6148.558, "sample_time_ms": 2823.547, "synch_weights_time_ms": 1.554}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 100, "trial_id": "0bf95_00000", "date": "2023-12-14_19-40-34", "timestamp": 1702600834, "time_this_iter_s": 6.143044948577881, "time_total_s": 633.806414604187, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 633.806414604187, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 26.444444444444443, "ram_util_percent": 80.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3377100155631235}, "default_policy": {"total_loss": 0.3377100155631235, "policy_loss": -0.016824782563885775, "vf_loss": 9.336324313556208, "vf_loss_unclipped": 4106.0525440142865, "vf_explained_var": -9.5863077940463e-07, "entropy": 7.18881816599669, "mean_kl_loss": 0.008377789106002162, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 662.0858090361849, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 404000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 6153.127, "sample_time_ms": 2825.687, "synch_weights_time_ms": 1.563}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 101, "trial_id": "0bf95_00000", "date": "2023-12-14_19-40-40", "timestamp": 1702600840, "time_this_iter_s": 6.042959690093994, "time_total_s": 639.849374294281, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 639.849374294281, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 32.5875, "ram_util_percent": 80.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2631041859147518}, "default_policy": {"total_loss": 0.2631041859147518, "policy_loss": -0.014412083574183492, "vf_loss": 8.886169601859315, "vf_loss_unclipped": 566.0194514463706, "vf_explained_var": -9.545639379700618e-07, "entropy": 7.1306060041700094, "mean_kl_loss": 0.00605160935502276, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 664.1998513893245, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 408000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 6159.438, "sample_time_ms": 2824.62, "synch_weights_time_ms": 1.606}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 102, "trial_id": "0bf95_00000", "date": "2023-12-14_19-40-46", "timestamp": 1702600846, "time_this_iter_s": 6.023759126663208, "time_total_s": 645.8731334209442, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 645.8731334209442, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 30.58888888888889, "ram_util_percent": 80.32222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24204121958186378}, "default_policy": {"total_loss": 0.24204121958186378, "policy_loss": -0.017289655992258856, "vf_loss": 8.766853348278541, "vf_loss_unclipped": 308.8209646871603, "vf_explained_var": -9.553264707390433e-07, "entropy": 7.091939256643689, "mean_kl_loss": 0.0055065372105514284, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 648.1909323285711, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 412000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 6162.193, "sample_time_ms": 2825.116, "synch_weights_time_ms": 1.634}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 103, "trial_id": "0bf95_00000", "date": "2023-12-14_19-40-52", "timestamp": 1702600852, "time_this_iter_s": 6.172322988510132, "time_total_s": 652.0454564094543, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 652.0454564094543, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 34.06666666666667, "ram_util_percent": 80.47777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.29999872194583227}, "default_policy": {"total_loss": 0.29999872194583227, "policy_loss": -0.009596101151826953, "vf_loss": 8.948374373063858, "vf_loss_unclipped": 275.3971352079021, "vf_explained_var": -9.559619147131947e-07, "entropy": 7.017592322851804, "mean_kl_loss": 0.007060662366432519, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 642.0636149526298, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 416000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 6186.865, "sample_time_ms": 2836.749, "synch_weights_time_ms": 1.658}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 104, "trial_id": "0bf95_00000", "date": "2023-12-14_19-40-58", "timestamp": 1702600858, "time_this_iter_s": 6.231564044952393, "time_total_s": 658.2770204544067, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 658.2770204544067, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 35.144444444444446, "ram_util_percent": 80.41111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5227837809828172}, "default_policy": {"total_loss": 0.5227837809828172, "policy_loss": -0.007839067642495576, "vf_loss": 9.190520544804489, "vf_loss_unclipped": 276.31567153442643, "vf_explained_var": -9.560890035080248e-07, "entropy": 7.00706087297468, "mean_kl_loss": 0.01407306323064815, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -286885.2274457491, "episode_len_mean": 35039.3, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19501367220548538, "mean_inference_ms": 0.9750363000382885, "mean_action_processing_ms": 0.04857707803732672, "mean_env_wait_ms": 0.2994642534010561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046062469482421875, "StateBufferConnector_ms": 0.0023555755615234375, "ViewRequirementAgentConnector_ms": 0.14923810958862305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 647.3098424013547, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 420000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 6189.847, "sample_time_ms": 2845.655, "synch_weights_time_ms": 1.641}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 105, "trial_id": "0bf95_00000", "date": "2023-12-14_19-41-04", "timestamp": 1702600864, "time_this_iter_s": 6.180982828140259, "time_total_s": 664.458003282547, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 664.458003282547, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 36.7375, "ram_util_percent": 80.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.627478493897836}, "default_policy": {"total_loss": 0.627478493897836, "policy_loss": -0.006672203330311185, "vf_loss": 9.042276728127812, "vf_loss_unclipped": 335.4488853503392, "vf_explained_var": -9.558348259183644e-07, "entropy": 7.031935051814325, "mean_kl_loss": 0.017441554087816603, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 486.7731112629701, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 424000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 6371.037, "sample_time_ms": 3043.393, "synch_weights_time_ms": 1.653}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 106, "trial_id": "0bf95_00000", "date": "2023-12-14_19-41-13", "timestamp": 1702600873, "time_this_iter_s": 8.218959093093872, "time_total_s": 672.6769623756409, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 672.6769623756409, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 24.758333333333336, "ram_util_percent": 80.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6967098133078516}, "default_policy": {"total_loss": 0.6967098133078516, "policy_loss": -0.007418473549524763, "vf_loss": 9.225362418811205, "vf_loss_unclipped": 387.0484480868016, "vf_explained_var": -9.55707737123534e-07, "entropy": 7.027006902674368, "mean_kl_loss": 0.019627546215557613, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.17428207397461}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 670.6255864450715, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 428000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 6346.744, "sample_time_ms": 3027.286, "synch_weights_time_ms": 1.657}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 107, "trial_id": "0bf95_00000", "date": "2023-12-14_19-41-19", "timestamp": 1702600879, "time_this_iter_s": 5.96575403213501, "time_total_s": 678.6427164077759, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 678.6427164077759, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 30.21111111111111, "ram_util_percent": 80.4888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21148974692294084}, "default_policy": {"total_loss": 0.21148974692294084, "policy_loss": -0.009610789092773917, "vf_loss": 9.051473328807969, "vf_loss_unclipped": 299.0389151420675, "vf_explained_var": -9.564702698925156e-07, "entropy": 7.035663381060049, "mean_kl_loss": 0.0041888952394834155, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.587141036987305}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 673.5020402710256, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 432000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 6319.018, "sample_time_ms": 3006.6, "synch_weights_time_ms": 1.667}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 108, "trial_id": "0bf95_00000", "date": "2023-12-14_19-41-24", "timestamp": 1702600884, "time_this_iter_s": 5.940375089645386, "time_total_s": 684.5830914974213, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 684.5830914974213, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 29.7625, "ram_util_percent": 79.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3182949780313763}, "default_policy": {"total_loss": 0.3182949780313763, "policy_loss": -0.021301210778993742, "vf_loss": 9.157638467959504, "vf_loss_unclipped": 397.19889068603516, "vf_explained_var": -9.55199381944213e-07, "entropy": 7.034918962002817, "mean_kl_loss": 0.015911821305778576, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.587141036987305}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 651.5754158249734, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 436000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 6304.565, "sample_time_ms": 2995.053, "synch_weights_time_ms": 1.666}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 109, "trial_id": "0bf95_00000", "date": "2023-12-14_19-41-31", "timestamp": 1702600891, "time_this_iter_s": 6.140330076217651, "time_total_s": 690.7234215736389, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 690.7234215736389, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 27.2, "ram_util_percent": 81.4111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.32775208962632457}, "default_policy": {"total_loss": 0.32775208962632457, "policy_loss": -0.014254271429327966, "vf_loss": 8.92192145095451, "vf_loss_unclipped": 669.777540312647, "vf_explained_var": -9.560890035080248e-07, "entropy": 7.060038350030049, "mean_kl_loss": 0.01621767290628829, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.587141036987305}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 664.0349683903714, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 440000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 6292.787, "sample_time_ms": 2979.378, "synch_weights_time_ms": 1.643}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 110, "trial_id": "0bf95_00000", "date": "2023-12-14_19-41-37", "timestamp": 1702600897, "time_this_iter_s": 6.025295972824097, "time_total_s": 696.748717546463, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 696.748717546463, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 35.7875, "ram_util_percent": 81.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.32681250924875993}, "default_policy": {"total_loss": 0.32681250924875993, "policy_loss": -0.02236049088772569, "vf_loss": 9.438813142939162, "vf_loss_unclipped": 3200.561799071745, "vf_explained_var": -9.653664855306337e-07, "entropy": 6.965620852736776, "mean_kl_loss": 0.016345837110377716, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.587141036987305}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 672.0281891707158, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 444000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 6283.848, "sample_time_ms": 2968.96, "synch_weights_time_ms": 1.638}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 111, "trial_id": "0bf95_00000", "date": "2023-12-14_19-41-43", "timestamp": 1702600903, "time_this_iter_s": 5.953503131866455, "time_total_s": 702.7022206783295, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 702.7022206783295, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 27.011111111111106, "ram_util_percent": 81.32222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.3159353658278932}, "default_policy": {"total_loss": 1.3159353658278932, "policy_loss": 0.008626225803579603, "vf_loss": 9.444963476551113, "vf_loss_unclipped": 5177.9786807753635, "vf_explained_var": -9.58122424225309e-07, "entropy": 6.973844156082251, "mean_kl_loss": 0.07781154393182745, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 23.38071060180664}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 648.3189272258718, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 6298.601, "sample_time_ms": 2975.861, "synch_weights_time_ms": 1.624}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 112, "trial_id": "0bf95_00000", "date": "2023-12-14_19-41-49", "timestamp": 1702600909, "time_this_iter_s": 6.171604871749878, "time_total_s": 708.8738255500793, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 708.8738255500793, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 30.544444444444448, "ram_util_percent": 81.65555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3265198293541159}, "default_policy": {"total_loss": 0.3265198293541159, "policy_loss": -0.014375902582277686, "vf_loss": 9.91566407197574, "vf_loss_unclipped": 14020.381880445013, "vf_explained_var": -9.62570532044368e-07, "entropy": 6.9673813853436695, "mean_kl_loss": 0.010339253305822168, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 23.38071060180664}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 632.7340960615799, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 452000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 6313.674, "sample_time_ms": 2977.996, "synch_weights_time_ms": 1.627}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 113, "trial_id": "0bf95_00000", "date": "2023-12-14_19-41-55", "timestamp": 1702600915, "time_this_iter_s": 6.323191165924072, "time_total_s": 715.1970167160034, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 715.1970167160034, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 27.900000000000002, "ram_util_percent": 81.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.26561774028294377}, "default_policy": {"total_loss": 0.26561774028294377, "policy_loss": -0.018835611428930435, "vf_loss": 9.827975138926558, "vf_loss_unclipped": 11011.911813683093, "vf_explained_var": -9.619350880702168e-07, "entropy": 6.955221936138454, "mean_kl_loss": 0.00796270066361169, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 23.38071060180664}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 622.0254611538106, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 456000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 6333.743, "sample_time_ms": 3003.155, "synch_weights_time_ms": 1.616}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 114, "trial_id": "0bf95_00000", "date": "2023-12-14_19-42-02", "timestamp": 1702600922, "time_this_iter_s": 6.431873083114624, "time_total_s": 721.628889799118, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 721.628889799118, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 32.96666666666667, "ram_util_percent": 81.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 2.054720188985501}, "default_policy": {"total_loss": 2.054720188985501, "policy_loss": 0.0277559265386619, "vf_loss": 9.909540047269386, "vf_loss_unclipped": 16515.981662644506, "vf_explained_var": -9.553264707390433e-07, "entropy": 7.071045617304885, "mean_kl_loss": 0.08245552899696507, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.071067810058594}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 626.9887352387013, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 460000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 6353.77, "sample_time_ms": 3031.179, "synch_weights_time_ms": 1.612}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 115, "trial_id": "0bf95_00000", "date": "2023-12-14_19-42-08", "timestamp": 1702600928, "time_this_iter_s": 6.381049156188965, "time_total_s": 728.009938955307, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 728.009938955307, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 31.666666666666668, "ram_util_percent": 80.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.30743476644412543}, "default_policy": {"total_loss": 0.30743476644412543, "policy_loss": -0.011626973616650332, "vf_loss": 9.852754211629124, "vf_loss_unclipped": 12992.602139535997, "vf_explained_var": -9.579953354304788e-07, "entropy": 7.036570513426368, "mean_kl_loss": 0.006288208773309143, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.071067810058594}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 621.5801306764907, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 464000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 6175.553, "sample_time_ms": 2862.714, "synch_weights_time_ms": 1.629}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 116, "trial_id": "0bf95_00000", "date": "2023-12-14_19-42-14", "timestamp": 1702600934, "time_this_iter_s": 6.436753034591675, "time_total_s": 734.4466919898987, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 734.4466919898987, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 34.300000000000004, "ram_util_percent": 80.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.35513654942991635}, "default_policy": {"total_loss": 0.35513654942991635, "policy_loss": -0.009734340796449673, "vf_loss": 9.778647991131617, "vf_loss_unclipped": 13720.595180031587, "vf_explained_var": 1.7011978987183397e-05, "entropy": 7.088142711724808, "mean_kl_loss": 0.007615519605853385, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.071067810058594}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 648.8395427745355, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 468000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 6195.58, "sample_time_ms": 2884.908, "synch_weights_time_ms": 1.607}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 117, "trial_id": "0bf95_00000", "date": "2023-12-14_19-42-21", "timestamp": 1702600941, "time_this_iter_s": 6.166480302810669, "time_total_s": 740.6131722927094, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 740.6131722927094, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 26.622222222222224, "ram_util_percent": 79.56666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4607629320546508}, "default_policy": {"total_loss": 0.4607629320546508, "policy_loss": -0.011166252329377636, "vf_loss": 9.658636420520384, "vf_loss_unclipped": 6723.914709778483, "vf_explained_var": -9.55199381944213e-07, "entropy": 6.941620791644684, "mean_kl_loss": 0.010702349325746676, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.071067810058594}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 656.0587794820366, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 472000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 6211.371, "sample_time_ms": 2894.684, "synch_weights_time_ms": 1.621}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 118, "trial_id": "0bf95_00000", "date": "2023-12-14_19-42-27", "timestamp": 1702600947, "time_this_iter_s": 6.09854793548584, "time_total_s": 746.7117202281952, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 746.7117202281952, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 29.700000000000003, "ram_util_percent": 79.55555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6052812138822541}, "default_policy": {"total_loss": 0.6052812138822541, "policy_loss": -0.016738330769632607, "vf_loss": 9.583942259806815, "vf_loss_unclipped": 2868.487975830208, "vf_explained_var": -9.565973586873459e-07, "entropy": 6.945447463724913, "mean_kl_loss": 0.015003253701126056, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.071067810058594}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 675.7429139236572, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 476000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 6189.415, "sample_time_ms": 2882.904, "synch_weights_time_ms": 1.623}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 119, "trial_id": "0bf95_00000", "date": "2023-12-14_19-42-33", "timestamp": 1702600953, "time_this_iter_s": 5.92100191116333, "time_total_s": 752.6327221393585, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 752.6327221393585, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 29.500000000000004, "ram_util_percent": 79.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17985157980752398}, "default_policy": {"total_loss": 0.17985157980752398, "policy_loss": -0.013752676283460118, "vf_loss": 9.002182984402948, "vf_loss_unclipped": 301.2719547784151, "vf_explained_var": -9.55199381944213e-07, "entropy": 6.947414334140607, "mean_kl_loss": 0.002953500853603481, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.535533905029297}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 674.2677856385744, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 480000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 6180.273, "sample_time_ms": 2883.733, "synch_weights_time_ms": 1.625}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 120, "trial_id": "0bf95_00000", "date": "2023-12-14_19-42-39", "timestamp": 1702600959, "time_this_iter_s": 5.9336998462677, "time_total_s": 758.5664219856262, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 758.5664219856262, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 29.85555555555556, "ram_util_percent": 79.58888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.25617441403141405}, "default_policy": {"total_loss": 0.25617441403141405, "policy_loss": -0.012639887056061264, "vf_loss": 8.950553864050013, "vf_loss_unclipped": 251.57853660908845, "vf_explained_var": -9.55199381944213e-07, "entropy": 6.948792193235873, "mean_kl_loss": 0.010225452115394416, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.535533905029297}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 660.1449939426171, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 484000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 6190.987, "sample_time_ms": 2886.17, "synch_weights_time_ms": 1.641}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 121, "trial_id": "0bf95_00000", "date": "2023-12-14_19-42-45", "timestamp": 1702600965, "time_this_iter_s": 6.0610671043396, "time_total_s": 764.6274890899658, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 764.6274890899658, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 32.825, "ram_util_percent": 79.78750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3804556732175193}, "default_policy": {"total_loss": 0.3804556732175193, "policy_loss": -0.009468940445092887, "vf_loss": 9.04260029823287, "vf_loss_unclipped": 307.93267582728663, "vf_explained_var": -9.546910267648921e-07, "entropy": 6.795621462722323, "mean_kl_loss": 0.017079526161668444, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.535533905029297}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}}, "episode_reward_max": -270838.762512636, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -284288.6493879835, "episode_len_mean": 35039.25, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19496214591470937, "mean_inference_ms": 0.9743058417922055, "mean_action_processing_ms": 0.04855296475768947, "mean_env_wait_ms": 0.2933186318826377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004583597183227539, "StateBufferConnector_ms": 0.002417961756388346, "ViewRequirementAgentConnector_ms": 0.15206336975097656}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 667.9481348952005, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 488000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 6172.855, "sample_time_ms": 2895.642, "synch_weights_time_ms": 1.646}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 122, "trial_id": "0bf95_00000", "date": "2023-12-14_19-42-51", "timestamp": 1702600971, "time_this_iter_s": 5.989885091781616, "time_total_s": 770.6173741817474, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 770.6173741817474, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 35.26666666666667, "ram_util_percent": 80.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.23785885248674768}, "default_policy": {"total_loss": 0.23785885248674768, "policy_loss": -0.0074391255183999284, "vf_loss": 8.943631705953115, "vf_loss_unclipped": 334.5554581908529, "vf_explained_var": -9.558348259183644e-07, "entropy": 6.937976877318262, "mean_kl_loss": 0.008888332927360326, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.535533905029297}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 486.0326299050112, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 492000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 6363.669, "sample_time_ms": 3111.947, "synch_weights_time_ms": 1.586}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 123, "trial_id": "0bf95_00000", "date": "2023-12-14_19-42-59", "timestamp": 1702600979, "time_this_iter_s": 8.231322050094604, "time_total_s": 778.848696231842, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 778.848696231842, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 30.11818181818182, "ram_util_percent": 81.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 2.030927412505788}, "default_policy": {"total_loss": 2.030927412505788, "policy_loss": 0.03624451281760992, "vf_loss": 9.08914737508241, "vf_loss_unclipped": 377.8526237870076, "vf_explained_var": -9.57614069045988e-07, "entropy": 6.698501955979923, "mean_kl_loss": 0.10856763418123282, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 26.303300857543945}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 660.9888884222414, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 496000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 6325.762, "sample_time_ms": 3085.875, "synch_weights_time_ms": 1.591}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 124, "trial_id": "0bf95_00000", "date": "2023-12-14_19-43-05", "timestamp": 1702600985, "time_this_iter_s": 6.052745342254639, "time_total_s": 784.9014415740967, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 784.9014415740967, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 31.666666666666668, "ram_util_percent": 81.34444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6244033193156155}, "default_policy": {"total_loss": 0.6244033193156155, "policy_loss": 0.0004843963619901427, "vf_loss": 8.936936801938868, "vf_loss_unclipped": 296.67531796355746, "vf_explained_var": -9.545639379700618e-07, "entropy": 6.900432882532637, "mean_kl_loss": 0.020322527554433378, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 39.454952239990234}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 676.183711312085, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 500000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 6279.348, "sample_time_ms": 3041.015, "synch_weights_time_ms": 1.595}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 125, "trial_id": "0bf95_00000", "date": "2023-12-14_19-43-11", "timestamp": 1702600991, "time_this_iter_s": 5.916995048522949, "time_total_s": 790.8184366226196, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 790.8184366226196, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 29.962500000000002, "ram_util_percent": 81.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.36547247691354007}, "default_policy": {"total_loss": 0.36547247691354007, "policy_loss": -0.007214065264366361, "vf_loss": 9.09350382951277, "vf_loss_unclipped": 308.00812161248376, "vf_explained_var": -9.546910267648921e-07, "entropy": 6.683436472532846, "mean_kl_loss": 0.007141093523581021, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 39.454952239990234}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 675.083378383245, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 504000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 6228.347, "sample_time_ms": 2985.517, "synch_weights_time_ms": 1.6}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 126, "trial_id": "0bf95_00000", "date": "2023-12-14_19-43-17", "timestamp": 1702600997, "time_this_iter_s": 5.926607847213745, "time_total_s": 796.7450444698334, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 796.7450444698334, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 28.377777777777776, "ram_util_percent": 81.21111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4379079457459801}, "default_policy": {"total_loss": 0.4379079457459801, "policy_loss": -0.007285306317064522, "vf_loss": 9.05746890995294, "vf_loss_unclipped": 549.4549181273243, "vf_explained_var": -9.587578681994603e-07, "entropy": 6.891322684948887, "mean_kl_loss": 0.008987935508034433, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 39.454952239990234}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 673.9436540226632, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 508000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 6205.383, "sample_time_ms": 2967.6, "synch_weights_time_ms": 1.588}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 127, "trial_id": "0bf95_00000", "date": "2023-12-14_19-43-23", "timestamp": 1702601003, "time_this_iter_s": 5.936677932739258, "time_total_s": 802.6817224025726, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 802.6817224025726, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 28.950000000000003, "ram_util_percent": 81.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.9700989524947047}, "default_policy": {"total_loss": 0.9700989524947047, "policy_loss": -0.00012592205267423378, "vf_loss": 8.979402258452067, "vf_loss_unclipped": 917.0573316057607, "vf_explained_var": -9.568515362770065e-07, "entropy": 6.857924442555604, "mean_kl_loss": 0.02231483775370185, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 59.18242645263672}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 678.5541470097328, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 512000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 6185.17, "sample_time_ms": 2954.678, "synch_weights_time_ms": 1.579}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 128, "trial_id": "0bf95_00000", "date": "2023-12-14_19-43-29", "timestamp": 1702601009, "time_this_iter_s": 5.896122217178345, "time_total_s": 808.577844619751, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 808.577844619751, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 27.633333333333333, "ram_util_percent": 81.08888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.332605072446088}, "default_policy": {"total_loss": 3.332605072446088, "policy_loss": 0.006366582749449194, "vf_loss": 9.583852887916159, "vf_loss_unclipped": 5821.682914229598, "vf_explained_var": -9.681624390168993e-07, "entropy": 6.842259613944015, "mean_kl_loss": 0.05458377043149023, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 88.77363586425781}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 676.1001648620232, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 516000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 6184.858, "sample_time_ms": 2953.251, "synch_weights_time_ms": 1.585}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 129, "trial_id": "0bf95_00000", "date": "2023-12-14_19-43-35", "timestamp": 1702601015, "time_this_iter_s": 5.9176552295684814, "time_total_s": 814.4954998493195, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 814.4954998493195, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 26.0375, "ram_util_percent": 81.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.0324595877483709}, "default_policy": {"total_loss": 1.0324595877483709, "policy_loss": -0.004498631376197248, "vf_loss": 9.691177638609018, "vf_loss_unclipped": 11052.55029981731, "vf_explained_var": -9.585036906097998e-07, "entropy": 6.982083044580813, "mean_kl_loss": 0.010589252381405671, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 88.77363586425781}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 663.3502349649831, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 520000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 6194.621, "sample_time_ms": 2964.344, "synch_weights_time_ms": 1.575}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 130, "trial_id": "0bf95_00000", "date": "2023-12-14_19-43-41", "timestamp": 1702601021, "time_this_iter_s": 6.031379222869873, "time_total_s": 820.5268790721893, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 820.5268790721893, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 27.788888888888888, "ram_util_percent": 80.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.3298253026852476}, "default_policy": {"total_loss": 1.3298253026852476, "policy_loss": -0.001810890595132767, "vf_loss": 9.710052595972252, "vf_loss_unclipped": 11499.947020849948, "vf_explained_var": -9.5863077940463e-07, "entropy": 6.9447570635057465, "mean_kl_loss": 0.01390655742844348, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 88.77363586425781}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 672.242369243791, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 524000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 6183.718, "sample_time_ms": 2968.154, "synch_weights_time_ms": 1.6}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 131, "trial_id": "0bf95_00000", "date": "2023-12-14_19-43-47", "timestamp": 1702601027, "time_this_iter_s": 5.951503276824951, "time_total_s": 826.4783823490143, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 826.4783823490143, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 26.3, "ram_util_percent": 80.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.9384560335133629}, "default_policy": {"total_loss": 0.9384560335133629, "policy_loss": 1.7527384119533273e-05, "vf_loss": 9.9295044484169, "vf_loss_unclipped": 16944.27569801314, "vf_explained_var": -9.629517984288587e-07, "entropy": 7.0888075005016855, "mean_kl_loss": 0.009452620188630753, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 88.77363586425781}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 665.5192026217081, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 528000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 6185.904, "sample_time_ms": 2963.861, "synch_weights_time_ms": 1.592}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 132, "trial_id": "0bf95_00000", "date": "2023-12-14_19-43-53", "timestamp": 1702601033, "time_this_iter_s": 6.011749029159546, "time_total_s": 832.4901313781738, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 832.4901313781738, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 25.444444444444443, "ram_util_percent": 81.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.41596568495765934}, "default_policy": {"total_loss": 0.41596568495765934, "policy_loss": -0.004394995535278061, "vf_loss": 9.90330871386823, "vf_loss_unclipped": 15011.168125827684, "vf_explained_var": -9.583766018149695e-07, "entropy": 7.138830323717487, "mean_kl_loss": 0.0036196286086577797, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 44.386817932128906}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 654.9323496423195, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 532000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 5973.665, "sample_time_ms": 2745.014, "synch_weights_time_ms": 1.615}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 133, "trial_id": "0bf95_00000", "date": "2023-12-14_19-43-59", "timestamp": 1702601039, "time_this_iter_s": 6.109113931655884, "time_total_s": 838.5992453098297, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 838.5992453098297, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 25.56666666666667, "ram_util_percent": 81.05555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.537475009049688}, "default_policy": {"total_loss": 0.537475009049688, "policy_loss": -0.003401959443272256, "vf_loss": 9.863366966816917, "vf_loss_unclipped": 13650.450160272594, "vf_explained_var": -9.626976208391983e-07, "entropy": 7.148155792435603, "mean_kl_loss": 0.009963392712492358, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 44.386817932128906}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 633.1534534458943, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 536000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 6000.27, "sample_time_ms": 2763.173, "synch_weights_time_ms": 1.623}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 134, "trial_id": "0bf95_00000", "date": "2023-12-14_19-44-05", "timestamp": 1702601045, "time_this_iter_s": 6.319120168685913, "time_total_s": 844.9183654785156, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 844.9183654785156, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 32.955555555555556, "ram_util_percent": 81.97777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2776720182997967}, "default_policy": {"total_loss": 0.2776720182997967, "policy_loss": -0.007563199335609926, "vf_loss": 9.752626928439273, "vf_loss_unclipped": 9905.06509819112, "vf_explained_var": -9.587578681994603e-07, "entropy": 7.0050814070427085, "mean_kl_loss": 0.0042289344024434156, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.193408966064453}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 662.7062541490202, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 540000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 6012.301, "sample_time_ms": 2784.369, "synch_weights_time_ms": 1.609}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 135, "trial_id": "0bf95_00000", "date": "2023-12-14_19-44-11", "timestamp": 1702601051, "time_this_iter_s": 6.037230730056763, "time_total_s": 850.9555962085724, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 850.9555962085724, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 31.775000000000002, "ram_util_percent": 81.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.29066166854394015}, "default_policy": {"total_loss": 0.29066166854394015, "policy_loss": -0.01617598882280608, "vf_loss": 9.406902074813843, "vf_loss_unclipped": 4552.120600263193, "vf_explained_var": -9.574869802511577e-07, "entropy": 6.933581996828254, "mean_kl_loss": 0.009587019415175164, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.193408966064453}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 676.6281131671257, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 544000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 6010.948, "sample_time_ms": 2783.304, "synch_weights_time_ms": 1.603}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 136, "trial_id": "0bf95_00000", "date": "2023-12-14_19-44-17", "timestamp": 1702601057, "time_this_iter_s": 5.91303825378418, "time_total_s": 856.8686344623566, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 856.8686344623566, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 27.966666666666665, "ram_util_percent": 81.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20309390611787723}, "default_policy": {"total_loss": 0.20309390611787723, "policy_loss": -0.01585155526108579, "vf_loss": 8.930669941627649, "vf_loss_unclipped": 740.2250774603154, "vf_explained_var": -9.545639379700618e-07, "entropy": 6.878813882880627, "mean_kl_loss": 0.0058413182789065965, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.193408966064453}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 667.4265240566232, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 548000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 6016.743, "sample_time_ms": 2781.044, "synch_weights_time_ms": 1.638}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 137, "trial_id": "0bf95_00000", "date": "2023-12-14_19-44-23", "timestamp": 1702601063, "time_this_iter_s": 5.994997978210449, "time_total_s": 862.863632440567, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 862.863632440567, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 30.725, "ram_util_percent": 81.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24063058632777443}, "default_policy": {"total_loss": 0.24063058632777443, "policy_loss": -0.01832005735000234, "vf_loss": 9.078789699306366, "vf_loss_unclipped": 508.248596736363, "vf_explained_var": -9.564702698925156e-07, "entropy": 6.852614239080628, "mean_kl_loss": 0.007577148180931149, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.193408966064453}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 621.7216989085455, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 552000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 6070.628, "sample_time_ms": 2825.469, "synch_weights_time_ms": 1.679}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 138, "trial_id": "0bf95_00000", "date": "2023-12-14_19-44-30", "timestamp": 1702601070, "time_this_iter_s": 6.435219049453735, "time_total_s": 869.2988514900208, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 869.2988514900208, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 38.355555555555554, "ram_util_percent": 80.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.25182231442569925}, "default_policy": {"total_loss": 0.25182231442569925, "policy_loss": -0.009333281198204724, "vf_loss": 9.102331582925467, "vf_loss_unclipped": 347.2773553445649, "vf_explained_var": -9.544368491752315e-07, "entropy": 6.785970525700908, "mean_kl_loss": 0.0076658922690785985, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.193408966064453}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 613.3770709389948, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 556000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 6131.126, "sample_time_ms": 2877.694, "synch_weights_time_ms": 1.714}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 139, "trial_id": "0bf95_00000", "date": "2023-12-14_19-44-36", "timestamp": 1702601076, "time_this_iter_s": 6.523187160491943, "time_total_s": 875.8220386505127, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 875.8220386505127, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 43.480000000000004, "ram_util_percent": 80.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.9344180751917586}, "default_policy": {"total_loss": 0.9344180751917586, "policy_loss": 0.0016172732025988574, "vf_loss": 9.203226441767677, "vf_loss_unclipped": 361.9639974321638, "vf_explained_var": -9.554535595338736e-07, "entropy": 6.722608836729135, "mean_kl_loss": 0.03788370412738718, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 33.29011535644531}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}}, "episode_reward_max": -270658.5469340645, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -282398.5142610628, "episode_len_mean": 35039.21428571428, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492665993022734, "mean_inference_ms": 0.9738111695789867, "mean_action_processing_ms": 0.04853030059658851, "mean_env_wait_ms": 0.2886455894125614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004490784236363002, "StateBufferConnector_ms": 0.0024488994053431918, "ViewRequirementAgentConnector_ms": 0.17492430550711496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 644.8549848316701, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 560000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 6148.419, "sample_time_ms": 2884.986, "synch_weights_time_ms": 1.742}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 140, "trial_id": "0bf95_00000", "date": "2023-12-14_19-44-42", "timestamp": 1702601082, "time_this_iter_s": 6.204207897186279, "time_total_s": 882.026246547699, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 882.026246547699, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 40.06666666666666, "ram_util_percent": 80.04444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.4060650431334591}, "default_policy": {"total_loss": 1.4060650431334591, "policy_loss": 0.007211272629089097, "vf_loss": 9.120842131978668, "vf_loss_unclipped": 397.0158851395792, "vf_explained_var": -9.5367431640625e-07, "entropy": 6.818871309508139, "mean_kl_loss": 0.039280288917121764, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 49.93517303466797}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 470.22975544303483, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 564000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 6404.043, "sample_time_ms": 3135.24, "synch_weights_time_ms": 3.279}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 141, "trial_id": "0bf95_00000", "date": "2023-12-14_19-44-51", "timestamp": 1702601091, "time_this_iter_s": 8.531327247619629, "time_total_s": 890.5575737953186, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 890.5575737953186, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 28.474999999999998, "ram_util_percent": 80.31666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.3141053304521007}, "default_policy": {"total_loss": 1.3141053304521007, "policy_loss": 0.0028894438166548607, "vf_loss": 9.268400489140166, "vf_loss_unclipped": 401.65794015896597, "vf_explained_var": -9.534201388165895e-07, "entropy": 6.6975669515158325, "mean_kl_loss": 0.02440227612389406, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 74.90275573730469}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 648.4705576048341, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 568000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 6419.843, "sample_time_ms": 3138.074, "synch_weights_time_ms": 3.314}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 142, "trial_id": "0bf95_00000", "date": "2023-12-14_19-44-57", "timestamp": 1702601097, "time_this_iter_s": 6.171162128448486, "time_total_s": 896.7287359237671, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 896.7287359237671, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 36.5, "ram_util_percent": 80.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2924038061518659}, "default_policy": {"total_loss": 0.2924038061518659, "policy_loss": -0.0047300861560618445, "vf_loss": 9.174215437252638, "vf_loss_unclipped": 357.056841112149, "vf_explained_var": -9.554535595338736e-07, "entropy": 6.71719448144502, "mean_kl_loss": 0.0027421119025435427, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.451377868652344}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 603.1949903641766, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 572000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 6472.224, "sample_time_ms": 3180.555, "synch_weights_time_ms": 3.327}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 143, "trial_id": "0bf95_00000", "date": "2023-12-14_19-45-04", "timestamp": 1702601104, "time_this_iter_s": 6.63275408744812, "time_total_s": 903.3614900112152, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 903.3614900112152, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 50.67777777777778, "ram_util_percent": 80.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2709826779668964}, "default_policy": {"total_loss": 0.2709826779668964, "policy_loss": -0.008833030083858127, "vf_loss": 9.082852836865097, "vf_loss_unclipped": 346.05823725067984, "vf_explained_var": -9.549452043545526e-07, "entropy": 6.719529350175024, "mean_kl_loss": 0.005046200977067744, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.451377868652344}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 667.8581300818187, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 576000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 6439.395, "sample_time_ms": 3157.011, "synch_weights_time_ms": 3.336}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 144, "trial_id": "0bf95_00000", "date": "2023-12-14_19-45-10", "timestamp": 1702601110, "time_this_iter_s": 5.990647792816162, "time_total_s": 909.3521378040314, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 909.3521378040314, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 27.566666666666666, "ram_util_percent": 80.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.529785140896085}, "default_policy": {"total_loss": 0.529785140896085, "policy_loss": -0.007950197740483767, "vf_loss": 8.96520190655804, "vf_loss_unclipped": 773.305549544312, "vf_explained_var": -9.554535595338736e-07, "entropy": 6.796967337634772, "mean_kl_loss": 0.011964401718108544, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.451377868652344}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 660.863079141914, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 580000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 6441.078, "sample_time_ms": 3152.975, "synch_weights_time_ms": 3.394}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 145, "trial_id": "0bf95_00000", "date": "2023-12-14_19-45-16", "timestamp": 1702601116, "time_this_iter_s": 6.0541300773620605, "time_total_s": 915.4062678813934, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 915.4062678813934, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 36.3625, "ram_util_percent": 80.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.41664393106376185}, "default_policy": {"total_loss": 0.41664393106376185, "policy_loss": -0.014547157516109266, "vf_loss": 9.46204716106976, "vf_loss_unclipped": 4108.388276822023, "vf_explained_var": -9.65112307940973e-07, "entropy": 6.830868228412132, "mean_kl_loss": 0.008986868805005408, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.451377868652344}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 645.1312177388074, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 584000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 6469.941, "sample_time_ms": 3169.246, "synch_weights_time_ms": 3.386}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 146, "trial_id": "0bf95_00000", "date": "2023-12-14_19-45-22", "timestamp": 1702601122, "time_this_iter_s": 6.201993942260742, "time_total_s": 921.6082618236542, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 921.6082618236542, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 34.73333333333333, "ram_util_percent": 80.47777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.560478653115377}, "default_policy": {"total_loss": 3.560478653115377, "policy_loss": 0.014377549686320205, "vf_loss": 9.240272896122068, "vf_loss_unclipped": 5758.372127752568, "vf_explained_var": -9.59647489763272e-07, "entropy": 6.813018027653318, "mean_kl_loss": 0.09221819222494387, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 56.177066802978516}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 632.6635175812164, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 588000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 6502.869, "sample_time_ms": 3200.463, "synch_weights_time_ms": 3.415}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 147, "trial_id": "0bf95_00000", "date": "2023-12-14_19-45-28", "timestamp": 1702601128, "time_this_iter_s": 6.324025869369507, "time_total_s": 927.9322876930237, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 927.9322876930237, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 41.266666666666666, "ram_util_percent": 80.27777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.35747570021828606}, "default_policy": {"total_loss": 0.35747570021828606, "policy_loss": -0.007035668607233271, "vf_loss": 9.9132848304472, "vf_loss_unclipped": 18487.613537623685, "vf_explained_var": -9.61045466506405e-07, "entropy": 7.036556934242818, "mean_kl_loss": 0.004723965368076746, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 28.088533401489258}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 587.5916955383287, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 592000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 6540.238, "sample_time_ms": 3232.78, "synch_weights_time_ms": 3.625}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 148, "trial_id": "0bf95_00000", "date": "2023-12-14_19-45-35", "timestamp": 1702601135, "time_this_iter_s": 6.817471027374268, "time_total_s": 934.749758720398, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 934.749758720398, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 47.230000000000004, "ram_util_percent": 81.01999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5575562136720366}, "default_policy": {"total_loss": 0.5575562136720366, "policy_loss": -0.008019510414828656, "vf_loss": 9.780117939275973, "vf_loss_unclipped": 12877.433333342009, "vf_explained_var": -9.602829337374235e-07, "entropy": 6.950401273109257, "mean_kl_loss": 0.01665357651288506, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 28.088533401489258}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 659.8355926554641, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 596000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 6494.323, "sample_time_ms": 3199.53, "synch_weights_time_ms": 3.603}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 149, "trial_id": "0bf95_00000", "date": "2023-12-14_19-45-41", "timestamp": 1702601141, "time_this_iter_s": 6.063629865646362, "time_total_s": 940.8133885860443, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 940.8133885860443, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 34.0, "ram_util_percent": 80.9875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.3445997801956846}, "default_policy": {"total_loss": 1.3445997801956846, "policy_loss": 0.010920801055011973, "vf_loss": 9.929304894607967, "vf_loss_unclipped": 22454.005339079573, "vf_explained_var": -9.646039527616522e-07, "entropy": 7.088217171524634, "mean_kl_loss": 0.04394625795828451, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 42.1328010559082}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 615.7269547234938, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 600000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 6523.665, "sample_time_ms": 3229.871, "synch_weights_time_ms": 3.644}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 150, "trial_id": "0bf95_00000", "date": "2023-12-14_19-45-48", "timestamp": 1702601148, "time_this_iter_s": 6.497582197189331, "time_total_s": 947.3109707832336, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 947.3109707832336, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 34.05, "ram_util_percent": 81.12000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.41181709894588764}, "default_policy": {"total_loss": 0.41181709894588764, "policy_loss": -0.008799681951453699, "vf_loss": 9.86649870719991, "vf_loss_unclipped": 17236.443368842607, "vf_explained_var": -9.638414199926705e-07, "entropy": 7.017195914091586, "mean_kl_loss": 0.007641357464851367, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 42.1328010559082}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 625.5657452856004, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 604000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 604000, "timers": {"training_iteration_time_ms": 6312.437, "sample_time_ms": 2997.611, "synch_weights_time_ms": 2.173}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 151, "trial_id": "0bf95_00000", "date": "2023-12-14_19-45-54", "timestamp": 1702601154, "time_this_iter_s": 6.396933078765869, "time_total_s": 953.7079038619995, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 953.7079038619995, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 35.52222222222222, "ram_util_percent": 81.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.36544823768868373}, "default_policy": {"total_loss": 0.36544823768868373, "policy_loss": -0.008660663978935385, "vf_loss": 9.840371076994613, "vf_loss_unclipped": 16075.542037052895, "vf_explained_var": -9.634601536081798e-07, "entropy": 6.966958752064817, "mean_kl_loss": 0.0065437184850941155, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 42.1328010559082}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 620.1165709521651, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 608000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 6340.638, "sample_time_ms": 3021.0, "synch_weights_time_ms": 2.144}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 152, "trial_id": "0bf95_00000", "date": "2023-12-14_19-46-01", "timestamp": 1702601161, "time_this_iter_s": 6.451900959014893, "time_total_s": 960.1598048210144, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 960.1598048210144, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 38.03333333333333, "ram_util_percent": 81.72222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.47327012054002615}, "default_policy": {"total_loss": 0.47327012054002615, "policy_loss": -0.0072987579153791105, "vf_loss": 9.660771670880349, "vf_loss_unclipped": 11414.705135630138, "vf_explained_var": -9.587578681994603e-07, "entropy": 6.834365921996549, "mean_kl_loss": 0.009113117382563159, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 42.1328010559082}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 621.8143313070979, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 612000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 6320.783, "sample_time_ms": 2994.72, "synch_weights_time_ms": 2.293}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 153, "trial_id": "0bf95_00000", "date": "2023-12-14_19-46-07", "timestamp": 1702601167, "time_this_iter_s": 6.4422078132629395, "time_total_s": 966.6020126342773, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 966.6020126342773, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 30.27777777777778, "ram_util_percent": 81.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5784784412221995}, "default_policy": {"total_loss": 0.5784784412221995, "policy_loss": -0.007575923438444098, "vf_loss": 9.406880730504929, "vf_loss_unclipped": 4084.2251151518017, "vf_explained_var": -9.565973586873459e-07, "entropy": 6.6291833101813475, "mean_kl_loss": 0.011677020195168072, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 42.1328010559082}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 644.9013625359916, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 616000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 6342.102, "sample_time_ms": 3008.682, "synch_weights_time_ms": 2.302}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 154, "trial_id": "0bf95_00000", "date": "2023-12-14_19-46-13", "timestamp": 1702601173, "time_this_iter_s": 6.204207181930542, "time_total_s": 972.8062198162079, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 972.8062198162079, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 38.0, "ram_util_percent": 81.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1921972009633332}, "default_policy": {"total_loss": 0.1921972009633332, "policy_loss": -0.011656978435671405, "vf_loss": 9.047908699080379, "vf_loss_unclipped": 387.5390380501493, "vf_explained_var": -9.564702698925156e-07, "entropy": 6.609473495849414, "mean_kl_loss": 0.002690898510452143, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.0664005279541}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 628.4776539493826, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 620000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 6373.292, "sample_time_ms": 3042.999, "synch_weights_time_ms": 2.299}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 155, "trial_id": "0bf95_00000", "date": "2023-12-14_19-46-20", "timestamp": 1702601180, "time_this_iter_s": 6.3670690059661865, "time_total_s": 979.1732888221741, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 979.1732888221741, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 39.87777777777778, "ram_util_percent": 81.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3295511263114875}, "default_policy": {"total_loss": 0.3295511263114875, "policy_loss": -0.01081236017180849, "vf_loss": 9.107848597487916, "vf_loss_unclipped": 421.57011049998596, "vf_explained_var": -9.553264707390433e-07, "entropy": 6.600125646286173, "mean_kl_loss": 0.01183329828619578, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.0664005279541}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 633.189201645765, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 624000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 6384.985, "sample_time_ms": 3067.792, "synch_weights_time_ms": 2.296}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 156, "trial_id": "0bf95_00000", "date": "2023-12-14_19-46-26", "timestamp": 1702601186, "time_this_iter_s": 6.318670988082886, "time_total_s": 985.491959810257, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 985.491959810257, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 38.62222222222223, "ram_util_percent": 82.27777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.41002038715363565}, "default_policy": {"total_loss": 0.41002038715363565, "policy_loss": -0.008715541207237538, "vf_loss": 9.179832438670243, "vf_loss_unclipped": 458.91522545397663, "vf_explained_var": -9.558348259183644e-07, "entropy": 6.486285834932632, "mean_kl_loss": 0.015519386299325049, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.0664005279541}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}}, "episode_reward_max": -263284.4758655768, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -280023.9129760793, "episode_len_mean": 35039.1875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19492656778989687, "mean_inference_ms": 0.9733967040117394, "mean_action_processing_ms": 0.04851934741383439, "mean_env_wait_ms": 0.28484477892951054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270672798156738, "StateBufferConnector_ms": 0.0023618340492248535, "ViewRequirementAgentConnector_ms": 0.1675054430961609}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 658.0295952226811, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 628000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 628000, "timers": {"training_iteration_time_ms": 6360.614, "sample_time_ms": 3056.777, "synch_weights_time_ms": 2.246}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 157, "trial_id": "0bf95_00000", "date": "2023-12-14_19-46-32", "timestamp": 1702601192, "time_this_iter_s": 6.0800042152404785, "time_total_s": 991.5719640254974, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 991.5719640254974, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 29.055555555555557, "ram_util_percent": 82.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21545010091446992}, "default_policy": {"total_loss": 0.21545010091446992, "policy_loss": -0.006009163414396203, "vf_loss": 9.105613793899764, "vf_loss_unclipped": 349.9354721183208, "vf_explained_var": -9.558348259183644e-07, "entropy": 6.563476453711992, "mean_kl_loss": 0.006190100130346442, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.0664005279541}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 488.6957964488349, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 632000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 6498.377, "sample_time_ms": 3212.877, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 158, "trial_id": "0bf95_00000", "date": "2023-12-14_19-46-40", "timestamp": 1702601200, "time_this_iter_s": 8.18724012374878, "time_total_s": 999.7592041492462, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 999.7592041492462, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 28.063636363636363, "ram_util_percent": 82.43636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.2071103099137863}, "default_policy": {"total_loss": 3.2071103099137863, "policy_loss": 0.052239820092563026, "vf_loss": 9.24933484978259, "vf_loss_unclipped": 411.8695285854055, "vf_explained_var": -9.543097603804014e-07, "entropy": 6.416243779888031, "mean_kl_loss": 0.14536784057648497, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.59960174560547}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 661.9370165390984, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 636000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 6496.452, "sample_time_ms": 3201.995, "synch_weights_time_ms": 2.028}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 159, "trial_id": "0bf95_00000", "date": "2023-12-14_19-46-46", "timestamp": 1702601206, "time_this_iter_s": 6.044375896453857, "time_total_s": 1005.8035800457001, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1005.8035800457001, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 35.32222222222222, "ram_util_percent": 82.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.943707135106836}, "default_policy": {"total_loss": 0.943707135106836, "policy_loss": 0.005112593874895274, "vf_loss": 9.126849818077169, "vf_loss_unclipped": 389.4874859466227, "vf_explained_var": -9.55580648328704e-07, "entropy": 6.6154120898704285, "mean_kl_loss": 0.026814453268008156, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 47.3994026184082}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 593.7572451377528, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 640000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 6520.487, "sample_time_ms": 3190.23, "synch_weights_time_ms": 2.297}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 160, "trial_id": "0bf95_00000", "date": "2023-12-14_19-46-53", "timestamp": 1702601213, "time_this_iter_s": 6.74519681930542, "time_total_s": 1012.5487768650055, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1012.5487768650055, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 43.71, "ram_util_percent": 82.01}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.46204349530269023}, "default_policy": {"total_loss": 0.46204349530269023, "policy_loss": -0.004334909846879113, "vf_loss": 8.963529840969581, "vf_loss_unclipped": 282.9007663970817, "vf_explained_var": -9.549452043545526e-07, "entropy": 6.475814088829545, "mean_kl_loss": 0.007948267080729939, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 47.3994026184082}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 651.1649208695574, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 644000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 644000, "timers": {"training_iteration_time_ms": 6495.351, "sample_time_ms": 3191.811, "synch_weights_time_ms": 2.206}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 161, "trial_id": "0bf95_00000", "date": "2023-12-14_19-46-59", "timestamp": 1702601219, "time_this_iter_s": 6.144414901733398, "time_total_s": 1018.6931917667389, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1018.6931917667389, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 36.587500000000006, "ram_util_percent": 81.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.41449979695874745}, "default_policy": {"total_loss": 0.41449979695874745, "policy_loss": -0.00451905812387035, "vf_loss": 9.110374132961606, "vf_loss_unclipped": 680.0884123560209, "vf_explained_var": -9.579953354304788e-07, "entropy": 6.5986297008579475, "mean_kl_loss": 0.0069181276260335475, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 47.3994026184082}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 676.9929664576639, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 648000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 6441.163, "sample_time_ms": 3159.949, "synch_weights_time_ms": 2.206}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 162, "trial_id": "0bf95_00000", "date": "2023-12-14_19-47-05", "timestamp": 1702601225, "time_this_iter_s": 5.910239934921265, "time_total_s": 1024.6034317016602, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1024.6034317016602, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 32.75555555555555, "ram_util_percent": 81.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.9366281629442724}, "default_policy": {"total_loss": 0.9366281629442724, "policy_loss": -0.0018770315978270985, "vf_loss": 9.03431937587795, "vf_loss_unclipped": 1186.7490570702787, "vf_explained_var": -9.553264707390433e-07, "entropy": 6.602302804938765, "mean_kl_loss": 0.017893938838970808, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 47.3994026184082}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 676.769497301912, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 652000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 652000, "timers": {"training_iteration_time_ms": 6388.929, "sample_time_ms": 3129.151, "synch_weights_time_ms": 2.053}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 163, "trial_id": "0bf95_00000", "date": "2023-12-14_19-47-11", "timestamp": 1702601231, "time_this_iter_s": 5.912046909332275, "time_total_s": 1030.5154786109924, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1030.5154786109924, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 33.675, "ram_util_percent": 81.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.530593387385421}, "default_policy": {"total_loss": 3.530593387385421, "policy_loss": 0.012606497619426183, "vf_loss": 9.680022252902294, "vf_loss_unclipped": 7843.71175761111, "vf_explained_var": -9.585036906097998e-07, "entropy": 6.39910803471547, "mean_kl_loss": 0.07217784411296112, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 71.09910583496094}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 672.4328871360159, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 656000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 6363.536, "sample_time_ms": 3108.965, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 164, "trial_id": "0bf95_00000", "date": "2023-12-14_19-47-17", "timestamp": 1702601237, "time_this_iter_s": 5.949754238128662, "time_total_s": 1036.465232849121, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1036.465232849121, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 28.666666666666668, "ram_util_percent": 80.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7399743422707007}, "default_policy": {"total_loss": 0.7399743422707007, "policy_loss": -0.004953131429167953, "vf_loss": 9.659899625188507, "vf_loss_unclipped": 14369.19740619944, "vf_explained_var": -9.59012045789121e-07, "entropy": 6.55195030220536, "mean_kl_loss": 0.009118658540371274, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 71.09910583496094}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 654.4381624945487, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 660000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 6338.289, "sample_time_ms": 3073.359, "synch_weights_time_ms": 2.012}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 165, "trial_id": "0bf95_00000", "date": "2023-12-14_19-47-23", "timestamp": 1702601243, "time_this_iter_s": 6.113479137420654, "time_total_s": 1042.5787119865417, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1042.5787119865417, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 33.325, "ram_util_percent": 80.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.3464384519342165}, "default_policy": {"total_loss": 1.3464384519342165, "policy_loss": 0.004003959854117541, "vf_loss": 9.830978538944269, "vf_loss_unclipped": 14547.667129272591, "vf_explained_var": -9.585036906097998e-07, "entropy": 6.48416151776751, "mean_kl_loss": 0.017498457857425875, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 71.09910583496094}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 667.0458883255432, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 664000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 6306.226, "sample_time_ms": 3042.258, "synch_weights_time_ms": 2.014}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 166, "trial_id": "0bf95_00000", "date": "2023-12-14_19-47-29", "timestamp": 1702601249, "time_this_iter_s": 5.998304128646851, "time_total_s": 1048.5770161151886, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1048.5770161151886, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 30.244444444444444, "ram_util_percent": 80.99999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6808196511079889}, "default_policy": {"total_loss": 0.6808196511079889, "policy_loss": -0.0033574283777325076, "vf_loss": 9.954809733799525, "vf_loss_unclipped": 25258.138976400085, "vf_explained_var": -9.59139134583951e-07, "entropy": 6.7478613914457215, "mean_kl_loss": 0.008222733239475975, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 71.09910583496094}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 649.5956002922504, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 668000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 668000, "timers": {"training_iteration_time_ms": 6314.118, "sample_time_ms": 3050.547, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 167, "trial_id": "0bf95_00000", "date": "2023-12-14_19-47-36", "timestamp": 1702601256, "time_this_iter_s": 6.159220933914185, "time_total_s": 1054.7362370491028, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1054.7362370491028, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 25.077777777777776, "ram_util_percent": 80.91111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4375128138309984}, "default_policy": {"total_loss": 0.4375128138309984, "policy_loss": -0.0050234018570816975, "vf_loss": 10.0, "vf_loss_unclipped": 25882.524119427973, "vf_explained_var": -8.795815490202101e-07, "entropy": 6.744184073100466, "mean_kl_loss": 0.0048177288371662455, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.54955291748047}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 649.0004044740336, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 672000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 6111.945, "sample_time_ms": 2843.189, "synch_weights_time_ms": 2.032}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 168, "trial_id": "0bf95_00000", "date": "2023-12-14_19-47-42", "timestamp": 1702601262, "time_this_iter_s": 6.164761781692505, "time_total_s": 1060.9009988307953, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1060.9009988307953, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 29.266666666666666, "ram_util_percent": 81.11111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7555602386053691}, "default_policy": {"total_loss": 0.7555602386053691, "policy_loss": -0.0023088586114065, "vf_loss": 9.976904263120216, "vf_loss_unclipped": 25798.812524726396, "vf_explained_var": -9.607912889167443e-07, "entropy": 6.847609210370192, "mean_kl_loss": 0.01851218928650482, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.54955291748047}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 654.107792394934, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 676000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 676000, "timers": {"training_iteration_time_ms": 6119.178, "sample_time_ms": 2855.706, "synch_weights_time_ms": 2.016}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 169, "trial_id": "0bf95_00000", "date": "2023-12-14_19-47-48", "timestamp": 1702601268, "time_this_iter_s": 6.11700701713562, "time_total_s": 1067.018005847931, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1067.018005847931, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 24.325000000000003, "ram_util_percent": 80.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5184277545239753}, "default_policy": {"total_loss": 0.5184277545239753, "policy_loss": -0.0039993649262235935, "vf_loss": 9.823140530698081, "vf_loss_unclipped": 15837.111404321342, "vf_explained_var": -9.606642001219142e-07, "entropy": 6.572716356086325, "mean_kl_loss": 0.01193251889827016, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.54955291748047}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 640.1542852315557, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 680000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 6070.358, "sample_time_ms": 2848.924, "synch_weights_time_ms": 1.676}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 170, "trial_id": "0bf95_00000", "date": "2023-12-14_19-47-54", "timestamp": 1702601274, "time_this_iter_s": 6.25002384185791, "time_total_s": 1073.2680296897888, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1073.2680296897888, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 32.43333333333334, "ram_util_percent": 81.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6209689691932853}, "default_policy": {"total_loss": 0.6209689691932853, "policy_loss": -0.007066515833834436, "vf_loss": 9.473067054362184, "vf_loss_unclipped": 5633.422762425469, "vf_explained_var": -9.569786250718366e-07, "entropy": 6.470454535758826, "mean_kl_loss": 0.015001730785288388, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.54955291748047}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 651.5952809993231, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 684000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 6069.952, "sample_time_ms": 2835.026, "synch_weights_time_ms": 1.66}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 171, "trial_id": "0bf95_00000", "date": "2023-12-14_19-48-00", "timestamp": 1702601280, "time_this_iter_s": 6.1405229568481445, "time_total_s": 1079.408552646637, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1079.408552646637, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 33.766666666666666, "ram_util_percent": 80.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.26779335287651784}, "default_policy": {"total_loss": 0.26779335287651784, "policy_loss": -0.01099915548499777, "vf_loss": 9.180406048862157, "vf_loss_unclipped": 854.2660720597452, "vf_explained_var": -9.560890035080248e-07, "entropy": 6.453351398520886, "mean_kl_loss": 0.005259938226930345, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.54955291748047}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 587.7965725212757, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 688000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 6159.605, "sample_time_ms": 2904.662, "synch_weights_time_ms": 1.752}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 172, "trial_id": "0bf95_00000", "date": "2023-12-14_19-48-07", "timestamp": 1702601287, "time_this_iter_s": 6.807387828826904, "time_total_s": 1086.2159404754639, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1086.2159404754639, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 42.86, "ram_util_percent": 80.77}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.23195988323086741}, "default_policy": {"total_loss": 0.23195988323086741, "policy_loss": -0.01167290941970959, "vf_loss": 9.079961182466194, "vf_loss_unclipped": 494.31932827557074, "vf_explained_var": -9.549452043545526e-07, "entropy": 6.455621111875912, "mean_kl_loss": 0.004299159023379197, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.774776458740234}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 647.9886231703257, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 692000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 692000, "timers": {"training_iteration_time_ms": 6185.857, "sample_time_ms": 2917.017, "synch_weights_time_ms": 1.754}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 173, "trial_id": "0bf95_00000", "date": "2023-12-14_19-48-13", "timestamp": 1702601293, "time_this_iter_s": 6.1750102043151855, "time_total_s": 1092.390950679779, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1092.390950679779, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 37.9375, "ram_util_percent": 80.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24246598475539227}, "default_policy": {"total_loss": 0.24246598475539227, "policy_loss": -0.007780335007557101, "vf_loss": 9.080570959078987, "vf_loss_unclipped": 288.222507826555, "vf_explained_var": -9.545639379700618e-07, "entropy": 6.5151009122445895, "mean_kl_loss": 0.00897004879470551, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.774776458740234}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 623.4154380378105, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 696000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 6232.628, "sample_time_ms": 2960.701, "synch_weights_time_ms": 1.766}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 174, "trial_id": "0bf95_00000", "date": "2023-12-14_19-48-20", "timestamp": 1702601300, "time_this_iter_s": 6.417899131774902, "time_total_s": 1098.808849811554, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1098.808849811554, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 40.989999999999995, "ram_util_percent": 81.46000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6771641224066713}, "default_policy": {"total_loss": 0.6771641224066713, "policy_loss": 0.0019136302280865277, "vf_loss": 9.178927513582112, "vf_loss_unclipped": 413.3367362601925, "vf_explained_var": -9.560890035080248e-07, "entropy": 6.404938613936337, "mean_kl_loss": 0.032825235330564494, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 26.66216468811035}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}}, "episode_reward_max": -253915.6198831099, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -277201.84653321217, "episode_len_mean": 35039.166666666664, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19503986772890874, "mean_inference_ms": 0.9737060613653034, "mean_action_processing_ms": 0.04853878830232975, "mean_env_wait_ms": 0.2820337038900989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042928589714898, "StateBufferConnector_ms": 0.0024172994825575086, "ViewRequirementAgentConnector_ms": 0.17260313034057617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 609.5262896926315, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 700000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 6277.655, "sample_time_ms": 2993.174, "synch_weights_time_ms": 1.916}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 175, "trial_id": "0bf95_00000", "date": "2023-12-14_19-48-26", "timestamp": 1702601306, "time_this_iter_s": 6.565148830413818, "time_total_s": 1105.3739986419678, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1105.3739986419678, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 37.544444444444444, "ram_util_percent": 82.44444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.161971911384877}, "default_policy": {"total_loss": 1.161971911384877, "policy_loss": 0.004630584942439058, "vf_loss": 9.08538222770447, "vf_loss_unclipped": 335.3970727981535, "vf_explained_var": -9.59139134583951e-07, "entropy": 6.463348018080949, "mean_kl_loss": 0.04000003439565894, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 39.993247985839844}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 459.5909257861569, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 704000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 6548.333, "sample_time_ms": 3260.305, "synch_weights_time_ms": 1.943}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 176, "trial_id": "0bf95_00000", "date": "2023-12-14_19-48-35", "timestamp": 1702601315, "time_this_iter_s": 8.705854892730713, "time_total_s": 1114.0798535346985, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1114.0798535346985, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 38.24999999999999, "ram_util_percent": 82.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.9932834663942679}, "default_policy": {"total_loss": 0.9932834663942679, "policy_loss": -0.0008509840611725855, "vf_loss": 9.137294299058569, "vf_loss_unclipped": 339.96237351797794, "vf_explained_var": -9.563431810976854e-07, "entropy": 6.410026784136352, "mean_kl_loss": 0.022572848091404245, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 59.989871978759766}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 651.082363439299, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 708000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 6546.928, "sample_time_ms": 3259.594, "synch_weights_time_ms": 1.92}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 177, "trial_id": "0bf95_00000", "date": "2023-12-14_19-48-41", "timestamp": 1702601321, "time_this_iter_s": 6.145388126373291, "time_total_s": 1120.2252416610718, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1120.2252416610718, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 35.977777777777774, "ram_util_percent": 83.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.29250472505241315}, "default_policy": {"total_loss": 0.29250472505241315, "policy_loss": -0.0049059494437753105, "vf_loss": 9.090101179029388, "vf_loss_unclipped": 314.32371501475257, "vf_explained_var": -9.553264707390433e-07, "entropy": 6.481648356167238, "mean_kl_loss": 0.0034424087852361236, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 29.994935989379883}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 603.2819452951104, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 712000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 6593.629, "sample_time_ms": 3303.876, "synch_weights_time_ms": 2.07}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 178, "trial_id": "0bf95_00000", "date": "2023-12-14_19-48-48", "timestamp": 1702601328, "time_this_iter_s": 6.632383823394775, "time_total_s": 1126.8576254844666, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1126.8576254844666, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 42.989999999999995, "ram_util_percent": 82.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20415091113860545}, "default_policy": {"total_loss": 0.20415091113860545, "policy_loss": -0.012661202706452181, "vf_loss": 9.140132966580422, "vf_loss_unclipped": 372.1162592597099, "vf_explained_var": -9.549452043545526e-07, "entropy": 6.4610567316571785, "mean_kl_loss": 0.004181065240705771, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.997467994689941}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 645.6727398454577, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 716000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 716000, "timers": {"training_iteration_time_ms": 6601.618, "sample_time_ms": 3294.314, "synch_weights_time_ms": 2.046}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 179, "trial_id": "0bf95_00000", "date": "2023-12-14_19-48-54", "timestamp": 1702601334, "time_this_iter_s": 6.199238061904907, "time_total_s": 1133.0568635463715, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1133.0568635463715, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 35.15, "ram_util_percent": 82.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.28172351918352057}, "default_policy": {"total_loss": 0.28172351918352057, "policy_loss": -0.011885643623439647, "vf_loss": 8.960441164878894, "vf_loss_unclipped": 794.6100206842809, "vf_explained_var": -9.548181155597222e-07, "entropy": 6.424771374476744, "mean_kl_loss": 0.013602613429937455, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.997467994689941}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 668.4646222333005, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 720000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 6575.154, "sample_time_ms": 3272.827, "synch_weights_time_ms": 2.079}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 180, "trial_id": "0bf95_00000", "date": "2023-12-14_19-49-00", "timestamp": 1702601340, "time_this_iter_s": 5.985255002975464, "time_total_s": 1139.042118549347, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1139.042118549347, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 33.43333333333334, "ram_util_percent": 82.35555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4023341496965524}, "default_policy": {"total_loss": 0.4023341496965524, "policy_loss": -0.014639478542708926, "vf_loss": 9.543925771326906, "vf_loss_unclipped": 4906.286711955121, "vf_explained_var": -9.597745785581024e-07, "entropy": 6.352842550033699, "mean_kl_loss": 0.021439243809586155, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.49620246887207}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 658.6403893328404, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 724000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 724000, "timers": {"training_iteration_time_ms": 6568.587, "sample_time_ms": 3276.007, "synch_weights_time_ms": 2.098}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 181, "trial_id": "0bf95_00000", "date": "2023-12-14_19-49-06", "timestamp": 1702601346, "time_this_iter_s": 6.074380159378052, "time_total_s": 1145.116498708725, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1145.116498708725, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 34.211111111111116, "ram_util_percent": 81.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.9819529454337}, "default_policy": {"total_loss": 1.9819529454337, "policy_loss": 0.005126954349718972, "vf_loss": 9.291825032691712, "vf_loss_unclipped": 5704.151107657947, "vf_explained_var": -9.595204009684418e-07, "entropy": 6.416592330566601, "mean_kl_loss": 0.08374336738896417, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 33.74430465698242}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 645.4904013346555, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 728000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 6507.769, "sample_time_ms": 3223.985, "synch_weights_time_ms": 2.027}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 182, "trial_id": "0bf95_00000", "date": "2023-12-14_19-49-12", "timestamp": 1702601352, "time_this_iter_s": 6.198296070098877, "time_total_s": 1151.3147947788239, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1151.3147947788239, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 45.1375, "ram_util_percent": 81.5125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2512602148605372}, "default_policy": {"total_loss": 0.2512602148605372, "policy_loss": -0.010742701292693266, "vf_loss": 9.966863145197888, "vf_loss_unclipped": 20945.180171486667, "vf_explained_var": -9.604100225322536e-07, "entropy": 6.553091815793946, "mean_kl_loss": 0.004810716422032198, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.87215232849121}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 640.3041483785862, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 732000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 6515.178, "sample_time_ms": 3233.658, "synch_weights_time_ms": 2.025}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 183, "trial_id": "0bf95_00000", "date": "2023-12-14_19-49-19", "timestamp": 1702601359, "time_this_iter_s": 6.248589038848877, "time_total_s": 1157.5633838176727, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1157.5633838176727, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 31.56666666666667, "ram_util_percent": 81.75555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.43779504575581946}, "default_policy": {"total_loss": 0.43779504575581946, "policy_loss": -0.009629660838795925, "vf_loss": 9.766959443529531, "vf_loss_unclipped": 12327.63349919431, "vf_explained_var": -9.605371113270839e-07, "entropy": 6.4229376702420495, "mean_kl_loss": 0.020729726909461135, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.3082275390625}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 626.9011606284535, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 736000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 6511.608, "sample_time_ms": 3206.035, "synch_weights_time_ms": 2.07}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 184, "trial_id": "0bf95_00000", "date": "2023-12-14_19-49-25", "timestamp": 1702601365, "time_this_iter_s": 6.385628938674927, "time_total_s": 1163.9490127563477, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1163.9490127563477, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 33.22222222222222, "ram_util_percent": 81.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.45963849284565}, "default_policy": {"total_loss": 1.45963849284565, "policy_loss": 0.01857688417062481, "vf_loss": 9.97269423938255, "vf_loss_unclipped": 25125.436735303672, "vf_explained_var": -9.648581303513127e-07, "entropy": 6.797513998901921, "mean_kl_loss": 0.05299994493971816, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.96234130859375}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 605.5084863211774, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 740000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 740000, "timers": {"training_iteration_time_ms": 6515.961, "sample_time_ms": 3210.876, "synch_weights_time_ms": 2.029}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 185, "trial_id": "0bf95_00000", "date": "2023-12-14_19-49-32", "timestamp": 1702601372, "time_this_iter_s": 6.607614994049072, "time_total_s": 1170.5566277503967, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1170.5566277503967, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 39.08, "ram_util_percent": 82.43}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.461523506226443}, "default_policy": {"total_loss": 0.461523506226443, "policy_loss": -0.006484850092844637, "vf_loss": 9.870320597691322, "vf_loss_unclipped": 16240.070748270193, "vf_explained_var": -9.604100225322536e-07, "entropy": 6.563260657446725, "mean_kl_loss": 0.00972819729155969, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.96234130859375}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 332.45280809226915, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 744000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 6848.796, "sample_time_ms": 3518.285, "synch_weights_time_ms": 2.121}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 186, "trial_id": "0bf95_00000", "date": "2023-12-14_19-49-44", "timestamp": 1702601384, "time_this_iter_s": 12.036350965499878, "time_total_s": 1182.5929787158966, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1182.5929787158966, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 77.04705882352941, "ram_util_percent": 82.69411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4594708357824446}, "default_policy": {"total_loss": 0.4594708357824446, "policy_loss": -0.0020897424807633036, "vf_loss": 9.819804585056264, "vf_loss_unclipped": 15491.424193034549, "vf_explained_var": -9.633330648133494e-07, "entropy": 6.633130664764437, "mean_kl_loss": 0.009571657389314767, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.96234130859375}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 547.1286194218474, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 748000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 748000, "timers": {"training_iteration_time_ms": 6965.517, "sample_time_ms": 3564.446, "synch_weights_time_ms": 2.267}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 187, "trial_id": "0bf95_00000", "date": "2023-12-14_19-49-51", "timestamp": 1702601391, "time_this_iter_s": 7.315629959106445, "time_total_s": 1189.908608675003, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1189.908608675003, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 63.9, "ram_util_percent": 81.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.42727912541455043}, "default_policy": {"total_loss": 0.42727912541455043, "policy_loss": -0.006605475213624902, "vf_loss": 9.701834069640398, "vf_loss_unclipped": 12802.793412426134, "vf_explained_var": -9.582495130201392e-07, "entropy": 6.380877063726819, "mean_kl_loss": 0.008873695439353997, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.96234130859375}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 635.3008953738369, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 752000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 6932.107, "sample_time_ms": 3525.539, "synch_weights_time_ms": 2.135}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 188, "trial_id": "0bf95_00000", "date": "2023-12-14_19-49-57", "timestamp": 1702601397, "time_this_iter_s": 6.2977190017700195, "time_total_s": 1196.206327676773, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1196.206327676773, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 37.26666666666667, "ram_util_percent": 81.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6203691660166423}, "default_policy": {"total_loss": 0.6203691660166423, "policy_loss": -0.006614833949074181, "vf_loss": 9.349462785192136, "vf_loss_unclipped": 4596.467221542716, "vf_explained_var": -9.530388724320987e-07, "entropy": 6.2465211465668835, "mean_kl_loss": 0.014053121123630758, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.96234130859375}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 663.4707222448425, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 756000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 6915.488, "sample_time_ms": 3519.815, "synch_weights_time_ms": 2.139}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 189, "trial_id": "0bf95_00000", "date": "2023-12-14_19-50-03", "timestamp": 1702601403, "time_this_iter_s": 6.030282974243164, "time_total_s": 1202.2366106510162, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1202.2366106510162, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 31.688888888888886, "ram_util_percent": 81.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.33061995380707004}, "default_policy": {"total_loss": 0.33061995380707004, "policy_loss": -0.007934929658549585, "vf_loss": 9.073540604699142, "vf_loss_unclipped": 385.2740120226895, "vf_explained_var": -9.54182671585571e-07, "entropy": 6.172579771928442, "mean_kl_loss": 0.006528034639928409, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.96234130859375}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 641.7233045758142, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 760000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 6940.424, "sample_time_ms": 3530.814, "synch_weights_time_ms": 2.13}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 190, "trial_id": "0bf95_00000", "date": "2023-12-14_19-50-10", "timestamp": 1702601410, "time_this_iter_s": 6.234803915023804, "time_total_s": 1208.47141456604, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1208.47141456604, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 37.63333333333333, "ram_util_percent": 81.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3917439278207227}, "default_policy": {"total_loss": 0.3917439278207227, "policy_loss": -0.01079346292090219, "vf_loss": 9.029277051181428, "vf_loss_unclipped": 437.7200155197176, "vf_explained_var": -9.540555827907407e-07, "entropy": 6.229715880554622, "mean_kl_loss": 0.008225115018854546, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 37.96234130859375}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 633.9601549250649, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 764000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 764000, "timers": {"training_iteration_time_ms": 6964.058, "sample_time_ms": 3532.242, "synch_weights_time_ms": 2.309}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 191, "trial_id": "0bf95_00000", "date": "2023-12-14_19-50-16", "timestamp": 1702601416, "time_this_iter_s": 6.313211917877197, "time_total_s": 1214.7846264839172, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1214.7846264839172, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 44.13333333333333, "ram_util_percent": 81.68888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.0247865899571225}, "default_policy": {"total_loss": 1.0247865899571225, "policy_loss": 0.0042864005803676655, "vf_loss": 9.139848096538454, "vf_loss_unclipped": 353.11682627094325, "vf_explained_var": -9.553264707390433e-07, "entropy": 6.241078190712024, "mean_kl_loss": 0.024474299498581306, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 56.943511962890625}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}}, "episode_reward_max": -251950.51196314674, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -274718.17695518764, "episode_len_mean": 35039.15, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19518729078794078, "mean_inference_ms": 0.97430882752149, "mean_action_processing_ms": 0.04856861547704987, "mean_env_wait_ms": 0.2797438446573503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004520416259765625, "StateBufferConnector_ms": 0.002351999282836914, "ViewRequirementAgentConnector_ms": 0.1690661907196045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 624.0430573379091, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 768000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 6985.357, "sample_time_ms": 3545.557, "synch_weights_time_ms": 2.284}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 192, "trial_id": "0bf95_00000", "date": "2023-12-14_19-50-22", "timestamp": 1702601422, "time_this_iter_s": 6.411879062652588, "time_total_s": 1221.1965055465698, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1221.1965055465698, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 41.0, "ram_util_percent": 81.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.45636176915247556}, "default_policy": {"total_loss": 0.45636176915247556, "policy_loss": 0.00019475539375755834, "vf_loss": 9.050894280740701, "vf_loss_unclipped": 281.05861756542345, "vf_explained_var": -9.565973586873459e-07, "entropy": 6.234932400778667, "mean_kl_loss": 0.006421417632558439, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 56.943511962890625}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 470.65518021355973, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 772000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 772000, "timers": {"training_iteration_time_ms": 7210.531, "sample_time_ms": 3774.632, "synch_weights_time_ms": 2.341}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 193, "trial_id": "0bf95_00000", "date": "2023-12-14_19-50-31", "timestamp": 1702601431, "time_this_iter_s": 8.500686883926392, "time_total_s": 1229.6971924304962, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1229.6971924304962, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 35.98333333333333, "ram_util_percent": 81.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 6.200692928858848}, "default_policy": {"total_loss": 6.200692928858848, "policy_loss": 0.03401635068434992, "vf_loss": 8.944423197174885, "vf_loss_unclipped": 278.8057196643561, "vf_explained_var": -9.550722931493829e-07, "entropy": 6.146925950609544, "mean_kl_loss": 0.10672387677217662, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 85.41526794433594}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 653.9463264199061, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 776000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 7184.145, "sample_time_ms": 3767.69, "synch_weights_time_ms": 2.264}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 194, "trial_id": "0bf95_00000", "date": "2023-12-14_19-50-37", "timestamp": 1702601437, "time_this_iter_s": 6.118261098861694, "time_total_s": 1235.815453529358, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1235.815453529358, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 31.599999999999998, "ram_util_percent": 82.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 2.921492369057162}, "default_policy": {"total_loss": 2.921492369057162, "policy_loss": 0.010211012792835103, "vf_loss": 9.05033639753297, "vf_loss_unclipped": 256.5505147214129, "vf_explained_var": -9.540555827907407e-07, "entropy": 6.081460223269107, "mean_kl_loss": 0.033024283263882966, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 128.12289428710938}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 674.8382844501876, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 780000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 7116.288, "sample_time_ms": 3719.906, "synch_weights_time_ms": 2.139}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 195, "trial_id": "0bf95_00000", "date": "2023-12-14_19-50-43", "timestamp": 1702601443, "time_this_iter_s": 5.928741693496704, "time_total_s": 1241.7441952228546, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1241.7441952228546, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 32.175, "ram_util_percent": 82.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.8775137341273492}, "default_policy": {"total_loss": 0.8775137341273492, "policy_loss": -0.00027044062842247583, "vf_loss": 8.88433067020831, "vf_loss_unclipped": 232.72504190392078, "vf_explained_var": -9.54182671585571e-07, "entropy": 6.14175874439638, "mean_kl_loss": 0.0061576884627182246, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 128.12289428710938}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 661.7116564586557, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 784000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 6517.61, "sample_time_ms": 3143.501, "synch_weights_time_ms": 2.005}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 196, "trial_id": "0bf95_00000", "date": "2023-12-14_19-50-49", "timestamp": 1702601449, "time_this_iter_s": 6.046310901641846, "time_total_s": 1247.7905061244965, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1247.7905061244965, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 30.77777777777778, "ram_util_percent": 82.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.2024373475835521}, "default_policy": {"total_loss": 1.2024373475835521, "policy_loss": 0.0007003679651139515, "vf_loss": 9.141553434481754, "vf_loss_unclipped": 635.0425138656518, "vf_explained_var": -9.54182671585571e-07, "entropy": 6.073247782457104, "mean_kl_loss": 0.008666065905542822, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 128.12289428710938}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 670.3512268364309, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 788000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 788000, "timers": {"training_iteration_time_ms": 6383.229, "sample_time_ms": 3073.211, "synch_weights_time_ms": 1.83}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 197, "trial_id": "0bf95_00000", "date": "2023-12-14_19-50-55", "timestamp": 1702601455, "time_this_iter_s": 5.9685890674591064, "time_total_s": 1253.7590951919556, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1253.7590951919556, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 30.088888888888885, "ram_util_percent": 81.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.5466970395106179}, "default_policy": {"total_loss": 1.5466970395106179, "policy_loss": -0.00047739739341141066, "vf_loss": 8.925658269223375, "vf_loss_unclipped": 1369.6533901361006, "vf_explained_var": -9.539284939959104e-07, "entropy": 6.021873482763132, "mean_kl_loss": 0.011379058106474885, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 128.12289428710938}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 669.9425558708207, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 792000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 6350.672, "sample_time_ms": 3047.214, "synch_weights_time_ms": 1.796}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 198, "trial_id": "0bf95_00000", "date": "2023-12-14_19-51-01", "timestamp": 1702601461, "time_this_iter_s": 5.972028970718384, "time_total_s": 1259.731124162674, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1259.731124162674, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 32.4875, "ram_util_percent": 81.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.2716502377044545}, "default_policy": {"total_loss": 3.2716502377044545, "policy_loss": 0.004821934664288341, "vf_loss": 9.580537243946782, "vf_loss_unclipped": 6475.901842951012, "vf_explained_var": -9.59647489763272e-07, "entropy": 5.8121805058867695, "mean_kl_loss": 0.024749854005349025, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 192.18434143066406}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 674.5913069512569, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 796000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 796000, "timers": {"training_iteration_time_ms": 6340.734, "sample_time_ms": 3043.459, "synch_weights_time_ms": 1.771}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 199, "trial_id": "0bf95_00000", "date": "2023-12-14_19-51-07", "timestamp": 1702601467, "time_this_iter_s": 5.930991172790527, "time_total_s": 1265.6621153354645, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1265.6621153354645, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 27.67777777777778, "ram_util_percent": 81.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 5.351904425349063}, "default_policy": {"total_loss": 5.351904425349063, "policy_loss": 0.00496559354490531, "vf_loss": 9.665458837806035, "vf_loss_unclipped": 14380.746753237141, "vf_explained_var": -9.574869802511577e-07, "entropy": 6.023035629980091, "mean_kl_loss": 0.027319001159223363, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 288.2765197753906}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 672.6583555384846, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 800000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 6312.068, "sample_time_ms": 3030.768, "synch_weights_time_ms": 1.751}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 200, "trial_id": "0bf95_00000", "date": "2023-12-14_19-51-13", "timestamp": 1702601473, "time_this_iter_s": 5.948107957839966, "time_total_s": 1271.6102232933044, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1271.6102232933044, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 26.262499999999996, "ram_util_percent": 81.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.6938321465876567}, "default_policy": {"total_loss": 3.6938321465876567, "policy_loss": 0.004573847483302445, "vf_loss": 9.834370595814068, "vf_loss_unclipped": 13800.94975723234, "vf_explained_var": -9.602829337374235e-07, "entropy": 5.885614294487276, "mean_kl_loss": 0.012456493480197584, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 288.2765197753906}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 804000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 659.7110002060465, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 804000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 6287.449, "sample_time_ms": 3029.784, "synch_weights_time_ms": 1.57}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 201, "trial_id": "0bf95_00000", "date": "2023-12-14_19-51-19", "timestamp": 1702601479, "time_this_iter_s": 6.064767122268677, "time_total_s": 1277.6749904155731, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1277.6749904155731, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 30.811111111111114, "ram_util_percent": 81.74444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.9614896388895222}, "default_policy": {"total_loss": 0.9614896388895222, "policy_loss": -0.0006495452260594569, "vf_loss": 9.989717902405175, "vf_loss_unclipped": 26656.55212116038, "vf_explained_var": -9.540555827907407e-07, "entropy": 6.315752926157482, "mean_kl_loss": 0.002991024053229929, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 144.1382598876953}}, "num_env_steps_sampled": 808000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 808000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 659.7718375787468, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 808000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 6252.738, "sample_time_ms": 3015.122, "synch_weights_time_ms": 1.75}, "counters": {"num_env_steps_sampled": 808000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 202, "trial_id": "0bf95_00000", "date": "2023-12-14_19-51-25", "timestamp": 1702601485, "time_this_iter_s": 6.0677809715271, "time_total_s": 1283.7427713871002, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1283.7427713871002, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 29.775, "ram_util_percent": 81.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.6888377310942486}, "default_policy": {"total_loss": 1.6888377310942486, "policy_loss": 0.003271954940326178, "vf_loss": 9.976061024899677, "vf_loss_unclipped": 23467.069679243985, "vf_explained_var": -9.637143311978404e-07, "entropy": 6.161607345792531, "mean_kl_loss": 0.011001972448856886, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 144.1382598876953}}, "num_env_steps_sampled": 812000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 812000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 654.2329814655222, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 812000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 812000, "timers": {"training_iteration_time_ms": 6014.264, "sample_time_ms": 2782.687, "synch_weights_time_ms": 1.685}, "counters": {"num_env_steps_sampled": 812000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 203, "trial_id": "0bf95_00000", "date": "2023-12-14_19-51-31", "timestamp": 1702601491, "time_this_iter_s": 6.115738153457642, "time_total_s": 1289.8585095405579, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1289.8585095405579, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 32.74444444444444, "ram_util_percent": 81.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 2.8620182898824913}, "default_policy": {"total_loss": 2.8620182898824913, "policy_loss": 0.005048105939239788, "vf_loss": 9.915919760396994, "vf_loss_unclipped": 23447.910306104972, "vf_explained_var": -9.61553821685726e-07, "entropy": 6.280251505024143, "mean_kl_loss": 0.019133094832206383, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 144.1382598876953}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 816000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 618.4436263103329, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 816000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 6049.378, "sample_time_ms": 2823.66, "synch_weights_time_ms": 1.734}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 204, "trial_id": "0bf95_00000", "date": "2023-12-14_19-51-38", "timestamp": 1702601498, "time_this_iter_s": 6.46912407875061, "time_total_s": 1296.3276336193085, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1296.3276336193085, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 38.63333333333334, "ram_util_percent": 81.78888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.4318593858655837}, "default_policy": {"total_loss": 1.4318593858655837, "policy_loss": 0.003983534466939917, "vf_loss": 9.823999028724394, "vf_loss_unclipped": 17410.502134603732, "vf_explained_var": -9.62570532044368e-07, "entropy": 6.048527612869165, "mean_kl_loss": 0.009224725320981108, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 144.1382598876953}}, "num_env_steps_sampled": 820000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 820000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 667.288671241203, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 820000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 820000, "timers": {"training_iteration_time_ms": 6056.084, "sample_time_ms": 2835.135, "synch_weights_time_ms": 1.738}, "counters": {"num_env_steps_sampled": 820000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 205, "trial_id": "0bf95_00000", "date": "2023-12-14_19-51-44", "timestamp": 1702601504, "time_this_iter_s": 5.996079921722412, "time_total_s": 1302.3237135410309, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1302.3237135410309, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 26.444444444444443, "ram_util_percent": 82.11111111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.673365298126425}, "default_policy": {"total_loss": 1.673365298126425, "policy_loss": 0.0004708596931170744, "vf_loss": 9.597774394793806, "vf_loss_unclipped": 6255.980594903422, "vf_explained_var": -9.585036906097998e-07, "entropy": 5.891612048342284, "mean_kl_loss": 0.010940306234741714, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 144.1382598876953}}, "num_env_steps_sampled": 824000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 824000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 679.4361105215343, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 824000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 6040.315, "sample_time_ms": 2829.592, "synch_weights_time_ms": 1.761}, "counters": {"num_env_steps_sampled": 824000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 206, "trial_id": "0bf95_00000", "date": "2023-12-14_19-51-50", "timestamp": 1702601510, "time_this_iter_s": 5.888473987579346, "time_total_s": 1308.2121875286102, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1308.2121875286102, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 32.4, "ram_util_percent": 82.11250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6526711674641444}, "default_policy": {"total_loss": 0.6526711674641444, "policy_loss": -0.002218820624299713, "vf_loss": 9.153594355085003, "vf_loss_unclipped": 1174.2583749116357, "vf_explained_var": -9.559619147131947e-07, "entropy": 5.844701929641431, "mean_kl_loss": 0.003908428263042615, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 72.06912994384766}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 828000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 660.5763859326012, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 828000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 6049.143, "sample_time_ms": 2835.883, "synch_weights_time_ms": 1.796}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 207, "trial_id": "0bf95_00000", "date": "2023-12-14_19-51-56", "timestamp": 1702601516, "time_this_iter_s": 6.056823968887329, "time_total_s": 1314.2690114974976, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1314.2690114974976, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 32.111111111111114, "ram_util_percent": 81.77777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.15925024532433005}, "default_policy": {"total_loss": 0.15925024532433005, "policy_loss": -0.007227694166939396, "vf_loss": 8.876670859769971, "vf_loss_unclipped": 460.4737371961191, "vf_explained_var": -9.5367431640625e-07, "entropy": 5.896452169174324, "mean_kl_loss": 0.0010782873722235459, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.03456497192383}}, "num_env_steps_sampled": 832000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 832000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 667.0981389843722, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 832000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 6051.689, "sample_time_ms": 2838.957, "synch_weights_time_ms": 1.797}, "counters": {"num_env_steps_sampled": 832000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 208, "trial_id": "0bf95_00000", "date": "2023-12-14_19-52-02", "timestamp": 1702601522, "time_this_iter_s": 5.997699975967407, "time_total_s": 1320.266711473465, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1320.266711473465, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 33.925, "ram_util_percent": 81.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19788705271237822}, "default_policy": {"total_loss": 0.19788705271237822, "policy_loss": -0.004836116099793678, "vf_loss": 9.00605984435661, "vf_loss_unclipped": 256.7536821995717, "vf_explained_var": -9.55580648328704e-07, "entropy": 5.976937476505857, "mean_kl_loss": 0.0031265139789590857, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.017282485961914}}, "num_env_steps_sampled": 836000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 836000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 653.8042523501499, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 836000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 836000, "timers": {"training_iteration_time_ms": 6070.541, "sample_time_ms": 2846.675, "synch_weights_time_ms": 1.795}, "counters": {"num_env_steps_sampled": 836000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 209, "trial_id": "0bf95_00000", "date": "2023-12-14_19-52-08", "timestamp": 1702601528, "time_this_iter_s": 6.119531869888306, "time_total_s": 1326.3862433433533, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1326.3862433433533, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 34.1, "ram_util_percent": 81.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5626892556132538}, "default_policy": {"total_loss": 0.5626892556132538, "policy_loss": -0.003722919056863228, "vf_loss": 9.076197220064175, "vf_loss_unclipped": 304.8531245900624, "vf_explained_var": -9.549452043545526e-07, "entropy": 5.875772724781972, "mean_kl_loss": 0.02639966392221208, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 27.025924682617188}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}}, "episode_reward_max": -246080.92208908455, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -272142.11712169315, "episode_len_mean": 35039.13636363636, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548206959356992, "mean_inference_ms": 0.9758994466647084, "mean_action_processing_ms": 0.04863004819715404, "mean_env_wait_ms": 0.27827918967515286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004435669292103161, "StateBufferConnector_ms": 0.0023408369584517045, "ViewRequirementAgentConnector_ms": 0.16696669838645242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 840000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 651.3588754453406, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 840000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 6089.986, "sample_time_ms": 2846.419, "synch_weights_time_ms": 1.79}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 210, "trial_id": "0bf95_00000", "date": "2023-12-14_19-52-14", "timestamp": 1702601534, "time_this_iter_s": 6.1424829959869385, "time_total_s": 1332.5287263393402, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1332.5287263393402, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 36.57777777777778, "ram_util_percent": 81.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7115265156176172}, "default_policy": {"total_loss": 0.7115265156176172, "policy_loss": 0.0003022161547714141, "vf_loss": 8.724971955773164, "vf_loss_unclipped": 232.45156973816438, "vf_explained_var": -9.587578681994603e-07, "entropy": 5.82938727691992, "mean_kl_loss": 0.023088001106175777, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 40.53888702392578}}, "num_env_steps_sampled": 844000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 844000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 458.05361853058446, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 844000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 844000, "timers": {"training_iteration_time_ms": 6356.914, "sample_time_ms": 3109.322, "synch_weights_time_ms": 1.889}, "counters": {"num_env_steps_sampled": 844000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 211, "trial_id": "0bf95_00000", "date": "2023-12-14_19-52-23", "timestamp": 1702601543, "time_this_iter_s": 8.73512315750122, "time_total_s": 1341.2638494968414, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1341.2638494968414, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 34.358333333333334, "ram_util_percent": 81.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.1243864198102118}, "default_policy": {"total_loss": 1.1243864198102118, "policy_loss": 0.00023045755033172777, "vf_loss": 9.039218037875731, "vf_loss_unclipped": 319.73760802506894, "vf_explained_var": -9.54182671585571e-07, "entropy": 5.746201237635826, "mean_kl_loss": 0.025500546729613244, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 60.80833053588867}}, "num_env_steps_sampled": 848000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 848000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 634.4616990610338, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 848000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 6381.099, "sample_time_ms": 3114.94, "synch_weights_time_ms": 1.698}, "counters": {"num_env_steps_sampled": 848000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 212, "trial_id": "0bf95_00000", "date": "2023-12-14_19-52-29", "timestamp": 1702601549, "time_this_iter_s": 6.305944204330444, "time_total_s": 1347.5697937011719, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1347.5697937011719, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 36.855555555555554, "ram_util_percent": 81.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.30730296936688395}, "default_policy": {"total_loss": 0.30730296936688395, "policy_loss": -0.0030535310099739383, "vf_loss": 8.785609496427751, "vf_loss_unclipped": 223.611306709013, "vf_explained_var": -9.554535595338736e-07, "entropy": 5.792910302879968, "mean_kl_loss": 0.003659044824329659, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 30.404165267944336}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 852000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 663.7361427033719, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 852000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 6372.345, "sample_time_ms": 3095.957, "synch_weights_time_ms": 1.699}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 213, "trial_id": "0bf95_00000", "date": "2023-12-14_19-52-35", "timestamp": 1702601555, "time_this_iter_s": 6.027701139450073, "time_total_s": 1353.597494840622, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1353.597494840622, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 33.73333333333333, "ram_util_percent": 81.52222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21005339873458212}, "default_policy": {"total_loss": 0.21005339873458212, "policy_loss": -0.012682523997897691, "vf_loss": 9.052197233700294, "vf_loss_unclipped": 420.45228301741673, "vf_explained_var": -9.54182671585571e-07, "entropy": 5.792206600022468, "mean_kl_loss": 0.004348547221622184, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.202082633972168}}, "num_env_steps_sampled": 856000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 856000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 671.4217726267065, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 856000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 6321.311, "sample_time_ms": 3042.27, "synch_weights_time_ms": 1.641}, "counters": {"num_env_steps_sampled": 856000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 214, "trial_id": "0bf95_00000", "date": "2023-12-14_19-52-41", "timestamp": 1702601561, "time_this_iter_s": 5.958964824676514, "time_total_s": 1359.5564596652985, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1359.5564596652985, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 33.075, "ram_util_percent": 80.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20216700767498536}, "default_policy": {"total_loss": 0.20216700767498536, "policy_loss": -0.008824280575354662, "vf_loss": 8.90862676024691, "vf_loss_unclipped": 860.4050420118548, "vf_explained_var": -9.54182671585571e-07, "entropy": 5.655785982034354, "mean_kl_loss": 0.00801896888024707, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.202082633972168}}, "num_env_steps_sampled": 860000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 860000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 670.378789307578, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 860000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 860000, "timers": {"training_iteration_time_ms": 6318.548, "sample_time_ms": 3025.96, "synch_weights_time_ms": 1.68}, "counters": {"num_env_steps_sampled": 860000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 215, "trial_id": "0bf95_00000", "date": "2023-12-14_19-52-47", "timestamp": 1702601567, "time_this_iter_s": 5.968835115432739, "time_total_s": 1365.5252947807312, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1365.5252947807312, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 31.633333333333333, "ram_util_percent": 81.26666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.539625511669528}, "default_policy": {"total_loss": 0.539625511669528, "policy_loss": -0.008635243613904378, "vf_loss": 9.322190807826484, "vf_loss_unclipped": 4141.36334191914, "vf_explained_var": -9.572328026614973e-07, "entropy": 5.616866019234728, "mean_kl_loss": 0.029932665273082443, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.803123474121094}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 864000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 619.4424292404963, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 864000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 6375.555, "sample_time_ms": 3059.503, "synch_weights_time_ms": 1.799}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 216, "trial_id": "0bf95_00000", "date": "2023-12-14_19-52-54", "timestamp": 1702601574, "time_this_iter_s": 6.459388971328735, "time_total_s": 1371.98468375206, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1371.98468375206, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 39.13333333333334, "ram_util_percent": 81.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 3.219188136999795}, "default_policy": {"total_loss": 3.219188136999795, "policy_loss": 0.025020902298752274, "vf_loss": 9.485084039570172, "vf_loss_unclipped": 5646.279278574213, "vf_explained_var": -9.577411578408183e-07, "entropy": 5.624082440760598, "mean_kl_loss": 0.13591631009151167, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 34.20468521118164}}, "num_env_steps_sampled": 868000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 868000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 651.971758798348, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 868000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 868000, "timers": {"training_iteration_time_ms": 6383.548, "sample_time_ms": 3068.646, "synch_weights_time_ms": 1.788}, "counters": {"num_env_steps_sampled": 868000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 217, "trial_id": "0bf95_00000", "date": "2023-12-14_19-53-00", "timestamp": 1702601580, "time_this_iter_s": 6.136596918106079, "time_total_s": 1378.121280670166, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1378.121280670166, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 35.944444444444436, "ram_util_percent": 81.91111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2714906954871757}, "default_policy": {"total_loss": 0.2714906954871757, "policy_loss": -0.004962381021157384, "vf_loss": 9.948932295923294, "vf_loss_unclipped": 20761.04644957585, "vf_explained_var": -9.573598914563274e-07, "entropy": 5.8882891567531175, "mean_kl_loss": 0.005173669816812685, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 34.20468521118164}}, "num_env_steps_sampled": 872000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 872000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 637.6648986963177, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 872000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 6411.225, "sample_time_ms": 3097.397, "synch_weights_time_ms": 1.8}, "counters": {"num_env_steps_sampled": 872000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 218, "trial_id": "0bf95_00000", "date": "2023-12-14_19-53-06", "timestamp": 1702601586, "time_this_iter_s": 6.274088144302368, "time_total_s": 1384.3953688144684, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1384.3953688144684, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 25.266666666666666, "ram_util_percent": 82.6222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.610759750310419}, "default_policy": {"total_loss": 0.610759750310419, "policy_loss": -0.0005693101695975039, "vf_loss": 9.812218511536686, "vf_loss_unclipped": 15718.055329499723, "vf_explained_var": -9.582495130201392e-07, "entropy": 5.66207204139563, "mean_kl_loss": 0.015003993396017663, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 34.20468521118164}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 876000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 608.9987564272644, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 876000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 6456.228, "sample_time_ms": 3128.371, "synch_weights_time_ms": 1.925}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 219, "trial_id": "0bf95_00000", "date": "2023-12-14_19-53-13", "timestamp": 1702601593, "time_this_iter_s": 6.570466995239258, "time_total_s": 1390.9658358097076, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1390.9658358097076, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 39.788888888888884, "ram_util_percent": 82.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.5000573469282212}, "default_policy": {"total_loss": 1.5000573469282212, "policy_loss": 0.010069166075811584, "vf_loss": 9.982308188481117, "vf_loss_unclipped": 29301.38419978095, "vf_explained_var": -9.639685087875008e-07, "entropy": 6.203943665347882, "mean_kl_loss": 0.04064253449837403, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 51.307029724121094}}, "num_env_steps_sampled": 880000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 880000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 585.7674005802085, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 880000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 6524.992, "sample_time_ms": 3210.659, "synch_weights_time_ms": 1.936}, "counters": {"num_env_steps_sampled": 880000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 220, "trial_id": "0bf95_00000", "date": "2023-12-14_19-53-20", "timestamp": 1702601600, "time_this_iter_s": 6.830135822296143, "time_total_s": 1397.7959716320038, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1397.7959716320038, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 41.01, "ram_util_percent": 82.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.49833047405075925}, "default_policy": {"total_loss": 0.49833047405075925, "policy_loss": -0.0030689057169247793, "vf_loss": 9.896608052731578, "vf_loss_unclipped": 19786.080792457564, "vf_explained_var": -9.597745785581024e-07, "entropy": 5.869980141043917, "mean_kl_loss": 0.007843628767240667, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 51.307029724121094}}, "num_env_steps_sampled": 884000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 884000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 668.6752839123151, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 884000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 884000, "timers": {"training_iteration_time_ms": 6249.936, "sample_time_ms": 2952.477, "synch_weights_time_ms": 1.812}, "counters": {"num_env_steps_sampled": 884000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 221, "trial_id": "0bf95_00000", "date": "2023-12-14_19-53-25", "timestamp": 1702601605, "time_this_iter_s": 5.983464241027832, "time_total_s": 1403.7794358730316, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1403.7794358730316, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 30.5, "ram_util_percent": 82.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.8000474585764317}, "default_policy": {"total_loss": 0.8000474585764317, "policy_loss": -0.0008970520564360913, "vf_loss": 9.807557944804111, "vf_loss_unclipped": 18851.02372162581, "vf_explained_var": -9.61045466506405e-07, "entropy": 6.032181136897886, "mean_kl_loss": 0.013699271403032039, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 51.307029724121094}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 888000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 661.3239537463123, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 888000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 6224.328, "sample_time_ms": 2945.216, "synch_weights_time_ms": 1.822}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 222, "trial_id": "0bf95_00000", "date": "2023-12-14_19-53-32", "timestamp": 1702601612, "time_this_iter_s": 6.049689054489136, "time_total_s": 1409.8291249275208, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1409.8291249275208, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 23.77777777777778, "ram_util_percent": 82.12222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.0933075165951938}, "default_policy": {"total_loss": 1.0933075165951938, "policy_loss": 0.0006148796806584543, "vf_loss": 9.70442263963126, "vf_loss_unclipped": 13222.210386264045, "vf_explained_var": -9.602829337374235e-07, "entropy": 5.731227046645272, "mean_kl_loss": 0.019405691831982742, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 51.307029724121094}}, "num_env_steps_sampled": 892000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 892000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 668.5469581744126, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 892000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 892000, "timers": {"training_iteration_time_ms": 6219.991, "sample_time_ms": 2952.073, "synch_weights_time_ms": 1.804}, "counters": {"num_env_steps_sampled": 892000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 223, "trial_id": "0bf95_00000", "date": "2023-12-14_19-53-38", "timestamp": 1702601618, "time_this_iter_s": 5.984618902206421, "time_total_s": 1415.8137438297272, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1415.8137438297272, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 26.955555555555556, "ram_util_percent": 81.52222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5580078492095983}, "default_policy": {"total_loss": 0.5580078492095983, "policy_loss": -0.0019661723948848336, "vf_loss": 9.403462157828976, "vf_loss_unclipped": 5203.240976500359, "vf_explained_var": -9.582495130201392e-07, "entropy": 5.65953969142076, "mean_kl_loss": 0.009081395072397557, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 51.307029724121094}}, "num_env_steps_sampled": 896000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 669.5867301807355, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 6221.624, "sample_time_ms": 2955.061, "synch_weights_time_ms": 1.836}, "counters": {"num_env_steps_sampled": 896000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 224, "trial_id": "0bf95_00000", "date": "2023-12-14_19-53-44", "timestamp": 1702601624, "time_this_iter_s": 5.975674867630005, "time_total_s": 1421.7894186973572, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1421.7894186973572, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 30.700000000000003, "ram_util_percent": 82.23750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.29228398530706284}, "default_policy": {"total_loss": 0.29228398530706284, "policy_loss": -0.005332179191802293, "vf_loss": 9.045041164101313, "vf_loss_unclipped": 701.9166016893854, "vf_explained_var": -9.534201388165895e-07, "entropy": 5.5585482349273745, "mean_kl_loss": 0.004037765588817449, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.653514862060547}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 900000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 662.0811843859138, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 900000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 6229.102, "sample_time_ms": 2966.856, "synch_weights_time_ms": 1.797}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 225, "trial_id": "0bf95_00000", "date": "2023-12-14_19-53-50", "timestamp": 1702601630, "time_this_iter_s": 6.042897939682007, "time_total_s": 1427.8323166370392, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1427.8323166370392, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 32.91111111111111, "ram_util_percent": 82.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20904325401938673}, "default_policy": {"total_loss": 0.20904325401938673, "policy_loss": -0.010010224063076507, "vf_loss": 9.068702317504233, "vf_loss_unclipped": 413.3643419066472, "vf_explained_var": -9.550722931493829e-07, "entropy": 5.5766649693568375, "mean_kl_loss": 0.00500385457178957, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.653514862060547}}, "num_env_steps_sampled": 904000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 904000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 666.4861532203217, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 904000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 6183.533, "sample_time_ms": 2932.102, "synch_weights_time_ms": 1.653}, "counters": {"num_env_steps_sampled": 904000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 226, "trial_id": "0bf95_00000", "date": "2023-12-14_19-53-56", "timestamp": 1702601636, "time_this_iter_s": 6.003231048583984, "time_total_s": 1433.8355476856232, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1433.8355476856232, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 30.125, "ram_util_percent": 82.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5026098667050222}, "default_policy": {"total_loss": 0.5026098667050222, "policy_loss": -0.002821722368983778, "vf_loss": 9.035576101050957, "vf_loss_unclipped": 309.58597199494903, "vf_explained_var": -9.545639379700618e-07, "entropy": 5.561318910960704, "mean_kl_loss": 0.016180076342744893, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.653514862060547}}, "num_env_steps_sampled": 908000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}}, "episode_reward_max": -241160.90801553027, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -269601.9214676384, "episode_len_mean": 35039.125, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19570731334281502, "mean_inference_ms": 0.9770230803615098, "mean_action_processing_ms": 0.04867877086450719, "mean_env_wait_ms": 0.27692435744356647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042627255121866865, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.16250709692637125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 908000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 650.4106039638133, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 908000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 908000, "timers": {"training_iteration_time_ms": 6185.005, "sample_time_ms": 2922.65, "synch_weights_time_ms": 1.679}, "counters": {"num_env_steps_sampled": 908000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 227, "trial_id": "0bf95_00000", "date": "2023-12-14_19-54-02", "timestamp": 1702601642, "time_this_iter_s": 6.151514053344727, "time_total_s": 1439.987061738968, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1439.987061738968, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 37.733333333333334, "ram_util_percent": 82.27777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24109157699861253}, "default_policy": {"total_loss": 0.24109157699861253, "policy_loss": -0.0029010507069639306, "vf_loss": 8.90981516655066, "vf_loss_unclipped": 253.19267954958528, "vf_explained_var": -9.559619147131947e-07, "entropy": 5.595993579831967, "mean_kl_loss": 0.006037943605107686, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.653514862060547}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 912000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.0244601339933, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 912000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 6410.551, "sample_time_ms": 3133.065, "synch_weights_time_ms": 1.696}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 228, "trial_id": "0bf95_00000", "date": "2023-12-14_19-54-10", "timestamp": 1702601650, "time_this_iter_s": 8.530088901519775, "time_total_s": 1448.5171506404877, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1448.5171506404877, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 30.799999999999997, "ram_util_percent": 82.19166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 2.8094643121128526}, "default_policy": {"total_loss": 2.8094643121128526, "policy_loss": 0.03957048620728812, "vf_loss": 9.111062416898163, "vf_loss_unclipped": 325.35933247710597, "vf_explained_var": -9.558348259183644e-07, "entropy": 5.5099023450920575, "mean_kl_loss": 0.10442168291706123, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 38.48027038574219}}, "num_env_steps_sampled": 916000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 916000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 629.0301257946572, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 916000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 916000, "timers": {"training_iteration_time_ms": 6389.639, "sample_time_ms": 3110.405, "synch_weights_time_ms": 1.696}, "counters": {"num_env_steps_sampled": 916000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 229, "trial_id": "0bf95_00000", "date": "2023-12-14_19-54-17", "timestamp": 1702601657, "time_this_iter_s": 6.360857009887695, "time_total_s": 1454.8780076503754, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1454.8780076503754, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 42.75555555555555, "ram_util_percent": 81.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.0469227865465414}, "default_policy": {"total_loss": 1.0469227865465414, "policy_loss": 0.005266741499987873, "vf_loss": 9.063386097137354, "vf_loss_unclipped": 363.67033201595865, "vf_explained_var": -9.546910267648921e-07, "entropy": 5.569109447475181, "mean_kl_loss": 0.024714540186622214, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 57.72040557861328}}, "num_env_steps_sampled": 920000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 920000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 655.8437872687024, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 920000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 6316.675, "sample_time_ms": 3033.019, "synch_weights_time_ms": 1.686}, "counters": {"num_env_steps_sampled": 920000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 230, "trial_id": "0bf95_00000", "date": "2023-12-14_19-54-23", "timestamp": 1702601663, "time_this_iter_s": 6.100595951080322, "time_total_s": 1460.9786036014557, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1460.9786036014557, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 31.077777777777776, "ram_util_percent": 82.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4254688915333895}, "default_policy": {"total_loss": 0.4254688915333895, "policy_loss": -0.00325009220047419, "vf_loss": 8.96024982405624, "vf_loss_unclipped": 265.46895837682143, "vf_explained_var": -9.554535595338736e-07, "entropy": 5.692232330724883, "mean_kl_loss": 0.005875157686936143, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 57.72040557861328}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 924000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 663.8123538173605, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 924000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 6321.057, "sample_time_ms": 3020.974, "synch_weights_time_ms": 1.7}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 231, "trial_id": "0bf95_00000", "date": "2023-12-14_19-54-29", "timestamp": 1702601669, "time_this_iter_s": 6.02721095085144, "time_total_s": 1467.0058145523071, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1467.0058145523071, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 30.78888888888889, "ram_util_percent": 82.04444444444442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5552976491219644}, "default_policy": {"total_loss": 0.5552976491219644, "policy_loss": -0.002608859805322723, "vf_loss": 9.229461043119938, "vf_loss_unclipped": 676.3470748177469, "vf_explained_var": -9.549452043545526e-07, "entropy": 5.562029681988617, "mean_kl_loss": 0.008066677565381467, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 57.72040557861328}}, "num_env_steps_sampled": 928000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 928000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 654.9372840334343, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 928000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 6326.955, "sample_time_ms": 3017.863, "synch_weights_time_ms": 1.693}, "counters": {"num_env_steps_sampled": 928000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 232, "trial_id": "0bf95_00000", "date": "2023-12-14_19-54-35", "timestamp": 1702601675, "time_this_iter_s": 6.109052896499634, "time_total_s": 1473.1148674488068, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1473.1148674488068, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 35.1125, "ram_util_percent": 82.13749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.9102915523649215}, "default_policy": {"total_loss": 0.9102915523649215, "policy_loss": -0.0013055601877086896, "vf_loss": 9.05057607530785, "vf_loss_unclipped": 1157.9652100707422, "vf_explained_var": -9.560890035080248e-07, "entropy": 5.5383311685468595, "mean_kl_loss": 0.014225322056565563, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 57.72040557861328}}, "num_env_steps_sampled": 932000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 932000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 667.0505560717419, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 932000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 932000, "timers": {"training_iteration_time_ms": 6328.297, "sample_time_ms": 3012.203, "synch_weights_time_ms": 1.693}, "counters": {"num_env_steps_sampled": 932000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 233, "trial_id": "0bf95_00000", "date": "2023-12-14_19-54-41", "timestamp": 1702601681, "time_this_iter_s": 5.998076915740967, "time_total_s": 1479.1129443645477, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1479.1129443645477, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 26.066666666666666, "ram_util_percent": 81.83333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6845458624308615}, "default_policy": {"total_loss": 0.6845458624308615, "policy_loss": -0.0035349903553764006, "vf_loss": 9.486824103764125, "vf_loss_unclipped": 4827.249496159015, "vf_explained_var": -9.601558449425931e-07, "entropy": 5.3315847687629745, "mean_kl_loss": 0.010277346559394336, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 57.72040557861328}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 936000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 658.3987158231224, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 936000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 6338.448, "sample_time_ms": 3023.59, "synch_weights_time_ms": 1.713}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 234, "trial_id": "0bf95_00000", "date": "2023-12-14_19-54-47", "timestamp": 1702601687, "time_this_iter_s": 6.076589107513428, "time_total_s": 1485.1895334720612, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1485.1895334720612, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 32.3375, "ram_util_percent": 82.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 2.4565737023790764}, "default_policy": {"total_loss": 2.4565737023790764, "policy_loss": 0.008685709650455507, "vf_loss": 9.740319230663243, "vf_loss_unclipped": 14045.037032137547, "vf_explained_var": -9.607912889167443e-07, "entropy": 5.670463406963389, "mean_kl_loss": 0.04072190366696111, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 86.58061218261719}}, "num_env_steps_sampled": 940000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 940000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 645.6261269065197, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 940000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 940000, "timers": {"training_iteration_time_ms": 6353.847, "sample_time_ms": 3036.867, "synch_weights_time_ms": 1.7}, "counters": {"num_env_steps_sampled": 940000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 235, "trial_id": "0bf95_00000", "date": "2023-12-14_19-54-53", "timestamp": 1702601693, "time_this_iter_s": 6.196856737136841, "time_total_s": 1491.386390209198, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1491.386390209198, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 31.977777777777774, "ram_util_percent": 82.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7555124416057744}, "default_policy": {"total_loss": 0.7555124416057744, "policy_loss": -0.0003063915985455709, "vf_loss": 9.752994276058953, "vf_loss_unclipped": 13412.431606056847, "vf_explained_var": -9.59139134583951e-07, "entropy": 5.541654267544939, "mean_kl_loss": 0.007603190477067386, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 86.58061218261719}}, "num_env_steps_sampled": 944000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 944000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 633.3244409087819, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 944000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 6385.264, "sample_time_ms": 3045.351, "synch_weights_time_ms": 1.87}, "counters": {"num_env_steps_sampled": 944000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 236, "trial_id": "0bf95_00000", "date": "2023-12-14_19-55-00", "timestamp": 1702601700, "time_this_iter_s": 6.3183019161224365, "time_total_s": 1497.7046921253204, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1497.7046921253204, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 34.422222222222224, "ram_util_percent": 81.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3616679496268855}, "default_policy": {"total_loss": 0.3616679496268855, "policy_loss": -0.0023822925983866586, "vf_loss": 9.959180992549417, "vf_loss_unclipped": 23217.353783711187, "vf_explained_var": -9.648581303513127e-07, "entropy": 6.013241423726845, "mean_kl_loss": 0.0030544762922877096, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 43.290306091308594}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 948000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 642.089244318873, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 948000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 6393.236, "sample_time_ms": 3063.414, "synch_weights_time_ms": 1.843}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 237, "trial_id": "0bf95_00000", "date": "2023-12-14_19-55-06", "timestamp": 1702601706, "time_this_iter_s": 6.231229066848755, "time_total_s": 1503.9359211921692, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1503.9359211921692, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 29.700000000000003, "ram_util_percent": 81.85555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7092180166488835}, "default_policy": {"total_loss": 0.7092180166488835, "policy_loss": 0.003636582492431725, "vf_loss": 9.892877635671132, "vf_loss_unclipped": 17566.536726766557, "vf_explained_var": -9.623163544547075e-07, "entropy": 5.84868782415573, "mean_kl_loss": 0.014013591345535767, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 43.290306091308594}}, "num_env_steps_sampled": 952000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 952000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 626.7212151533464, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 952000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 6178.644, "sample_time_ms": 2849.928, "synch_weights_time_ms": 1.829}, "counters": {"num_env_steps_sampled": 952000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 238, "trial_id": "0bf95_00000", "date": "2023-12-14_19-55-12", "timestamp": 1702601712, "time_this_iter_s": 6.384085178375244, "time_total_s": 1510.3200063705444, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1510.3200063705444, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 40.34444444444445, "ram_util_percent": 82.34444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7326110091481381}, "default_policy": {"total_loss": 0.7326110091481381, "policy_loss": 0.001261087952614593, "vf_loss": 9.869022796403117, "vf_loss_unclipped": 15351.769347396232, "vf_explained_var": -9.606642001219142e-07, "entropy": 6.058773322400254, "mean_kl_loss": 0.014614350231560339, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 43.290306091308594}}, "num_env_steps_sampled": 956000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 956000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 649.5357952063273, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 956000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 956000, "timers": {"training_iteration_time_ms": 6158.572, "sample_time_ms": 2857.782, "synch_weights_time_ms": 1.745}, "counters": {"num_env_steps_sampled": 956000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 239, "trial_id": "0bf95_00000", "date": "2023-12-14_19-55-18", "timestamp": 1702601718, "time_this_iter_s": 6.160466194152832, "time_total_s": 1516.4804725646973, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1516.4804725646973, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 31.38888888888889, "ram_util_percent": 82.4111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.2213074136644537}, "default_policy": {"total_loss": 1.2213074136644537, "policy_loss": 0.0059732366606458105, "vf_loss": 9.857841292423988, "vf_loss_unclipped": 13008.144753527286, "vf_explained_var": -9.629517984288587e-07, "entropy": 5.86090354472081, "mean_kl_loss": 0.025796901528227376, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 64.93545532226562}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 960000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 666.0927049197282, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 960000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 6149.188, "sample_time_ms": 2857.64, "synch_weights_time_ms": 1.759}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 240, "trial_id": "0bf95_00000", "date": "2023-12-14_19-55-24", "timestamp": 1702601724, "time_this_iter_s": 6.0064780712127686, "time_total_s": 1522.48695063591, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1522.48695063591, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 21.58888888888889, "ram_util_percent": 82.32222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.0922470409462828}, "default_policy": {"total_loss": 1.0922470409462828, "policy_loss": 0.0025546850625679757, "vf_loss": 9.457268939597775, "vf_loss_unclipped": 4753.496926069768, "vf_explained_var": -9.548181155597222e-07, "entropy": 5.614712913915801, "mean_kl_loss": 0.015324750793890828, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 64.93545532226562}}, "num_env_steps_sampled": 964000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 964000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 674.1130075616448, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 964000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 964000, "timers": {"training_iteration_time_ms": 6139.981, "sample_time_ms": 2858.12, "synch_weights_time_ms": 1.765}, "counters": {"num_env_steps_sampled": 964000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 241, "trial_id": "0bf95_00000", "date": "2023-12-14_19-55-30", "timestamp": 1702601730, "time_this_iter_s": 5.935198068618774, "time_total_s": 1528.4221487045288, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1528.4221487045288, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 30.375, "ram_util_percent": 82.5875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.1138407903502998}, "default_policy": {"total_loss": 1.1138407903502998, "policy_loss": -0.001184206926571662, "vf_loss": 9.320115016213357, "vf_loss_unclipped": 1811.1480551599693, "vf_explained_var": -9.544368491752315e-07, "entropy": 5.604436073730241, "mean_kl_loss": 0.015735992631754094, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 64.93545532226562}}, "num_env_steps_sampled": 968000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 968000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 679.9100375953759, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 968000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 6117.549, "sample_time_ms": 2842.568, "synch_weights_time_ms": 1.748}, "counters": {"num_env_steps_sampled": 968000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 242, "trial_id": "0bf95_00000", "date": "2023-12-14_19-55-36", "timestamp": 1702601736, "time_this_iter_s": 5.884465932846069, "time_total_s": 1534.3066146373749, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1534.3066146373749, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 30.2875, "ram_util_percent": 82.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17246403159109006}, "default_policy": {"total_loss": 0.17246403159109006, "policy_loss": -0.0065313485036018306, "vf_loss": 9.15742951618837, "vf_loss_unclipped": 663.8034040455117, "vf_explained_var": -9.55580648328704e-07, "entropy": 5.624524021453695, "mean_kl_loss": 0.0013462766631907135, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 32.46772766113281}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 972000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 660.0249324680091, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 972000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 6123.932, "sample_time_ms": 2852.912, "synch_weights_time_ms": 1.758}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 243, "trial_id": "0bf95_00000", "date": "2023-12-14_19-55-42", "timestamp": 1702601742, "time_this_iter_s": 6.061694145202637, "time_total_s": 1540.3683087825775, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1540.3683087825775, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 35.544444444444444, "ram_util_percent": 82.97777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21923003837402696}, "default_policy": {"total_loss": 0.21923003837402696, "policy_loss": -0.0032547564848439334, "vf_loss": 9.137833839286365, "vf_loss_unclipped": 313.52094577472093, "vf_explained_var": -9.54182671585571e-07, "entropy": 5.696698313328757, "mean_kl_loss": 0.004038054604239997, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.233863830566406}}, "num_env_steps_sampled": 976000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 976000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 622.0735490813494, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 976000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 6159.401, "sample_time_ms": 2887.602, "synch_weights_time_ms": 1.846}, "counters": {"num_env_steps_sampled": 976000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 244, "trial_id": "0bf95_00000", "date": "2023-12-14_19-55-49", "timestamp": 1702601749, "time_this_iter_s": 6.4326581954956055, "time_total_s": 1546.8009669780731, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1546.8009669780731, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 46.62222222222223, "ram_util_percent": 83.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.43895687106480474}, "default_policy": {"total_loss": 0.43895687106480474, "policy_loss": -0.0023676722808413384, "vf_loss": 9.144795655695868, "vf_loss_unclipped": 362.27041435648385, "vf_explained_var": -9.553264707390433e-07, "entropy": 5.651942068579863, "mean_kl_loss": 0.02155226833158933, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 24.35079574584961}}, "num_env_steps_sampled": 980000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -267001.92723934544, "episode_len_mean": 35039.11538461538, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19591692086577586, "mean_inference_ms": 0.9779797313587271, "mean_action_processing_ms": 0.048722874984898544, "mean_env_wait_ms": 0.27573637984556787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004234680762657752, "StateBufferConnector_ms": 0.0022512215834397534, "ViewRequirementAgentConnector_ms": 0.16059141892653245}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 980000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 666.7636641571712, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 980000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 980000, "timers": {"training_iteration_time_ms": 6139.76, "sample_time_ms": 2876.247, "synch_weights_time_ms": 1.851}, "counters": {"num_env_steps_sampled": 980000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 245, "trial_id": "0bf95_00000", "date": "2023-12-14_19-55-55", "timestamp": 1702601755, "time_this_iter_s": 6.00075101852417, "time_total_s": 1552.8017179965973, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1552.8017179965973, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 33.888888888888886, "ram_util_percent": 83.12222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2956128761744194}, "default_policy": {"total_loss": 0.2956128761744194, "policy_loss": -0.005300143773335892, "vf_loss": 9.214847061425639, "vf_loss_unclipped": 413.05109749572364, "vf_explained_var": -9.55707737123534e-07, "entropy": 5.637210047829634, "mean_kl_loss": 0.008573212627261784, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 24.35079574584961}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -265026.389880378, "episode_len_mean": 35039.107142857145, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908, -239638.20097004855, -239050.60745755432], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960879038088184, "mean_inference_ms": 0.9787704128087118, "mean_action_processing_ms": 0.04875970860118207, "mean_env_wait_ms": 0.2746444764125618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004151037761143276, "StateBufferConnector_ms": 0.0022300652095249723, "ViewRequirementAgentConnector_ms": 0.15898687498910086}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -265026.389880378, "episode_len_mean": 35039.107142857145, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908, -239638.20097004855, -239050.60745755432], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960879038088184, "mean_inference_ms": 0.9787704128087118, "mean_action_processing_ms": 0.04875970860118207, "mean_env_wait_ms": 0.2746444764125618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004151037761143276, "StateBufferConnector_ms": 0.0022300652095249723, "ViewRequirementAgentConnector_ms": 0.15898687498910086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 984000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 475.5872691544934, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 984000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 6349.246, "sample_time_ms": 3109.338, "synch_weights_time_ms": 1.684}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 246, "trial_id": "0bf95_00000", "date": "2023-12-14_19-56-03", "timestamp": 1702601763, "time_this_iter_s": 8.412954807281494, "time_total_s": 1561.2146728038788, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1561.2146728038788, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 32.79166666666667, "ram_util_percent": 82.75833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.6877283312713922}, "default_policy": {"total_loss": 1.6877283312713922, "policy_loss": 0.01508796945569723, "vf_loss": 9.159083674457282, "vf_loss_unclipped": 387.4588497218801, "vf_explained_var": -9.54182671585571e-07, "entropy": 5.488854314726807, "mean_kl_loss": 0.06492804386089081, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.52619171142578}}, "num_env_steps_sampled": 988000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -265026.389880378, "episode_len_mean": 35039.107142857145, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908, -239638.20097004855, -239050.60745755432], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960879038088184, "mean_inference_ms": 0.9787704128087118, "mean_action_processing_ms": 0.04875970860118207, "mean_env_wait_ms": 0.2746444764125618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004151037761143276, "StateBufferConnector_ms": 0.0022300652095249723, "ViewRequirementAgentConnector_ms": 0.15898687498910086}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -265026.389880378, "episode_len_mean": 35039.107142857145, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908, -239638.20097004855, -239050.60745755432], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960879038088184, "mean_inference_ms": 0.9787704128087118, "mean_action_processing_ms": 0.04875970860118207, "mean_env_wait_ms": 0.2746444764125618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004151037761143276, "StateBufferConnector_ms": 0.0022300652095249723, "ViewRequirementAgentConnector_ms": 0.15898687498910086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 988000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 658.9095405471969, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 988000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 988000, "timers": {"training_iteration_time_ms": 6333.343, "sample_time_ms": 3100.645, "synch_weights_time_ms": 1.69}, "counters": {"num_env_steps_sampled": 988000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 247, "trial_id": "0bf95_00000", "date": "2023-12-14_19-56-09", "timestamp": 1702601769, "time_this_iter_s": 6.071881294250488, "time_total_s": 1567.2865540981293, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1567.2865540981293, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 37.0125, "ram_util_percent": 82.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2735962065449084}, "default_policy": {"total_loss": 0.2735962065449084, "policy_loss": -0.005571018396092376, "vf_loss": 9.037672533917783, "vf_loss_unclipped": 299.707294037093, "vf_explained_var": -9.546910267648921e-07, "entropy": 5.502935795387479, "mean_kl_loss": 0.005168633619844946, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 36.52619171142578}}, "num_env_steps_sampled": 992000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -265026.389880378, "episode_len_mean": 35039.107142857145, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908, -239638.20097004855, -239050.60745755432], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960879038088184, "mean_inference_ms": 0.9787704128087118, "mean_action_processing_ms": 0.04875970860118207, "mean_env_wait_ms": 0.2746444764125618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004151037761143276, "StateBufferConnector_ms": 0.0022300652095249723, "ViewRequirementAgentConnector_ms": 0.15898687498910086}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -265026.389880378, "episode_len_mean": 35039.107142857145, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908, -239638.20097004855, -239050.60745755432], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960879038088184, "mean_inference_ms": 0.9787704128087118, "mean_action_processing_ms": 0.04875970860118207, "mean_env_wait_ms": 0.2746444764125618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004151037761143276, "StateBufferConnector_ms": 0.0022300652095249723, "ViewRequirementAgentConnector_ms": 0.15898687498910086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 992000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 642.1813598322397, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 992000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 6317.978, "sample_time_ms": 3094.807, "synch_weights_time_ms": 1.736}, "counters": {"num_env_steps_sampled": 992000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 248, "trial_id": "0bf95_00000", "date": "2023-12-14_19-56-16", "timestamp": 1702601776, "time_this_iter_s": 6.2300779819488525, "time_total_s": 1573.5166320800781, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1573.5166320800781, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 36.86666666666667, "ram_util_percent": 82.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.25946053390754564}, "default_policy": {"total_loss": 0.25946053390754564, "policy_loss": -0.004263251139196569, "vf_loss": 9.131225211788088, "vf_loss_unclipped": 383.5885020583423, "vf_explained_var": -9.544368491752315e-07, "entropy": 5.441208589305756, "mean_kl_loss": 0.004720216589427972, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.26309585571289}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -265026.389880378, "episode_len_mean": 35039.107142857145, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908, -239638.20097004855, -239050.60745755432], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960879038088184, "mean_inference_ms": 0.9787704128087118, "mean_action_processing_ms": 0.04875970860118207, "mean_env_wait_ms": 0.2746444764125618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004151037761143276, "StateBufferConnector_ms": 0.0022300652095249723, "ViewRequirementAgentConnector_ms": 0.15898687498910086}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -265026.389880378, "episode_len_mean": 35039.107142857145, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908, -239638.20097004855, -239050.60745755432], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960879038088184, "mean_inference_ms": 0.9787704128087118, "mean_action_processing_ms": 0.04875970860118207, "mean_env_wait_ms": 0.2746444764125618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004151037761143276, "StateBufferConnector_ms": 0.0022300652095249723, "ViewRequirementAgentConnector_ms": 0.15898687498910086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 996000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 617.3905760407702, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 996000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 6350.041, "sample_time_ms": 3106.395, "synch_weights_time_ms": 1.73}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 249, "trial_id": "0bf95_00000", "date": "2023-12-14_19-56-22", "timestamp": 1702601782, "time_this_iter_s": 6.480427980422974, "time_total_s": 1579.997060060501, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1579.997060060501, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 35.15, "ram_util_percent": 82.59}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.300480840342449}, "default_policy": {"total_loss": 0.300480840342449, "policy_loss": -0.004774809372164547, "vf_loss": 9.175046775895142, "vf_loss_unclipped": 1192.6911943878954, "vf_explained_var": -9.546910267648921e-07, "entropy": 5.322811883649846, "mean_kl_loss": 0.011690525463940182, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.26309585571289}}, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -265026.389880378, "episode_len_mean": 35039.107142857145, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908, -239638.20097004855, -239050.60745755432], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960879038088184, "mean_inference_ms": 0.9787704128087118, "mean_action_processing_ms": 0.04875970860118207, "mean_env_wait_ms": 0.2746444764125618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004151037761143276, "StateBufferConnector_ms": 0.0022300652095249723, "ViewRequirementAgentConnector_ms": 0.15898687498910086}}, "episode_reward_max": -235685.54886108908, "episode_reward_min": -304076.3403449871, "episode_reward_mean": -265026.389880378, "episode_len_mean": 35039.107142857145, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-301284.22671343246, -304076.3403449871, -293580.16448250203, -292606.9845685117, -287878.6254343782, -287660.3765691886, -279767.1185533491, -279408.49879403535, -270838.762512636, -271751.17648447055, -271146.6793632847, -271464.83883502625, -270658.5469340645, -271456.86006501206, -263284.4758655768, -263518.9320968136, -255335.01009744167, -253915.6198831099, -252779.78954278716, -251950.51196314674, -246682.11548441142, -246080.92208908455, -241160.90801553027, -242158.63053054147, -235918.44413856944, -235685.54886108908, -239638.20097004855, -239050.60745755432], "episode_lengths": [35039, 35040, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35040, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960879038088184, "mean_inference_ms": 0.9787704128087118, "mean_action_processing_ms": 0.04875970860118207, "mean_env_wait_ms": 0.2746444764125618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004151037761143276, "StateBufferConnector_ms": 0.0022300652095249723, "ViewRequirementAgentConnector_ms": 0.15898687498910086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 672.8749345462386, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 6343.988, "sample_time_ms": 3101.226, "synch_weights_time_ms": 1.732}, "counters": {"num_env_steps_sampled": 1000000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 0}, "done": true, "episodes_total": 28, "training_iteration": 250, "trial_id": "0bf95_00000", "date": "2023-12-14_19-56-28", "timestamp": 1702601788, "time_this_iter_s": 5.946141004562378, "time_total_s": 1585.9432010650635, "pid": 35155, "hostname": "Ahmeds-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmppgtc4tx1", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x282baf600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1585.9432010650635, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 34.7375, "ram_util_percent": 82.65}}
