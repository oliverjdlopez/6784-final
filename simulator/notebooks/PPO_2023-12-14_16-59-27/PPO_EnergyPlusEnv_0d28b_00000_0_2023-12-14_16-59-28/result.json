{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.189990878895497}, "default_policy": {"total_loss": 0.189990878895497, "policy_loss": 0.02134563700695123, "vf_loss": 9.995862012224665, "vf_loss_unclipped": 3003.6338378645974, "vf_explained_var": 0.0005576656317151686, "entropy": 4.365385969056249, "mean_kl_loss": 0.22895540711319845, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 447.29830317572373, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8942.556, "sample_time_ms": 6835.889, "synch_weights_time_ms": 1.472}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "0d28b_00000", "date": "2023-12-14_16-59-49", "timestamp": 1702591189, "time_this_iter_s": 8.943830013275146, "time_total_s": 8.943830013275146, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8.943830013275146, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.43846153846154, "ram_util_percent": 79.70769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19027835571927937}, "default_policy": {"total_loss": 0.19027835571927937, "policy_loss": 0.014249505607216661, "vf_loss": 8.984450889802945, "vf_loss_unclipped": 527.6530239495642, "vf_explained_var": -0.013102836319124267, "entropy": 4.1760322676538655, "mean_kl_loss": 0.1915207566754984, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 909.8185494738717, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 6669.511, "sample_time_ms": 4582.266, "synch_weights_time_ms": 1.43}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "0d28b_00000", "date": "2023-12-14_16-59-54", "timestamp": 1702591194, "time_this_iter_s": 4.397807836532593, "time_total_s": 13.34163784980774, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13.34163784980774, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.028571428571425, "ram_util_percent": 79.61428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.16428760052529542}, "default_policy": {"total_loss": 0.16428760052529542, "policy_loss": -0.004244367812456353, "vf_loss": 8.651638957737351, "vf_loss_unclipped": 149.5212819479676, "vf_explained_var": 0.0035235213318359116, "entropy": 4.076048966409809, "mean_kl_loss": 0.12150456045872407, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0125000476837158}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 910.4856070560343, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 5910.757, "sample_time_ms": 3824.797, "synch_weights_time_ms": 1.432}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "0d28b_00000", "date": "2023-12-14_16-59-58", "timestamp": 1702591198, "time_this_iter_s": 4.394506931304932, "time_total_s": 17.73614478111267, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 17.73614478111267, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.25, "ram_util_percent": 79.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.18279693556476884}, "default_policy": {"total_loss": 0.18279693556476884, "policy_loss": -0.0013191528243026627, "vf_loss": 8.711498044955452, "vf_loss_unclipped": 192.27693949782773, "vf_explained_var": 0.03699333473309271, "entropy": 4.0411311184673675, "mean_kl_loss": 0.09580356061456353, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 904.40424155115, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 5538.765, "sample_time_ms": 3453.095, "synch_weights_time_ms": 1.418}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-03", "timestamp": 1702591203, "time_this_iter_s": 4.424056053161621, "time_total_s": 22.160200834274292, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 22.160200834274292, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.083333333333336, "ram_util_percent": 79.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1549669479303904}, "default_policy": {"total_loss": 0.1549669479303904, "policy_loss": -0.013732450383741147, "vf_loss": 8.606761298454138, "vf_loss_unclipped": 217.73356558061613, "vf_explained_var": 0.0543695508417036, "entropy": 3.9833518937706693, "mean_kl_loss": 0.05440775786729049, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.278125047683716}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 891.8758634503909, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 5327.995, "sample_time_ms": 3236.85, "synch_weights_time_ms": 1.442}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-07", "timestamp": 1702591207, "time_this_iter_s": 4.486235857009888, "time_total_s": 26.64643669128418, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 26.64643669128418, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.0, "ram_util_percent": 79.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1946985132253564}, "default_policy": {"total_loss": 0.1946985132253564, "policy_loss": -0.01047814158456666, "vf_loss": 9.185510969873684, "vf_loss_unclipped": 664.8422298553402, "vf_explained_var": 0.027388045909816524, "entropy": 4.016407468679871, "mean_kl_loss": 0.04974333889853668, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 3.4171876907348633}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 906.2822153601757, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 5175.6, "sample_time_ms": 3086.831, "synch_weights_time_ms": 1.426}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-12", "timestamp": 1702591212, "time_this_iter_s": 4.414945125579834, "time_total_s": 31.061381816864014, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 31.061381816864014, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.24285714285714, "ram_util_percent": 79.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3734274184160522}, "default_policy": {"total_loss": 0.3734274184160522, "policy_loss": 0.00945164428563165, "vf_loss": 9.359740133732876, "vf_loss_unclipped": 3207.7820258638753, "vf_explained_var": 0.021833626890995862, "entropy": 3.930744123611369, "mean_kl_loss": 0.07912306872534447, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 5.125781536102295}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 903.2103851760196, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 5068.891, "sample_time_ms": 2983.268, "synch_weights_time_ms": 1.424}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-16", "timestamp": 1702591216, "time_this_iter_s": 4.429939031600952, "time_total_s": 35.491320848464966, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 35.491320848464966, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.25, "ram_util_percent": 79.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.25343971202142046}, "default_policy": {"total_loss": 0.25343971202142046, "policy_loss": -0.00982476278359114, "vf_loss": 9.64942748358509, "vf_loss_unclipped": 5003.317258806371, "vf_explained_var": 0.009383203950263798, "entropy": 3.99061318018289, "mean_kl_loss": 0.032535565410846665, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 7.688672065734863}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 895.4681313362681, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 4993.645, "sample_time_ms": 2905.406, "synch_weights_time_ms": 1.426}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-20", "timestamp": 1702591220, "time_this_iter_s": 4.4685750007629395, "time_total_s": 39.959895849227905, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 39.959895849227905, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.86666666666667, "ram_util_percent": 79.16666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24981375462782662}, "default_policy": {"total_loss": 0.24981375462782662, "policy_loss": -0.008825421642099044, "vf_loss": 9.73812870582792, "vf_loss_unclipped": 3917.948248417901, "vf_explained_var": 0.014572571335570899, "entropy": 3.830211778185261, "mean_kl_loss": 0.020973438458887786, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 11.533008575439453}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 898.3014519934812, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 4933.555, "sample_time_ms": 2846.392, "synch_weights_time_ms": 1.421}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-25", "timestamp": 1702591225, "time_this_iter_s": 4.454237937927246, "time_total_s": 44.41413378715515, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 44.41413378715515, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.485714285714288, "ram_util_percent": 78.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4126261706108541}, "default_policy": {"total_loss": 0.4126261706108541, "policy_loss": -0.001791431054250518, "vf_loss": 9.697906372135382, "vf_loss_unclipped": 2883.703017277504, "vf_explained_var": 0.023944744041987827, "entropy": 3.736042136068283, "mean_kl_loss": 0.02752434767273123, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.29951286315918}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 886.7702943545802, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 4891.274, "sample_time_ms": 2800.076, "synch_weights_time_ms": 1.414}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-29", "timestamp": 1702591229, "time_this_iter_s": 4.511960744857788, "time_total_s": 48.92609453201294, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 48.92609453201294, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.900000000000002, "ram_util_percent": 78.81666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.313549551266883}, "default_policy": {"total_loss": 0.313549551266883, "policy_loss": -0.007236724243318634, "vf_loss": 9.695167081950824, "vf_loss_unclipped": 2681.688096621906, "vf_explained_var": 0.004575975858834761, "entropy": 3.75429880415707, "mean_kl_loss": 0.012938780872530288, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.29951286315918}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 900.4011958324579, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 4441.264, "sample_time_ms": 2352.477, "synch_weights_time_ms": 1.429}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-34", "timestamp": 1702591234, "time_this_iter_s": 4.443684816360474, "time_total_s": 53.36977934837341, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 53.36977934837341, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 28.085714285714285, "ram_util_percent": 79.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.27118246660017764}, "default_policy": {"total_loss": 0.27118246660017764, "policy_loss": -0.006629422026029083, "vf_loss": 9.748667000199177, "vf_loss_unclipped": 3202.387777950718, "vf_explained_var": -0.013805621214258646, "entropy": 3.6808169177854495, "mean_kl_loss": 0.01042371649418395, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.29951286315918}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 869.2913881933749, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 4461.761, "sample_time_ms": 2370.754, "synch_weights_time_ms": 1.463}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-39", "timestamp": 1702591239, "time_this_iter_s": 4.602703094482422, "time_total_s": 57.972482442855835, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 57.972482442855835, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 36.36666666666667, "ram_util_percent": 78.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2382096423467657}, "default_policy": {"total_loss": 0.2382096423467657, "policy_loss": -0.01441899717433938, "vf_loss": 9.225363513808261, "vf_loss_unclipped": 1908.7672820345424, "vf_explained_var": -0.05298318245263496, "entropy": 3.830470096327857, "mean_kl_loss": 0.009270492631885782, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.29951286315918}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 887.4907678767286, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 4473.143, "sample_time_ms": 2384.547, "synch_weights_time_ms": 1.476}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-43", "timestamp": 1702591243, "time_this_iter_s": 4.508632183074951, "time_total_s": 62.481114625930786, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 62.481114625930786, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.78571428571428, "ram_util_percent": 79.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2550180148500115}, "default_policy": {"total_loss": 0.2550180148500115, "policy_loss": -0.01927559351179201, "vf_loss": 8.988254923810329, "vf_loss_unclipped": 1229.470139281836, "vf_explained_var": 0.013531241335594324, "entropy": 3.8077133545743376, "mean_kl_loss": 0.010659899295151534, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.29951286315918}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 895.095105231408, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 4477.743, "sample_time_ms": 2390.266, "synch_weights_time_ms": 1.474}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-48", "timestamp": 1702591248, "time_this_iter_s": 4.470127105712891, "time_total_s": 66.95124173164368, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 66.95124173164368, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.46666666666667, "ram_util_percent": 79.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.15338474502369984}, "default_policy": {"total_loss": 0.15338474502369984, "policy_loss": -0.004805960094750817, "vf_loss": 8.625357138830969, "vf_loss_unclipped": 212.35194744280915, "vf_explained_var": 0.01983573772251479, "entropy": 3.758172946443944, "mean_kl_loss": 0.004158332952999632, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.64975643157959}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 905.9913624931318, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 4470.756, "sample_time_ms": 2386.908, "synch_weights_time_ms": 1.474}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-52", "timestamp": 1702591252, "time_this_iter_s": 4.4163219928741455, "time_total_s": 71.36756372451782, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 71.36756372451782, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 31.133333333333336, "ram_util_percent": 79.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.18878458530060263}, "default_policy": {"total_loss": 0.18878458530060263, "policy_loss": -0.005176165129250682, "vf_loss": 8.456699620940284, "vf_loss_unclipped": 169.74423373533463, "vf_explained_var": 0.02272743603059732, "entropy": 3.705877817261702, "mean_kl_loss": 0.012647033114379093, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.64975643157959}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 916.5719895010508, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 4465.801, "sample_time_ms": 2385.733, "synch_weights_time_ms": 1.466}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "0d28b_00000", "date": "2023-12-14_17-00-56", "timestamp": 1702591256, "time_this_iter_s": 4.365303993225098, "time_total_s": 75.73286771774292, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 75.73286771774292, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.566666666666666, "ram_util_percent": 79.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2555202133238697}, "default_policy": {"total_loss": 0.2555202133238697, "policy_loss": -0.012500456842119251, "vf_loss": 8.49396815127147, "vf_loss_unclipped": 184.44572579276078, "vf_explained_var": 0.02911548764466731, "entropy": 3.6516857012502673, "mean_kl_loss": 0.021166028346474058, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 12.974634170532227}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 911.742386448586, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 4461.657, "sample_time_ms": 2382.843, "synch_weights_time_ms": 1.461}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-01", "timestamp": 1702591261, "time_this_iter_s": 4.388442754745483, "time_total_s": 80.1213104724884, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 80.1213104724884, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 27.671428571428574, "ram_util_percent": 79.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17606336932812036}, "default_policy": {"total_loss": 0.17606336932812036, "policy_loss": -0.003438746553164587, "vf_loss": 8.499799062956624, "vf_loss_unclipped": 177.78676109069954, "vf_explained_var": -0.03594838886627002, "entropy": 3.638976827867504, "mean_kl_loss": 0.007283760308062654, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 12.974634170532227}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 605.7433493020249, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 4675.31, "sample_time_ms": 2601.782, "synch_weights_time_ms": 1.457}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 18, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-07", "timestamp": 1702591267, "time_this_iter_s": 6.604896068572998, "time_total_s": 86.7262065410614, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 86.7262065410614, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 22.755555555555556, "ram_util_percent": 79.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5149461445229839}, "default_policy": {"total_loss": 0.5149461445229839, "policy_loss": 0.0019575588967103057, "vf_loss": 8.589276411385933, "vf_loss_unclipped": 165.56086306378785, "vf_explained_var": 0.020011694954910765, "entropy": 3.5965479805525433, "mean_kl_loss": 0.03291775439755274, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.461952209472656}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 905.7546776927215, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 76000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 4671.646, "sample_time_ms": 2601.641, "synch_weights_time_ms": 1.457}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 19, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-12", "timestamp": 1702591272, "time_this_iter_s": 4.41745400428772, "time_total_s": 91.14366054534912, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 91.14366054534912, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 30.166666666666668, "ram_util_percent": 79.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3474153686862892}, "default_policy": {"total_loss": 0.3474153686862892, "policy_loss": -0.003567605318108411, "vf_loss": 8.3983034797823, "vf_loss_unclipped": 162.44243470132986, "vf_explained_var": -0.039947411653075394, "entropy": 3.589462291711429, "mean_kl_loss": 0.013719072858553514, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.461952209472656}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 914.5204484837319, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 80000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 4657.957, "sample_time_ms": 2593.478, "synch_weights_time_ms": 1.466}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 20, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-16", "timestamp": 1702591276, "time_this_iter_s": 4.375274896621704, "time_total_s": 95.51893544197083, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 95.51893544197083, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.900000000000002, "ram_util_percent": 78.88571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.189049745882069}, "default_policy": {"total_loss": 0.189049745882069, "policy_loss": -0.005079631623166647, "vf_loss": 8.526639623174281, "vf_loss_unclipped": 138.33842416612833, "vf_explained_var": 0.14107663653044303, "entropy": 3.5340394737369722, "mean_kl_loss": 0.005593631150090846, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.461952209472656}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 917.1508109548938, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 84000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 4649.844, "sample_time_ms": 2587.697, "synch_weights_time_ms": 1.454}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 21, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-21", "timestamp": 1702591281, "time_this_iter_s": 4.362567901611328, "time_total_s": 99.88150334358215, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 99.88150334358215, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.78333333333333, "ram_util_percent": 78.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17598683432316475}, "default_policy": {"total_loss": 0.17598683432316475, "policy_loss": -0.005851405713437145, "vf_loss": 8.640614075447196, "vf_loss_unclipped": 212.09395080029583, "vf_explained_var": -0.050586489789775695, "entropy": 3.591451871115516, "mean_kl_loss": 0.004903521521532106, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.730976104736328}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 897.4801657671653, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 88000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 4635.392, "sample_time_ms": 2570.359, "synch_weights_time_ms": 1.43}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 22, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-25", "timestamp": 1702591285, "time_this_iter_s": 4.458683967590332, "time_total_s": 104.34018731117249, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 104.34018731117249, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 32.74999999999999, "ram_util_percent": 78.48333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.15950968551602382}, "default_policy": {"total_loss": 0.15950968551602382, "policy_loss": -0.005971448624313974, "vf_loss": 8.845116888282142, "vf_loss_unclipped": 362.43660387148987, "vf_explained_var": 0.057168964638130496, "entropy": 3.6175800160304314, "mean_kl_loss": 0.007915954600674067, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.730976104736328}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 844.1739464012549, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 92000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 4658.52, "sample_time_ms": 2558.433, "synch_weights_time_ms": 1.465}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 23, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-30", "timestamp": 1702591290, "time_this_iter_s": 4.740140199661255, "time_total_s": 109.08032751083374, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 109.08032751083374, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 28.142857142857146, "ram_util_percent": 78.11428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2234086691618347}, "default_policy": {"total_loss": 0.2234086691618347, "policy_loss": -0.017030330884184982, "vf_loss": 9.16943893910471, "vf_loss_unclipped": 1350.7329049832276, "vf_explained_var": 0.010662966254931776, "entropy": 3.6514283817714213, "mean_kl_loss": 0.015285682898020183, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.730976104736328}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 846.4193245683957, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 96000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 4684.219, "sample_time_ms": 2549.597, "synch_weights_time_ms": 1.537}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 24, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-34", "timestamp": 1702591294, "time_this_iter_s": 4.727707862854004, "time_total_s": 113.80803537368774, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 113.80803537368774, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 27.657142857142855, "ram_util_percent": 77.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.25266843558803426}, "default_policy": {"total_loss": 0.25266843558803426, "policy_loss": -0.009438325541276636, "vf_loss": 9.6875928261641, "vf_loss_unclipped": 3498.013910606726, "vf_explained_var": 0.03083209429722605, "entropy": 3.6857534646987915, "mean_kl_loss": 0.01697988252852889, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.730976104736328}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 838.4525574497777, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 100000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 4719.783, "sample_time_ms": 2551.918, "synch_weights_time_ms": 1.594}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 25, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-39", "timestamp": 1702591299, "time_this_iter_s": 4.772258043289185, "time_total_s": 118.58029341697693, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 118.58029341697693, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.2, "ram_util_percent": 77.67142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.30190745167640737}, "default_policy": {"total_loss": 0.30190745167640737, "policy_loss": -0.005052663017509144, "vf_loss": 9.565195458784286, "vf_loss_unclipped": 3106.3824609622266, "vf_explained_var": 0.009549248256663015, "entropy": 3.661328953974791, "mean_kl_loss": 0.021715001396390286, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 851.0614466874215, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 104000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 4753.376, "sample_time_ms": 2554.117, "synch_weights_time_ms": 1.692}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 26, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-44", "timestamp": 1702591304, "time_this_iter_s": 4.7025322914123535, "time_total_s": 123.28282570838928, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 123.28282570838928, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.38333333333333, "ram_util_percent": 77.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.23908716323040824}, "default_policy": {"total_loss": 0.23908716323040824, "policy_loss": -0.00782778706631935, "vf_loss": 9.72664048676806, "vf_loss_unclipped": 4692.50900655718, "vf_explained_var": 0.005952273541167855, "entropy": 3.6623873728424754, "mean_kl_loss": 0.010252383304263419, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 843.2793307091166, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 108000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 4788.992, "sample_time_ms": 2557.264, "synch_weights_time_ms": 1.727}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 27, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-49", "timestamp": 1702591309, "time_this_iter_s": 4.745224952697754, "time_total_s": 128.02805066108704, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 128.02805066108704, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 28.314285714285717, "ram_util_percent": 77.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.18669766901748014}, "default_policy": {"total_loss": 0.18669766901748014, "policy_loss": -0.007940919723298186, "vf_loss": 9.736528043807951, "vf_loss_unclipped": 4781.218158518582, "vf_explained_var": 0.03028494716961501, "entropy": 3.656589808240374, "mean_kl_loss": 0.006664169092046519, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 838.8241853243106, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 4605.504, "sample_time_ms": 2338.552, "synch_weights_time_ms": 1.808}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 28, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-54", "timestamp": 1702591314, "time_this_iter_s": 4.7710161209106445, "time_total_s": 132.79906678199768, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 132.79906678199768, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 27.97142857142857, "ram_util_percent": 77.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.23741766404527337}, "default_policy": {"total_loss": 0.23741766404527337, "policy_loss": -0.005806578513878241, "vf_loss": 9.665396106776907, "vf_loss_unclipped": 3997.381050581617, "vf_explained_var": -0.019583720642366388, "entropy": 3.6118949585631968, "mean_kl_loss": 0.010041492097990722, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 852.3808386726055, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 116000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 4633.158, "sample_time_ms": 2333.227, "synch_weights_time_ms": 1.858}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 29, "trial_id": "0d28b_00000", "date": "2023-12-14_17-01-58", "timestamp": 1702591318, "time_this_iter_s": 4.694695949554443, "time_total_s": 137.49376273155212, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 137.49376273155212, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 26.87142857142857, "ram_util_percent": 77.45714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2456003853570678}, "default_policy": {"total_loss": 0.2456003853570678, "policy_loss": -0.009242222588787328, "vf_loss": 9.503407813846938, "vf_loss_unclipped": 3170.259003807995, "vf_explained_var": -0.12350767081988646, "entropy": 3.6252371039726077, "mean_kl_loss": 0.010948441198861998, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 847.3827589300073, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 120000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 4667.812, "sample_time_ms": 2334.224, "synch_weights_time_ms": 1.929}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 30, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-03", "timestamp": 1702591323, "time_this_iter_s": 4.723082065582275, "time_total_s": 142.2168447971344, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 142.2168447971344, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.51666666666667, "ram_util_percent": 77.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1989137806268389}, "default_policy": {"total_loss": 0.1989137806268389, "policy_loss": -0.01583410332948446, "vf_loss": 9.028026644354945, "vf_loss_unclipped": 1418.7403712730163, "vf_explained_var": -0.07843364034888586, "entropy": 3.5688421909234673, "mean_kl_loss": 0.008527244624824435, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 826.3612595874798, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 124000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 4715.729, "sample_time_ms": 2344.227, "synch_weights_time_ms": 1.981}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 31, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-08", "timestamp": 1702591328, "time_this_iter_s": 4.842156171798706, "time_total_s": 147.0590009689331, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 147.0590009689331, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 29.457142857142856, "ram_util_percent": 77.3142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.182350552150372}, "default_policy": {"total_loss": 0.182350552150372, "policy_loss": -0.003817822186967362, "vf_loss": 8.71049148339961, "vf_loss_unclipped": 226.29245005690976, "vf_explained_var": -0.002848938266351533, "entropy": 3.4641545284023163, "mean_kl_loss": 0.0067868120793695575, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 837.5240697085417, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 128000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 4747.635, "sample_time_ms": 2346.282, "synch_weights_time_ms": 2.008}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 32, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-13", "timestamp": 1702591333, "time_this_iter_s": 4.777704954147339, "time_total_s": 151.83670592308044, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 151.83670592308044, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 27.942857142857143, "ram_util_percent": 77.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21156970476076356}, "default_policy": {"total_loss": 0.21156970476076356, "policy_loss": -0.006569127182859475, "vf_loss": 8.48570444843154, "vf_loss_unclipped": 188.93184582561827, "vf_explained_var": 0.008100427544193227, "entropy": 3.42056663483699, "mean_kl_loss": 0.009131101035821832, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 819.845868810908, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 132000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 4761.695, "sample_time_ms": 2348.354, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 33, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-18", "timestamp": 1702591338, "time_this_iter_s": 4.882358074188232, "time_total_s": 156.71906399726868, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 156.71906399726868, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 28.3, "ram_util_percent": 77.27142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22290460437710988}, "default_policy": {"total_loss": 0.22290460437710988, "policy_loss": -0.0075362148324349355, "vf_loss": 8.61700014264853, "vf_loss_unclipped": 169.65206373169985, "vf_explained_var": 0.01811802952782686, "entropy": 3.348390083577333, "mean_kl_loss": 0.009883956584580213, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 847.49118409871, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 136000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 4761.098, "sample_time_ms": 2348.381, "synch_weights_time_ms": 2.077}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 34, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-22", "timestamp": 1702591342, "time_this_iter_s": 4.721760034561157, "time_total_s": 161.44082403182983, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 161.44082403182983, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 28.04285714285714, "ram_util_percent": 77.12857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2383369794294143}, "default_policy": {"total_loss": 0.2383369794294143, "policy_loss": -0.0033688215630204438, "vf_loss": 8.552670591167296, "vf_loss_unclipped": 146.0776171979111, "vf_explained_var": 0.006408841434572297, "entropy": 3.390931302550505, "mean_kl_loss": 0.010699789638013194, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}}, "episode_reward_max": -142082.91449141712, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -142500.50794751896, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712], "episode_lengths": [35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893677031615387, "mean_inference_ms": 0.7481141698476007, "mean_action_processing_ms": 0.044547976071607875, "mean_env_wait_ms": 0.36972413966763085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004160404205322266, "StateBufferConnector_ms": 0.002944469451904297, "ViewRequirementAgentConnector_ms": 0.1571059226989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 851.3819465810759, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 140000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 4753.853, "sample_time_ms": 2341.893, "synch_weights_time_ms": 2.097}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 35, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-27", "timestamp": 1702591347, "time_this_iter_s": 4.701061248779297, "time_total_s": 166.14188528060913, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 166.14188528060913, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 29.933333333333337, "ram_util_percent": 77.21666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.27429195863605815}, "default_policy": {"total_loss": 0.27429195863605815, "policy_loss": -0.0041647741071153075, "vf_loss": 8.507567303012937, "vf_loss_unclipped": 173.12265313967967, "vf_explained_var": 0.0063982020054798895, "entropy": 3.345701393796437, "mean_kl_loss": 0.013248486698196161, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.596464157104492}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 578.8240215120902, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 144000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 4974.908, "sample_time_ms": 2561.397, "synch_weights_time_ms": 2.099}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 36, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-34", "timestamp": 1702591354, "time_this_iter_s": 6.9122700691223145, "time_total_s": 173.05415534973145, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 173.05415534973145, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.479999999999997, "ram_util_percent": 77.17}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3860177213488929}, "default_policy": {"total_loss": 0.3860177213488929, "policy_loss": -0.0038322952346626056, "vf_loss": 8.469569684091661, "vf_loss_unclipped": 179.75717378628534, "vf_explained_var": 0.02466438802828921, "entropy": 3.3696275364869694, "mean_kl_loss": 0.020906043867579042, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.894695281982422}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 831.0175318814729, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 148000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 4981.908, "sample_time_ms": 2566.507, "synch_weights_time_ms": 2.134}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 37, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-39", "timestamp": 1702591359, "time_this_iter_s": 4.815636873245239, "time_total_s": 177.86979222297668, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 177.86979222297668, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 30.128571428571426, "ram_util_percent": 77.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19163581558556825}, "default_policy": {"total_loss": 0.19163581558556825, "policy_loss": -0.0036905811928800427, "vf_loss": 8.52902816811096, "vf_loss_unclipped": 135.24701675626514, "vf_explained_var": 0.05552097322590061, "entropy": 3.322207037065583, "mean_kl_loss": 0.005025697511479396, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.894695281982422}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 831.1944031021478, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 152000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 4986.285, "sample_time_ms": 2569.845, "synch_weights_time_ms": 2.094}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 38, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-44", "timestamp": 1702591364, "time_this_iter_s": 4.814530849456787, "time_total_s": 182.68432307243347, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 182.68432307243347, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 29.61428571428572, "ram_util_percent": 77.58571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.32505171709080366}, "default_policy": {"total_loss": 0.32505171709080366, "policy_loss": -0.003031095462555348, "vf_loss": 8.582270790010627, "vf_loss_unclipped": 159.05164816232124, "vf_explained_var": 0.08316062368563752, "entropy": 3.342563181797833, "mean_kl_loss": 0.01106478546052982, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.894695281982422}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 834.101417312813, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 156000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 4996.569, "sample_time_ms": 2568.795, "synch_weights_time_ms": 2.144}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 39, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-48", "timestamp": 1702591368, "time_this_iter_s": 4.798129320144653, "time_total_s": 187.48245239257812, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 187.48245239257812, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 28.585714285714285, "ram_util_percent": 77.68571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20688421034347465}, "default_policy": {"total_loss": 0.20688421034347465, "policy_loss": -0.0034055461295878393, "vf_loss": 8.646375900138416, "vf_loss_unclipped": 274.7358025833488, "vf_explained_var": 0.00460299207711779, "entropy": 3.377343452307207, "mean_kl_loss": 0.0056555250899489925, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.894695281982422}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 739.6996594392014, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 160000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 5065.284, "sample_time_ms": 2606.043, "synch_weights_time_ms": 2.099}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 40, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-54", "timestamp": 1702591374, "time_this_iter_s": 5.410291910171509, "time_total_s": 192.89274430274963, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 192.89274430274963, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 42.7875, "ram_util_percent": 77.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20310695880035093}, "default_policy": {"total_loss": 0.20310695880035093, "policy_loss": -0.007279733539934256, "vf_loss": 9.096669113203914, "vf_loss_unclipped": 664.8293053193895, "vf_explained_var": 0.011133389051026626, "entropy": 3.4265650187982426, "mean_kl_loss": 0.00545428923913875, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.894695281982422}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 754.6261468633716, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 164000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 5111.298, "sample_time_ms": 2611.119, "synch_weights_time_ms": 2.08}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 41, "trial_id": "0d28b_00000", "date": "2023-12-14_17-02-59", "timestamp": 1702591379, "time_this_iter_s": 5.3028929233551025, "time_total_s": 198.19563722610474, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 198.19563722610474, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 45.128571428571426, "ram_util_percent": 77.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.206255603573724}, "default_policy": {"total_loss": 1.206255603573724, "policy_loss": 0.010236321474864349, "vf_loss": 9.318257261186774, "vf_loss_unclipped": 2679.211545891345, "vf_explained_var": 0.044124028575954155, "entropy": 3.389716812288329, "mean_kl_loss": 0.050370041688485044, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 32.842041015625}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 765.2857322643769, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 168000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 5156.381, "sample_time_ms": 2650.098, "synch_weights_time_ms": 2.136}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 42, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-04", "timestamp": 1702591384, "time_this_iter_s": 5.228845834732056, "time_total_s": 203.4244830608368, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 203.4244830608368, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 40.5, "ram_util_percent": 77.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24135348127721978}, "default_policy": {"total_loss": 0.24135348127721978, "policy_loss": -0.0016241301511869088, "vf_loss": 9.671528454782612, "vf_loss_unclipped": 4478.594193428055, "vf_explained_var": 0.04273324016569011, "entropy": 3.510690033817088, "mean_kl_loss": 0.004453509060097479, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.4210205078125}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 786.4414127206585, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 172000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 5177.104, "sample_time_ms": 2685.367, "synch_weights_time_ms": 2.11}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 43, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-09", "timestamp": 1702591389, "time_this_iter_s": 5.087892055511475, "time_total_s": 208.51237511634827, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 208.51237511634827, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 38.98571428571428, "ram_util_percent": 77.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21375111137816646}, "default_policy": {"total_loss": 0.21375111137816646, "policy_loss": -0.0102804035667195, "vf_loss": 9.538236119853917, "vf_loss_unclipped": 3183.3684074222915, "vf_explained_var": 0.00662933909562605, "entropy": 3.5067154054702727, "mean_kl_loss": 0.007834418973490527, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.4210205078125}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 847.084893101656, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 176000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 5177.331, "sample_time_ms": 2693.127, "synch_weights_time_ms": 2.092}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 44, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-14", "timestamp": 1702591394, "time_this_iter_s": 4.72493314743042, "time_total_s": 213.2373082637787, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 213.2373082637787, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 28.300000000000004, "ram_util_percent": 77.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3825758614027297}, "default_policy": {"total_loss": 0.3825758614027297, "policy_loss": -0.0004305970340744773, "vf_loss": 9.77349957067575, "vf_loss_unclipped": 5023.412572246625, "vf_explained_var": 0.00442812564784784, "entropy": 3.4846440149522793, "mean_kl_loss": 0.01737233472600305, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.4210205078125}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 804.9494469756154, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 180000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 5204.432, "sample_time_ms": 2700.614, "synch_weights_time_ms": 2.061}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 45, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-19", "timestamp": 1702591399, "time_this_iter_s": 4.971240997314453, "time_total_s": 218.20854926109314, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 218.20854926109314, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 32.628571428571426, "ram_util_percent": 77.75714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3144797870376979}, "default_policy": {"total_loss": 0.3144797870376979, "policy_loss": -0.005692384641633423, "vf_loss": 9.679182412019417, "vf_loss_unclipped": 4093.404523544474, "vf_explained_var": -0.004343045100982763, "entropy": 3.480569971395708, "mean_kl_loss": 0.013603316609559246, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.4210205078125}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 805.7870296326203, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 184000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 5009.784, "sample_time_ms": 2493.415, "synch_weights_time_ms": 2.05}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 46, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-24", "timestamp": 1702591404, "time_this_iter_s": 4.9661760330200195, "time_total_s": 223.17472529411316, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 223.17472529411316, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 35.08571428571428, "ram_util_percent": 77.77142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4793153978836562}, "default_policy": {"total_loss": 0.4793153978836562, "policy_loss": 0.0018586593139956374, "vf_loss": 9.604842625192996, "vf_loss_unclipped": 5132.603295739017, "vf_explained_var": -0.033373625293723556, "entropy": 3.451211068930148, "mean_kl_loss": 0.023226833282353684, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 24.63153076171875}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 850.6560823028191, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 188000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 4998.672, "sample_time_ms": 2486.717, "synch_weights_time_ms": 2.039}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 47, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-29", "timestamp": 1702591409, "time_this_iter_s": 4.704944133758545, "time_total_s": 227.8796694278717, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 227.8796694278717, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.2, "ram_util_percent": 77.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20450815742315132}, "default_policy": {"total_loss": 0.20450815742315132, "policy_loss": -0.0047149825389427484, "vf_loss": 9.271288069072309, "vf_loss_unclipped": 2433.5713438347207, "vf_explained_var": -0.041637274438638426, "entropy": 3.387294330322412, "mean_kl_loss": 0.004730126862601277, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 12.315765380859375}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 848.3473166159605, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 192000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 4988.942, "sample_time_ms": 2481.065, "synch_weights_time_ms": 2.058}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 48, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-34", "timestamp": 1702591414, "time_this_iter_s": 4.716449022293091, "time_total_s": 232.5961184501648, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 232.5961184501648, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 27.599999999999998, "ram_util_percent": 77.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4027516410441827}, "default_policy": {"total_loss": 0.4027516410441827, "policy_loss": -0.0034215367435892698, "vf_loss": 9.089375983931617, "vf_loss_unclipped": 1554.9011436982958, "vf_explained_var": -0.05455190330934423, "entropy": 3.315690803121148, "mean_kl_loss": 0.02559966142039879, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.473648071289062}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 845.6613122919929, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 196000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 4982.386, "sample_time_ms": 2486.488, "synch_weights_time_ms": 2.047}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 49, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-38", "timestamp": 1702591418, "time_this_iter_s": 4.733070135116577, "time_total_s": 237.32918858528137, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 237.32918858528137, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 28.614285714285717, "ram_util_percent": 77.3142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.13673725578266738}, "default_policy": {"total_loss": 0.13673725578266738, "policy_loss": -0.003861740973196241, "vf_loss": 8.442806303882396, "vf_loss_unclipped": 216.4904897523079, "vf_explained_var": 0.02260138675856438, "entropy": 3.2617956354165636, "mean_kl_loss": 0.003040597895716331, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.236824035644531}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 852.8651875252394, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 200000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 4910.636, "sample_time_ms": 2451.974, "synch_weights_time_ms": 2.042}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 50, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-43", "timestamp": 1702591423, "time_this_iter_s": 4.692377090454102, "time_total_s": 242.02156567573547, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 242.02156567573547, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 29.042857142857144, "ram_util_percent": 77.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19223209932795973}, "default_policy": {"total_loss": 0.19223209932795973, "policy_loss": -0.0033161218098398527, "vf_loss": 8.574585337120332, "vf_loss_unclipped": 157.19415114429205, "vf_explained_var": 0.006803907247494533, "entropy": 3.2049737652735923, "mean_kl_loss": 0.011887459516535383, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.236824035644531}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 864.817207460415, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 204000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 4843.098, "sample_time_ms": 2434.954, "synch_weights_time_ms": 2.07}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 51, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-48", "timestamp": 1702591428, "time_this_iter_s": 4.626754999160767, "time_total_s": 246.64832067489624, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 246.64832067489624, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 28.7, "ram_util_percent": 77.58333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.38858169836720935}, "default_policy": {"total_loss": 0.38858169836720935, "policy_loss": -0.0037527417635985975, "vf_loss": 8.505925004162005, "vf_loss_unclipped": 156.67909687261846, "vf_explained_var": 0.005236572421181685, "entropy": 3.1526168350980224, "mean_kl_loss": 0.03326632501175443, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.855236053466797}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}}, "episode_reward_max": -131500.6084504827, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -137041.31872105537, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827], "episode_lengths": [35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1890101287139908, "mean_inference_ms": 0.7458572983365014, "mean_action_processing_ms": 0.04460512180686683, "mean_env_wait_ms": 0.33863693984352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003904104232788086, "StateBufferConnector_ms": 0.002652406692504883, "ViewRequirementAgentConnector_ms": 0.1432955265045166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 858.9375636662569, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 208000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 4786.109, "sample_time_ms": 2390.608, "synch_weights_time_ms": 2.061}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 52, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-52", "timestamp": 1702591432, "time_this_iter_s": 4.6591691970825195, "time_total_s": 251.30748987197876, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 251.30748987197876, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 27.014285714285716, "ram_util_percent": 77.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1747940324191282}, "default_policy": {"total_loss": 0.1747940324191282, "policy_loss": -0.0028385788307531174, "vf_loss": 8.55484978476567, "vf_loss_unclipped": 152.6868471011424, "vf_explained_var": -0.006250969382491448, "entropy": 3.2120024385228594, "mean_kl_loss": 0.006646159935113627, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.855236053466797}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 581.9654701927, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 212000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 4964.815, "sample_time_ms": 2573.455, "synch_weights_time_ms": 2.087}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 53, "trial_id": "0d28b_00000", "date": "2023-12-14_17-03-59", "timestamp": 1702591439, "time_this_iter_s": 6.8757429122924805, "time_total_s": 258.18323278427124, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 258.18323278427124, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 20.72, "ram_util_percent": 77.51}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.862643540975874}, "default_policy": {"total_loss": 0.862643540975874, "policy_loss": 0.006458441937354201, "vf_loss": 8.515678350351005, "vf_loss_unclipped": 147.5484411081017, "vf_explained_var": 0.01349151401377436, "entropy": 3.1162380243161087, "mean_kl_loss": 0.05564887641322129, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 20.782854080200195}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 862.5117342652885, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 216000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 4956.369, "sample_time_ms": 2565.676, "synch_weights_time_ms": 2.063}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 54, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-04", "timestamp": 1702591444, "time_this_iter_s": 4.640152931213379, "time_total_s": 262.8233857154846, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 262.8233857154846, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 29.433333333333337, "ram_util_percent": 77.71666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3087373110078482}, "default_policy": {"total_loss": 0.3087373110078482, "policy_loss": -0.0017979159426968743, "vf_loss": 8.433170931679863, "vf_loss_unclipped": 159.4713003935336, "vf_explained_var": 0.013982098494003068, "entropy": 3.129675892878697, "mean_kl_loss": 0.010884141148390572, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 20.782854080200195}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 844.3204291912796, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 220000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 4933.197, "sample_time_ms": 2565.595, "synch_weights_time_ms": 2.058}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 55, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-09", "timestamp": 1702591449, "time_this_iter_s": 4.739521026611328, "time_total_s": 267.56290674209595, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 267.56290674209595, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 28.099999999999998, "ram_util_percent": 77.45714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17724057935527773}, "default_policy": {"total_loss": 0.17724057935527773, "policy_loss": -0.005553776915592235, "vf_loss": 8.452915810318643, "vf_loss_unclipped": 129.13386274553312, "vf_explained_var": 0.09488013984043715, "entropy": 3.134526004415077, "mean_kl_loss": 0.0047281859195166445, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 859.4782654489832, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 224000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 4902.187, "sample_time_ms": 2547.2, "synch_weights_time_ms": 2.043}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 56, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-13", "timestamp": 1702591453, "time_this_iter_s": 4.65618109703064, "time_total_s": 272.2190878391266, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 272.2190878391266, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 26.74285714285714, "ram_util_percent": 77.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.13997130492118312}, "default_policy": {"total_loss": 0.13997130492118312, "policy_loss": -0.005006644214545168, "vf_loss": 8.560964389142198, "vf_loss_unclipped": 294.1213612261611, "vf_explained_var": -0.0010788028936650454, "entropy": 3.1344086862067932, "mean_kl_loss": 0.005713200616445781, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 854.4042067699802, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 228000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 4900.124, "sample_time_ms": 2544.737, "synch_weights_time_ms": 2.016}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 57, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-18", "timestamp": 1702591458, "time_this_iter_s": 4.68376088142395, "time_total_s": 276.90284872055054, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 276.90284872055054, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 29.333333333333332, "ram_util_percent": 77.58333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17554974501757925}, "default_policy": {"total_loss": 0.17554974501757925, "policy_loss": -0.005732423380148341, "vf_loss": 8.65648436190477, "vf_loss_unclipped": 313.4074898986166, "vf_explained_var": 0.01223237726734137, "entropy": 3.1773994134179055, "mean_kl_loss": 0.009114948715260343, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 851.600574270979, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 232000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 4898.323, "sample_time_ms": 2543.384, "synch_weights_time_ms": 2.018}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 58, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-23", "timestamp": 1702591463, "time_this_iter_s": 4.698735952377319, "time_total_s": 281.60158467292786, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 281.60158467292786, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 27.25714285714286, "ram_util_percent": 77.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2283133449815293}, "default_policy": {"total_loss": 0.2283133449815293, "policy_loss": -0.009480862965636543, "vf_loss": 9.087616675443995, "vf_loss_unclipped": 1479.770853803102, "vf_explained_var": 0.032265579395456864, "entropy": 3.2332203347545696, "mean_kl_loss": 0.014138390016487314, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 846.2166226137322, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 236000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 4898.014, "sample_time_ms": 2542.457, "synch_weights_time_ms": 1.989}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 59, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-27", "timestamp": 1702591467, "time_this_iter_s": 4.728698968887329, "time_total_s": 286.3302836418152, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 286.3302836418152, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 27.828571428571426, "ram_util_percent": 77.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21221183514051728}, "default_policy": {"total_loss": 0.21221183514051728, "policy_loss": -0.009518552698623905, "vf_loss": 9.59130064053322, "vf_loss_unclipped": 3877.637720624521, "vf_explained_var": 0.011007357634969357, "entropy": 3.2505341976690394, "mean_kl_loss": 0.012107805706385493, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 853.9492723913463, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 240000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 4897.419, "sample_time_ms": 2543.521, "synch_weights_time_ms": 2.048}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 60, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-32", "timestamp": 1702591472, "time_this_iter_s": 4.686186075210571, "time_total_s": 291.01646971702576, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 291.01646971702576, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 29.733333333333334, "ram_util_percent": 77.75000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.23325927493605278}, "default_policy": {"total_loss": 0.23325927493605278, "policy_loss": -0.006397185205513719, "vf_loss": 9.540021049442576, "vf_loss_unclipped": 3571.8081770370254, "vf_explained_var": -0.0223648688559339, "entropy": 3.2265760151307976, "mean_kl_loss": 0.013882236703887144, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 840.2739727674002, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 244000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 4910.929, "sample_time_ms": 2553.195, "synch_weights_time_ms": 2.019}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 61, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-37", "timestamp": 1702591477, "time_this_iter_s": 4.762521743774414, "time_total_s": 295.77899146080017, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 295.77899146080017, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 27.699999999999996, "ram_util_percent": 77.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22313854816371698}, "default_policy": {"total_loss": 0.22313854816371698, "policy_loss": -0.005937950650621245, "vf_loss": 9.863465873417315, "vf_loss_unclipped": 4935.795427659936, "vf_explained_var": -0.005473278033962128, "entropy": 3.208033431059262, "mean_kl_loss": 0.012552832298662832, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 742.7487743607682, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 248000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 4983.777, "sample_time_ms": 2602.26, "synch_weights_time_ms": 1.97}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 62, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-42", "timestamp": 1702591482, "time_this_iter_s": 5.38800311088562, "time_total_s": 301.1669945716858, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 301.1669945716858, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 46.7, "ram_util_percent": 78.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20583265763260664}, "default_policy": {"total_loss": 0.20583265763260664, "policy_loss": -0.00675834206043125, "vf_loss": 9.850234344824036, "vf_loss_unclipped": 6857.590484521536, "vf_explained_var": 0.015446020405429767, "entropy": 3.1381880619378486, "mean_kl_loss": 0.010979113443918439, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 757.8643849025167, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 252000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 4824.249, "sample_time_ms": 2426.518, "synch_weights_time_ms": 1.932}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 63, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-48", "timestamp": 1702591488, "time_this_iter_s": 5.280061960220337, "time_total_s": 306.4470565319061, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 306.4470565319061, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 42.974999999999994, "ram_util_percent": 79.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21926398269498526}, "default_policy": {"total_loss": 0.21926398269498526, "policy_loss": -0.008483072809342827, "vf_loss": 9.740241990668942, "vf_loss_unclipped": 6529.562388267598, "vf_explained_var": 0.018290146899375834, "entropy": 3.154640317979906, "mean_kl_loss": 0.012543477887304305, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 825.1321684678156, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 256000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 4845.259, "sample_time_ms": 2433.735, "synch_weights_time_ms": 1.894}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 64, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-53", "timestamp": 1702591493, "time_this_iter_s": 4.849510192871094, "time_total_s": 311.2965667247772, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 311.2965667247772, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 36.083333333333336, "ram_util_percent": 79.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22911751965311036}, "default_policy": {"total_loss": 0.22911751965311036, "policy_loss": -0.008445937163643301, "vf_loss": 9.53354808923278, "vf_loss_unclipped": 3972.6319674998203, "vf_explained_var": 0.009326142288728563, "entropy": 3.2422008923630217, "mean_kl_loss": 0.013687049159312249, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 804.8449922179011, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 260000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 4868.495, "sample_time_ms": 2441.409, "synch_weights_time_ms": 1.923}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 65, "trial_id": "0d28b_00000", "date": "2023-12-14_17-04-57", "timestamp": 1702591497, "time_this_iter_s": 4.971851825714111, "time_total_s": 316.26841855049133, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 316.26841855049133, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 32.875, "ram_util_percent": 79.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17723488856527977}, "default_policy": {"total_loss": 0.17723488856527977, "policy_loss": -0.01569939475022018, "vf_loss": 9.05645541900765, "vf_loss_unclipped": 1599.9306951169012, "vf_explained_var": 0.0121903958351119, "entropy": 3.2166045965162167, "mean_kl_loss": 0.00985136403873425, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 859.0432479721833, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 264000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 4868.731, "sample_time_ms": 2443.068, "synch_weights_time_ms": 1.969}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 66, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-02", "timestamp": 1702591502, "time_this_iter_s": 4.658402681350708, "time_total_s": 320.92682123184204, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 320.92682123184204, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 31.25, "ram_util_percent": 78.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.14932526857741096}, "default_policy": {"total_loss": 0.14932526857741096, "policy_loss": -0.005252456087976504, "vf_loss": 8.74459732519284, "vf_loss_unclipped": 281.3049265042043, "vf_explained_var": -0.006499721869222645, "entropy": 3.164251848070352, "mean_kl_loss": 0.006460301464154435, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 834.3834151559317, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 268000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 4879.964, "sample_time_ms": 2450.641, "synch_weights_time_ms": 2.009}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 67, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-07", "timestamp": 1702591507, "time_this_iter_s": 4.7954630851745605, "time_total_s": 325.7222843170166, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 325.7222843170166, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 30.085714285714282, "ram_util_percent": 78.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20532946997899998}, "default_policy": {"total_loss": 0.20532946997899998, "policy_loss": -0.0037965710053462654, "vf_loss": 8.437741073718204, "vf_loss_unclipped": 222.75055180531322, "vf_explained_var": 0.012417611600493572, "entropy": 3.130255208340789, "mean_kl_loss": 0.012004956844306792, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 844.9644429015212, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 272000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 4883.653, "sample_time_ms": 2456.136, "synch_weights_time_ms": 2.02}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 68, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-12", "timestamp": 1702591512, "time_this_iter_s": 4.735205888748169, "time_total_s": 330.45749020576477, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 330.45749020576477, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 29.271428571428572, "ram_util_percent": 78.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1809535395266659}, "default_policy": {"total_loss": 0.1809535395266659, "policy_loss": -0.005668234437017012, "vf_loss": 8.498573226461025, "vf_loss_unclipped": 193.2085368760359, "vf_explained_var": 0.033068614473729246, "entropy": 3.080854009463589, "mean_kl_loss": 0.009780758831568634, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 810.3438674103811, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 276000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 4904.579, "sample_time_ms": 2459.021, "synch_weights_time_ms": 2.034}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 69, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-17", "timestamp": 1702591517, "time_this_iter_s": 4.937808990478516, "time_total_s": 335.3952991962433, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 335.3952991962433, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 33.385714285714286, "ram_util_percent": 78.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2410292094116653}, "default_policy": {"total_loss": 0.2410292094116653, "policy_loss": -0.002161665466616053, "vf_loss": 8.518765846040965, "vf_loss_unclipped": 140.2556706491564, "vf_explained_var": -0.005295807936552491, "entropy": 3.1163921343492293, "mean_kl_loss": 0.015205150978706089, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}}, "episode_reward_max": -126142.6957084097, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -133481.79707308192, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1894174601721567, "mean_inference_ms": 0.7465619266767725, "mean_action_processing_ms": 0.04472458877061372, "mean_env_wait_ms": 0.3238987732424506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040849049886067705, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.15068451563517252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 793.9236496337999, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 280000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 4939.992, "sample_time_ms": 2472.271, "synch_weights_time_ms": 1.993}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 70, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-22", "timestamp": 1702591522, "time_this_iter_s": 5.04053807258606, "time_total_s": 340.43583726882935, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 340.43583726882935, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 38.300000000000004, "ram_util_percent": 79.75714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.16894766389291044}, "default_policy": {"total_loss": 0.16894766389291044, "policy_loss": -0.00631278580420021, "vf_loss": 8.48915850938256, "vf_loss_unclipped": 132.2979451689893, "vf_explained_var": 0.005403656186833819, "entropy": 3.0691069334046417, "mean_kl_loss": 0.008696482791574046, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.391427040100098}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 578.1971310115383, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 284000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 5155.763, "sample_time_ms": 2687.657, "synch_weights_time_ms": 1.998}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 71, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-29", "timestamp": 1702591529, "time_this_iter_s": 6.920250177383423, "time_total_s": 347.35608744621277, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 347.35608744621277, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 26.559999999999995, "ram_util_percent": 78.99000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3188302462249359}, "default_policy": {"total_loss": 0.3188302462249359, "policy_loss": -0.0012348105655367505, "vf_loss": 8.40928514476524, "vf_loss_unclipped": 133.96385094453532, "vf_explained_var": 0.0025054509960003753, "entropy": 3.066139911283562, "mean_kl_loss": 0.02270835417056505, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.587141036987305}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 855.3359823239297, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 288000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 5084.875, "sample_time_ms": 2640.699, "synch_weights_time_ms": 2.019}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 72, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-33", "timestamp": 1702591533, "time_this_iter_s": 4.678699016571045, "time_total_s": 352.0347864627838, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 352.0347864627838, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 29.1, "ram_util_percent": 79.05714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.18821853715608686}, "default_policy": {"total_loss": 0.18821853715608686, "policy_loss": -0.00410622421072236, "vf_loss": 8.39902263358712, "vf_loss_unclipped": 157.45901711714038, "vf_explained_var": 0.03142321630835787, "entropy": 3.0496670653316764, "mean_kl_loss": 0.006950250617417717, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.587141036987305}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 849.9130265009672, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 292000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 5027.713, "sample_time_ms": 2599.424, "synch_weights_time_ms": 2.059}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 73, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-38", "timestamp": 1702591538, "time_this_iter_s": 4.707848310470581, "time_total_s": 356.7426347732544, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 356.7426347732544, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 30.05, "ram_util_percent": 78.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.28324682343361984}, "default_policy": {"total_loss": 0.28324682343361984, "policy_loss": -0.00324274560531923, "vf_loss": 8.612262594166086, "vf_loss_unclipped": 197.74289971780675, "vf_explained_var": 0.053444402494918566, "entropy": 3.0481442576532425, "mean_kl_loss": 0.012854630961228084, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.587141036987305}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 851.7585106597396, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 296000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 5012.558, "sample_time_ms": 2597.045, "synch_weights_time_ms": 2.087}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 74, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-43", "timestamp": 1702591543, "time_this_iter_s": 4.6981751918792725, "time_total_s": 361.44080996513367, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 361.44080996513367, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 27.185714285714287, "ram_util_percent": 78.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.23137023683581778}, "default_policy": {"total_loss": 0.23137023683581778, "policy_loss": -0.0010512409421966783, "vf_loss": 8.69194120791421, "vf_loss_unclipped": 281.1685083385215, "vf_explained_var": -0.0005674403486475507, "entropy": 3.0659583392682106, "mean_kl_loss": 0.009334750117241108, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.587141036987305}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 853.5689886713923, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 300000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 4984.189, "sample_time_ms": 2583.417, "synch_weights_time_ms": 2.037}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 75, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-47", "timestamp": 1702591547, "time_this_iter_s": 4.688557147979736, "time_total_s": 366.1293671131134, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 366.1293671131134, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 28.114285714285717, "ram_util_percent": 78.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1685386351081354}, "default_policy": {"total_loss": 0.1685386351081354, "policy_loss": -0.008372264020621523, "vf_loss": 9.227783993617305, "vf_loss_unclipped": 1034.865101934242, "vf_explained_var": 0.03640179911147811, "entropy": 3.1079367462760095, "mean_kl_loss": 0.0054296721843703185, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.587141036987305}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 814.8740849480604, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 304000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 5009.428, "sample_time_ms": 2588.299, "synch_weights_time_ms": 2.012}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 76, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-52", "timestamp": 1702591552, "time_this_iter_s": 4.910704851150513, "time_total_s": 371.0400719642639, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 371.0400719642639, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 31.957142857142856, "ram_util_percent": 78.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.4044675500090442}, "default_policy": {"total_loss": 1.4044675500090442, "policy_loss": 0.020196433744774554, "vf_loss": 9.213747478497307, "vf_loss_unclipped": 2862.932999421793, "vf_explained_var": 0.06004858493550754, "entropy": 3.0321838888786496, "mean_kl_loss": 0.0828974115925014, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 23.38071060180664}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 841.3880351718439, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 308000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 5005.436, "sample_time_ms": 2580.77, "synch_weights_time_ms": 1.959}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 77, "trial_id": "0d28b_00000", "date": "2023-12-14_17-05-57", "timestamp": 1702591557, "time_this_iter_s": 4.755750894546509, "time_total_s": 375.7958228588104, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 375.7958228588104, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 34.61666666666666, "ram_util_percent": 78.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21692074579534246}, "default_policy": {"total_loss": 0.21692074579534246, "policy_loss": -0.0024796079611902173, "vf_loss": 9.810738203113775, "vf_loss_unclipped": 5524.5679125918, "vf_explained_var": 0.02871013513760272, "entropy": 3.240526307366296, "mean_kl_loss": 0.0051877368670116405, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 23.38071060180664}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 820.3477257512671, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 312000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 5019.642, "sample_time_ms": 2587.458, "synch_weights_time_ms": 1.947}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 78, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-02", "timestamp": 1702591562, "time_this_iter_s": 4.877782821655273, "time_total_s": 380.6736056804657, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 380.6736056804657, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 33.114285714285714, "ram_util_percent": 78.95714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19495929280387314}, "default_policy": {"total_loss": 0.19495929280387314, "policy_loss": -0.004833689775627687, "vf_loss": 9.6709216012121, "vf_loss_unclipped": 3499.291025759569, "vf_explained_var": 0.0005899930813673463, "entropy": 3.238777180724561, "mean_kl_loss": 0.004408923613627771, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 11.69035530090332}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 792.0942486067474, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 316000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 5031.015, "sample_time_ms": 2596.162, "synch_weights_time_ms": 2.005}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 79, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-07", "timestamp": 1702591567, "time_this_iter_s": 5.051725149154663, "time_total_s": 385.72533082962036, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 385.72533082962036, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 33.975, "ram_util_percent": 78.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3186450559796809}, "default_policy": {"total_loss": 0.3186450559796809, "policy_loss": -0.0016135885432334756, "vf_loss": 9.732456278445115, "vf_loss_unclipped": 4468.126221825573, "vf_explained_var": 0.006561223949704852, "entropy": 3.2354018718703217, "mean_kl_loss": 0.019069914938127635, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 11.69035530090332}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 808.1270027703414, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 320000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 5022.161, "sample_time_ms": 2586.463, "synch_weights_time_ms": 2.059}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 80, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-12", "timestamp": 1702591572, "time_this_iter_s": 4.951449155807495, "time_total_s": 390.67677998542786, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 390.67677998542786, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 34.98571428571429, "ram_util_percent": 78.88571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3829393121860683}, "default_policy": {"total_loss": 0.3829393121860683, "policy_loss": 0.0011911368830802677, "vf_loss": 9.687985369391534, "vf_loss_unclipped": 3023.086816035354, "vf_explained_var": 0.008638195264568207, "entropy": 3.2371694502800006, "mean_kl_loss": 0.024367806753738775, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.535533905029297}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 778.9807810545695, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 324000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 4843.846, "sample_time_ms": 2384.637, "synch_weights_time_ms": 2.111}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 81, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-17", "timestamp": 1702591577, "time_this_iter_s": 5.13724422454834, "time_total_s": 395.8140242099762, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 395.8140242099762, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 36.614285714285714, "ram_util_percent": 79.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.44539652888708786}, "default_policy": {"total_loss": 0.44539652888708786, "policy_loss": 8.855424404366693e-05, "vf_loss": 9.756654574672805, "vf_loss_unclipped": 3688.0535625465895, "vf_explained_var": -0.01145779914947461, "entropy": 3.2017930979921876, "mean_kl_loss": 0.019830672325360576, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.535533905029297}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 789.6751340823062, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 328000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 4882.731, "sample_time_ms": 2402.805, "synch_weights_time_ms": 2.132}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 82, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-22", "timestamp": 1702591582, "time_this_iter_s": 5.068034887313843, "time_total_s": 400.88205909729004, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 400.88205909729004, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 36.25714285714286, "ram_util_percent": 79.34285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19137398846574558}, "default_policy": {"total_loss": 0.19137398846574558, "policy_loss": -0.006763909536320518, "vf_loss": 9.337759344308362, "vf_loss_unclipped": 1982.5699713977415, "vf_explained_var": -0.035559464174547174, "entropy": 3.1444120119883814, "mean_kl_loss": 0.005974172375137373, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.535533905029297}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 777.58064161048, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 332000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 4926.511, "sample_time_ms": 2426.366, "synch_weights_time_ms": 2.079}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 83, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-27", "timestamp": 1702591587, "time_this_iter_s": 5.146284103393555, "time_total_s": 406.0283432006836, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 406.0283432006836, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 34.725, "ram_util_percent": 78.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.948139547856886}, "default_policy": {"total_loss": 0.948139547856886, "policy_loss": 0.004108134681966576, "vf_loss": 9.058975717914638, "vf_loss_unclipped": 1413.2519052013406, "vf_explained_var": -0.05899806196755692, "entropy": 3.079611637953248, "mean_kl_loss": 0.04866927155881698, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 26.303300857543945}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 807.0541114709357, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 336000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 4952.523, "sample_time_ms": 2430.303, "synch_weights_time_ms": 2.08}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 84, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-32", "timestamp": 1702591592, "time_this_iter_s": 4.9586570262908936, "time_total_s": 410.9870002269745, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 410.9870002269745, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 32.77142857142857, "ram_util_percent": 78.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.184680827974733}, "default_policy": {"total_loss": 0.184680827974733, "policy_loss": -0.0033604507304743915, "vf_loss": 8.51407838376092, "vf_loss_unclipped": 307.94589601040906, "vf_explained_var": -0.011926089713314195, "entropy": 2.998656024302501, "mean_kl_loss": 0.003912075437783603, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.151650428771973}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 760.6114517404436, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 340000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 5009.795, "sample_time_ms": 2456.891, "synch_weights_time_ms": 2.124}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 85, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-38", "timestamp": 1702591598, "time_this_iter_s": 5.261003017425537, "time_total_s": 416.2480032444, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 416.2480032444, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 39.42857142857143, "ram_util_percent": 78.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.270231298319916}, "default_policy": {"total_loss": 0.270231298319916, "policy_loss": -0.0005774541325104643, "vf_loss": 8.550341966055603, "vf_loss_unclipped": 264.844116942969, "vf_explained_var": 0.023058077673922216, "entropy": 2.9851279210434285, "mean_kl_loss": 0.014089892151764082, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.151650428771973}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 823.087965320562, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 344000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 5004.897, "sample_time_ms": 2466.775, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 86, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-43", "timestamp": 1702591603, "time_this_iter_s": 4.862019062042236, "time_total_s": 421.11002230644226, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 421.11002230644226, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 78.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2858621214252354}, "default_policy": {"total_loss": 0.2858621214252354, "policy_loss": -0.0016982268516236405, "vf_loss": 8.486045197383174, "vf_loss_unclipped": 196.26624363165166, "vf_explained_var": 0.020084719413887463, "entropy": 2.953053642437656, "mean_kl_loss": 0.015412506456332674, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.151650428771973}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}}, "episode_reward_max": -122433.15920061221, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -130767.73709420506, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18971601067602117, "mean_inference_ms": 0.7467562789702424, "mean_action_processing_ms": 0.04480296637354979, "mean_env_wait_ms": 0.3139728903797627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040590763092041016, "StateBufferConnector_ms": 0.0027954578399658203, "ViewRequirementAgentConnector_ms": 0.1513957977294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 720.8091622055798, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 348000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 5084.424, "sample_time_ms": 2498.541, "synch_weights_time_ms": 2.135}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 87, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-48", "timestamp": 1702591608, "time_this_iter_s": 5.550626039505005, "time_total_s": 426.66064834594727, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 426.66064834594727, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 38.6375, "ram_util_percent": 79.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19394840350124373}, "default_policy": {"total_loss": 0.19394840350124373, "policy_loss": -0.0001198984672631155, "vf_loss": 8.468725462712204, "vf_loss_unclipped": 163.83599535895308, "vf_explained_var": -0.031204720422911492, "entropy": 3.018918309130394, "mean_kl_loss": 0.00831690668197312, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.151650428771973}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 561.4157198259417, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 352000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 5309.309, "sample_time_ms": 2715.744, "synch_weights_time_ms": 2.165}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 88, "trial_id": "0d28b_00000", "date": "2023-12-14_17-06-55", "timestamp": 1702591615, "time_this_iter_s": 7.127134799957275, "time_total_s": 433.78778314590454, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 433.78778314590454, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 28.140000000000004, "ram_util_percent": 79.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7333963790507332}, "default_policy": {"total_loss": 0.7333963790507332, "policy_loss": 0.015742934604328292, "vf_loss": 8.479638775274443, "vf_loss_unclipped": 153.2454000403886, "vf_explained_var": 0.018700213002751886, "entropy": 3.027689572844678, "mean_kl_loss": 0.048119972598703785, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.727476119995117}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 829.2874640506263, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 356000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 5286.66, "sample_time_ms": 2712.118, "synch_weights_time_ms": 2.108}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 89, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-00", "timestamp": 1702591620, "time_this_iter_s": 4.8253538608551025, "time_total_s": 438.61313700675964, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 438.61313700675964, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 33.57142857142857, "ram_util_percent": 79.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3292394218021142}, "default_policy": {"total_loss": 0.3292394218021142, "policy_loss": 0.0036586702365412325, "vf_loss": 8.457687821215403, "vf_loss_unclipped": 139.8430257646768, "vf_explained_var": 0.04667999304688053, "entropy": 2.9671423315747716, "mean_kl_loss": 0.012216660301663665, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.727476119995117}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 716.8778659576574, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 360000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 5349.663, "sample_time_ms": 2760.516, "synch_weights_time_ms": 2.091}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 90, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-06", "timestamp": 1702591626, "time_this_iter_s": 5.581815958023071, "time_total_s": 444.1949529647827, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 444.1949529647827, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 42.075, "ram_util_percent": 80.03750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.36315156950224153}, "default_policy": {"total_loss": 0.36315156950224153, "policy_loss": -0.0011663413378221394, "vf_loss": 8.629752211479236, "vf_loss_unclipped": 162.95431227775524, "vf_explained_var": 0.029005443554188905, "entropy": 3.0415623815837445, "mean_kl_loss": 0.01409305419245721, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.727476119995117}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 811.851397056468, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 364000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 5328.873, "sample_time_ms": 2766.533, "synch_weights_time_ms": 2.012}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 91, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-11", "timestamp": 1702591631, "time_this_iter_s": 4.928889751434326, "time_total_s": 449.12384271621704, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 449.12384271621704, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 35.42857142857143, "ram_util_percent": 79.68571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.14012175522593737}, "default_policy": {"total_loss": 0.14012175522593737, "policy_loss": -0.004018408332719033, "vf_loss": 8.604859201130328, "vf_loss_unclipped": 222.06611165614015, "vf_explained_var": 0.08924412848090311, "entropy": 2.922112909715567, "mean_kl_loss": 0.0029447037151514263, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 858.1383195589849, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 368000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 5288.461, "sample_time_ms": 2752.162, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 92, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-15", "timestamp": 1702591635, "time_this_iter_s": 4.662928819656372, "time_total_s": 453.7867715358734, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 453.7867715358734, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 29.14285714285714, "ram_util_percent": 79.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.15786178184967084}, "default_policy": {"total_loss": 0.15786178184967084, "policy_loss": -0.0037498474279954743, "vf_loss": 8.849433159268996, "vf_loss_unclipped": 356.7934439360206, "vf_explained_var": 0.06494051332412752, "entropy": 2.9320554491807655, "mean_kl_loss": 0.007412737575715606, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 865.4535478934445, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 372000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 5236.231, "sample_time_ms": 2720.983, "synch_weights_time_ms": 1.996}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 93, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-20", "timestamp": 1702591640, "time_this_iter_s": 4.624204158782959, "time_total_s": 458.4109756946564, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 458.4109756946564, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 28.816666666666666, "ram_util_percent": 79.28333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2056425702986496}, "default_policy": {"total_loss": 0.2056425702986496, "policy_loss": -0.010285414405353764, "vf_loss": 9.303970822393259, "vf_loss_unclipped": 1989.1906132647223, "vf_explained_var": 0.04961566871671534, "entropy": 2.909453837093768, "mean_kl_loss": 0.012458591198455344, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 862.5470758683597, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 376000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 5204.345, "sample_time_ms": 2713.566, "synch_weights_time_ms": 1.988}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 94, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-25", "timestamp": 1702591645, "time_this_iter_s": 4.638936758041382, "time_total_s": 463.04991245269775, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 463.04991245269775, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 27.61428571428571, "ram_util_percent": 79.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22295863356099707}, "default_policy": {"total_loss": 0.22295863356099707, "policy_loss": -0.007169509212226311, "vf_loss": 9.576183948435508, "vf_loss_unclipped": 5936.817924710987, "vf_explained_var": 0.03314203278088112, "entropy": 2.9694789467589944, "mean_kl_loss": 0.013622249810941092, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 831.1726195041109, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 380000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 5159.7, "sample_time_ms": 2697.474, "synch_weights_time_ms": 1.932}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 95, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-29", "timestamp": 1702591649, "time_this_iter_s": 4.814510822296143, "time_total_s": 467.8644232749939, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 467.8644232749939, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 31.757142857142856, "ram_util_percent": 79.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22089622104202888}, "default_policy": {"total_loss": 0.22089622104202888, "policy_loss": -0.006313152574394931, "vf_loss": 9.54336407850546, "vf_loss_unclipped": 3406.755307659157, "vf_explained_var": 0.009271531471057233, "entropy": 2.925339802750138, "mean_kl_loss": 0.013359613935230113, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 855.4058024084434, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 384000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 5141.339, "sample_time_ms": 2687.586, "synch_weights_time_ms": 1.918}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 96, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-34", "timestamp": 1702591654, "time_this_iter_s": 4.6780760288238525, "time_total_s": 472.54249930381775, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 472.54249930381775, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 32.6, "ram_util_percent": 79.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.274346092568913}, "default_policy": {"total_loss": 0.274346092568913, "policy_loss": 0.0004656597498311862, "vf_loss": 9.820578371792205, "vf_loss_unclipped": 5897.963803061544, "vf_explained_var": 0.013608830696992529, "entropy": 2.9362637907711426, "mean_kl_loss": 0.017810149285465114, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 849.051584090627, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 388000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 5057.522, "sample_time_ms": 2662.644, "synch_weights_time_ms": 1.875}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 97, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-39", "timestamp": 1702591659, "time_this_iter_s": 4.712736129760742, "time_total_s": 477.2552354335785, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 477.2552354335785, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 29.971428571428568, "ram_util_percent": 79.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.16767501080436492}, "default_policy": {"total_loss": 0.16767501080436492, "policy_loss": -0.0067263126322654075, "vf_loss": 9.818599844283895, "vf_loss_unclipped": 7349.100880474424, "vf_explained_var": 0.024111199417093925, "entropy": 2.8869653754651163, "mean_kl_loss": 0.0077268195190763065, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 832.0042116912418, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 392000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 4825.805, "sample_time_ms": 2439.798, "synch_weights_time_ms": 1.857}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 98, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-44", "timestamp": 1702591664, "time_this_iter_s": 4.809821844100952, "time_total_s": 482.06505727767944, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 482.06505727767944, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 31.514285714285716, "ram_util_percent": 79.11428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24492694502438245}, "default_policy": {"total_loss": 0.24492694502438245, "policy_loss": -0.0030431667306045416, "vf_loss": 9.806218526002441, "vf_loss_unclipped": 8306.687714607222, "vf_explained_var": 0.018209542801131063, "entropy": 2.8715000111919475, "mean_kl_loss": 0.015197881597580221, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 846.6947158542339, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 396000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 4815.889, "sample_time_ms": 2433.727, "synch_weights_time_ms": 1.852}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 99, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-48", "timestamp": 1702591668, "time_this_iter_s": 4.726294040679932, "time_total_s": 486.7913513183594, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 486.7913513183594, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 30.799999999999994, "ram_util_percent": 79.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.18268741591414536}, "default_policy": {"total_loss": 0.18268741591414536, "policy_loss": -0.009853716411474926, "vf_loss": 9.55056445227503, "vf_loss_unclipped": 4485.614884431428, "vf_explained_var": 0.02127325306060726, "entropy": 2.841118403843471, "mean_kl_loss": 0.009837597883127026, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 863.8887365590359, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 400000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 4720.936, "sample_time_ms": 2377.592, "synch_weights_time_ms": 1.827}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 100, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-53", "timestamp": 1702591673, "time_this_iter_s": 4.631953239440918, "time_total_s": 491.4233045578003, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 491.4233045578003, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 31.75, "ram_util_percent": 79.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21259303729750836}, "default_policy": {"total_loss": 0.21259303729750836, "policy_loss": -0.005530865781052884, "vf_loss": 9.12202179253991, "vf_loss_unclipped": 1903.722361611405, "vf_explained_var": 0.025554582444843706, "entropy": 2.806299047683602, "mean_kl_loss": 0.012865679609927681, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 856.8613140550107, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 404000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 4695.055, "sample_time_ms": 2356.093, "synch_weights_time_ms": 1.83}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 101, "trial_id": "0d28b_00000", "date": "2023-12-14_17-07-58", "timestamp": 1702591678, "time_this_iter_s": 4.6699090003967285, "time_total_s": 496.093213558197, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 496.093213558197, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 29.814285714285713, "ram_util_percent": 79.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1377421624140381}, "default_policy": {"total_loss": 0.1377421624140381, "policy_loss": -0.002310704076483941, "vf_loss": 8.776622047810667, "vf_loss_unclipped": 251.0903033030821, "vf_explained_var": 0.019250313102055206, "entropy": 2.7334011297490295, "mean_kl_loss": 0.0053008958447399975, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 845.0891918528748, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 408000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 4702.252, "sample_time_ms": 2349.169, "synch_weights_time_ms": 1.801}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 102, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-03", "timestamp": 1702591683, "time_this_iter_s": 4.734858989715576, "time_total_s": 500.8280725479126, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 500.8280725479126, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 31.300000000000004, "ram_util_percent": 79.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.16070983612905942}, "default_policy": {"total_loss": 0.16070983612905942, "policy_loss": -0.004882211383404349, "vf_loss": 8.679849619041882, "vf_loss_unclipped": 287.211350325074, "vf_explained_var": 0.019098992985703035, "entropy": 2.6592683479475823, "mean_kl_loss": 0.007988204042618402, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 804.4265955917588, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 412000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 4737.315, "sample_time_ms": 2372.728, "synch_weights_time_ms": 1.823}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 103, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-08", "timestamp": 1702591688, "time_this_iter_s": 4.974523067474365, "time_total_s": 505.80259561538696, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 505.80259561538696, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 36.22857142857143, "ram_util_percent": 80.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.16920224595060354}, "default_policy": {"total_loss": 0.16920224595060354, "policy_loss": -0.004015530069876931, "vf_loss": 8.579933473042079, "vf_loss_unclipped": 183.19043631645152, "vf_explained_var": 0.02253314770106822, "entropy": 2.6107546070745506, "mean_kl_loss": 0.008862607914380942, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 860.9362382728006, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 416000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 4738.183, "sample_time_ms": 2374.828, "synch_weights_time_ms": 1.841}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 104, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-12", "timestamp": 1702591692, "time_this_iter_s": 4.647634267807007, "time_total_s": 510.45022988319397, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 510.45022988319397, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 30.299999999999997, "ram_util_percent": 79.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.26320889086397026}, "default_policy": {"total_loss": 0.26320889086397026, "policy_loss": -0.0016922293551591859, "vf_loss": 8.608207852093141, "vf_loss_unclipped": 165.14318287245501, "vf_explained_var": 0.009558714274912755, "entropy": 2.6380315574247444, "mean_kl_loss": 0.018128932569967657, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -129046.32574574146, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19004270464767464, "mean_inference_ms": 0.7477783560404141, "mean_action_processing_ms": 0.04489480946596407, "mean_env_wait_ms": 0.3070324701779097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931522369384766, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.15371322631835938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 866.1709536250597, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 420000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 4718.738, "sample_time_ms": 2364.664, "synch_weights_time_ms": 1.848}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 105, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-17", "timestamp": 1702591697, "time_this_iter_s": 4.619359970092773, "time_total_s": 515.0695898532867, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 515.0695898532867, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 27.114285714285717, "ram_util_percent": 79.37142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.18910443944646033}, "default_policy": {"total_loss": 0.18910443944646033, "policy_loss": -0.0013708657732030857, "vf_loss": 8.470077503972979, "vf_loss_unclipped": 180.2548900840125, "vf_explained_var": 0.00315165138447971, "entropy": 2.656103998104901, "mean_kl_loss": 0.010723574602065349, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 590.5372559726934, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 424000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 4928.473, "sample_time_ms": 2577.37, "synch_weights_time_ms": 1.851}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 106, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-24", "timestamp": 1702591704, "time_this_iter_s": 6.77574896812439, "time_total_s": 521.8453388214111, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 521.8453388214111, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 20.300000000000004, "ram_util_percent": 79.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24803123597714946}, "default_policy": {"total_loss": 0.24803123597714946, "policy_loss": -0.002269514149297148, "vf_loss": 8.561577485822665, "vf_loss_unclipped": 142.03936518687428, "vf_explained_var": 0.012942061050614314, "entropy": 2.6144940400682786, "mean_kl_loss": 0.01669600047758312, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 887.8849690159814, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 428000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 4907.868, "sample_time_ms": 2559.543, "synch_weights_time_ms": 1.889}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 107, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-28", "timestamp": 1702591708, "time_this_iter_s": 4.506980657577515, "time_total_s": 526.3523194789886, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 526.3523194789886, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 28.2, "ram_util_percent": 79.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.16811698228359095}, "default_policy": {"total_loss": 0.16811698228359095, "policy_loss": -0.00500536439165886, "vf_loss": 8.454357210761195, "vf_loss_unclipped": 162.57094767556262, "vf_explained_var": 0.07949175610979482, "entropy": 2.6900426942402365, "mean_kl_loss": 0.008980244039477513, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 870.6008614981998, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 432000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 4886.554, "sample_time_ms": 2549.562, "synch_weights_time_ms": 1.845}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 108, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-33", "timestamp": 1702591713, "time_this_iter_s": 4.596197843551636, "time_total_s": 530.9485173225403, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 530.9485173225403, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 26.52857142857143, "ram_util_percent": 79.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1760610029466752}, "default_policy": {"total_loss": 0.1760610029466752, "policy_loss": -0.0025095839171545274, "vf_loss": 8.49550267323248, "vf_loss_unclipped": 188.3447717898436, "vf_explained_var": 0.09555968864640194, "entropy": 2.6712061868293455, "mean_kl_loss": 0.009490880697963078, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 833.953442664314, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 436000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 4893.772, "sample_time_ms": 2546.343, "synch_weights_time_ms": 1.856}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 109, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-38", "timestamp": 1702591718, "time_this_iter_s": 4.798631191253662, "time_total_s": 535.747148513794, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 535.747148513794, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 30.4, "ram_util_percent": 79.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.15723735342290737}, "default_policy": {"total_loss": 0.15723735342290737, "policy_loss": -0.0016100469267746405, "vf_loss": 8.646520394506231, "vf_loss_unclipped": 253.40776850978958, "vf_explained_var": -0.006509245268063251, "entropy": 2.774584225500062, "mean_kl_loss": 0.007338211800269841, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 801.9564483552336, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 440000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 4929.529, "sample_time_ms": 2577.973, "synch_weights_time_ms": 1.863}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 110, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-43", "timestamp": 1702591723, "time_this_iter_s": 4.9893717765808105, "time_total_s": 540.7365202903748, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 540.7365202903748, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 35.27142857142857, "ram_util_percent": 80.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.16161625748917238}, "default_policy": {"total_loss": 0.16161625748917238, "policy_loss": -0.005264351170247933, "vf_loss": 9.122001444607147, "vf_loss_unclipped": 602.6101011996076, "vf_explained_var": 0.005685297855690344, "entropy": 2.761334535918002, "mean_kl_loss": 0.007670580317245621, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.863738059997559}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 817.1881131906647, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 444000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 4952.193, "sample_time_ms": 2577.514, "synch_weights_time_ms": 1.88}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 111, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-47", "timestamp": 1702591727, "time_this_iter_s": 4.896751165390015, "time_total_s": 545.6332714557648, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 545.6332714557648, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 34.01428571428571, "ram_util_percent": 80.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.9159664900770892}, "default_policy": {"total_loss": 0.9159664900770892, "policy_loss": 0.022614014674542045, "vf_loss": 9.08856340156181, "vf_loss_unclipped": 1866.4522830824862, "vf_explained_var": 0.03420490350550426, "entropy": 2.6775347402355054, "mean_kl_loss": 0.08135524691952518, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.79560661315918}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 831.7962710900055, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 4959.757, "sample_time_ms": 2590.084, "synch_weights_time_ms": 1.869}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 112, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-52", "timestamp": 1702591732, "time_this_iter_s": 4.810977935791016, "time_total_s": 550.4442493915558, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 550.4442493915558, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 34.01666666666666, "ram_util_percent": 79.88333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20933393352249982}, "default_policy": {"total_loss": 0.20933393352249982, "policy_loss": -0.0010571562338060438, "vf_loss": 9.813122842865967, "vf_loss_unclipped": 4889.098490082633, "vf_explained_var": 0.02304158345468517, "entropy": 2.746666451252854, "mean_kl_loss": 0.007587378153046007, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.79560661315918}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 848.3077673744234, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 452000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 4934.036, "sample_time_ms": 2574.668, "synch_weights_time_ms": 1.876}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 113, "trial_id": "0d28b_00000", "date": "2023-12-14_17-08-57", "timestamp": 1702591737, "time_this_iter_s": 4.717552185058594, "time_total_s": 555.1618015766144, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 555.1618015766144, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 28.942857142857143, "ram_util_percent": 79.48571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.16525672403162223}, "default_policy": {"total_loss": 0.16525672403162223, "policy_loss": -0.007469895168709983, "vf_loss": 9.73427512650805, "vf_loss_unclipped": 4042.3714369426148, "vf_explained_var": -0.0033274832437795872, "entropy": 2.7559916800273254, "mean_kl_loss": 0.005095016822967559, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.79560661315918}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 829.177376386477, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 456000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 4951.831, "sample_time_ms": 2577.379, "synch_weights_time_ms": 1.83}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 114, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-02", "timestamp": 1702591742, "time_this_iter_s": 4.82616400718689, "time_total_s": 559.9879655838013, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 559.9879655838013, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 30.22857142857143, "ram_util_percent": 79.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5405628734361579}, "default_policy": {"total_loss": 0.5405628734361579, "policy_loss": 0.008748539658918628, "vf_loss": 9.921192668394239, "vf_loss_unclipped": 8586.634291593962, "vf_explained_var": 0.0035376320642703124, "entropy": 2.6302153074156753, "mean_kl_loss": 0.029238571836895315, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.193408966064453}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 840.573131526232, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 460000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 4965.895, "sample_time_ms": 2586.086, "synch_weights_time_ms": 1.854}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 115, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-07", "timestamp": 1702591747, "time_this_iter_s": 4.760632038116455, "time_total_s": 564.7485976219177, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 564.7485976219177, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 29.300000000000004, "ram_util_percent": 79.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2523916753719865}, "default_policy": {"total_loss": 0.2523916753719865, "policy_loss": -0.0010679945149131293, "vf_loss": 9.790379735706711, "vf_loss_unclipped": 5694.642180696987, "vf_explained_var": 0.021761063383078014, "entropy": 2.671318586701269, "mean_kl_loss": 0.007009102179326176, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.193408966064453}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 835.1651108678984, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 464000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 4767.491, "sample_time_ms": 2377.633, "synch_weights_time_ms": 1.937}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 116, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-11", "timestamp": 1702591751, "time_this_iter_s": 4.791686773300171, "time_total_s": 569.5402843952179, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 569.5402843952179, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 32.142857142857146, "ram_util_percent": 79.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19987314781829366}, "default_policy": {"total_loss": 0.19987314781829366, "policy_loss": -0.0011925383119472564, "vf_loss": 9.60712324785017, "vf_loss_unclipped": 5788.994925517263, "vf_explained_var": 0.006942435686013846, "entropy": 2.6436265455380177, "mean_kl_loss": 0.0047308841947282946, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 11.096704483032227}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 852.4811037143196, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 468000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 4786.201, "sample_time_ms": 2389.667, "synch_weights_time_ms": 1.951}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 117, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-16", "timestamp": 1702591756, "time_this_iter_s": 4.694329023361206, "time_total_s": 574.2346134185791, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 574.2346134185791, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 31.033333333333335, "ram_util_percent": 78.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.23238000699849143}, "default_policy": {"total_loss": 0.23238000699849143, "policy_loss": -0.0016709816583029148, "vf_loss": 9.43892254656566, "vf_loss_unclipped": 2724.767949330019, "vf_explained_var": 0.008393147670383901, "entropy": 2.692723053604809, "mean_kl_loss": 0.012585877671683662, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 11.096704483032227}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 854.8955631404882, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 472000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 4794.641, "sample_time_ms": 2396.063, "synch_weights_time_ms": 1.936}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 118, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-21", "timestamp": 1702591761, "time_this_iter_s": 4.6812310218811035, "time_total_s": 578.9158444404602, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 578.9158444404602, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 29.342857142857138, "ram_util_percent": 79.3142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.5163274650324954}, "default_policy": {"total_loss": 1.5163274650324954, "policy_loss": 0.024015215630116844, "vf_loss": 9.03045375057375, "vf_loss_unclipped": 1192.3979798339324, "vf_explained_var": 0.008111678397477562, "entropy": 2.65239162199787, "mean_kl_loss": 0.1263445123472176, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.645057678222656}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 800.7209784620427, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 476000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 4814.548, "sample_time_ms": 2400.418, "synch_weights_time_ms": 1.929}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 119, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-26", "timestamp": 1702591766, "time_this_iter_s": 4.997032880783081, "time_total_s": 583.9128773212433, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 583.9128773212433, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 38.15714285714286, "ram_util_percent": 79.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.13226676964238762}, "default_policy": {"total_loss": 0.13226676964238762, "policy_loss": -0.0023542177848029397, "vf_loss": 8.436621255203605, "vf_loss_unclipped": 233.2895126586784, "vf_explained_var": 0.051741936821927396, "entropy": 2.670548542476158, "mean_kl_loss": 0.0030192011566239417, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.322528839111328}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 819.0145619861363, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 480000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 4804.159, "sample_time_ms": 2391.089, "synch_weights_time_ms": 1.884}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 120, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-31", "timestamp": 1702591771, "time_this_iter_s": 4.885663986206055, "time_total_s": 588.7985413074493, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 588.7985413074493, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 31.97142857142857, "ram_util_percent": 78.87142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17143077802445209}, "default_policy": {"total_loss": 0.17143077802445209, "policy_loss": -0.003740813635758309, "vf_loss": 8.548377901252145, "vf_loss_unclipped": 238.6817268908405, "vf_explained_var": 0.020287515575697683, "entropy": 2.5942745122319852, "mean_kl_loss": 0.010776509892819256, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.322528839111328}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 869.6497943543417, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 484000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 4774.63, "sample_time_ms": 2384.189, "synch_weights_time_ms": 1.92}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 121, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-35", "timestamp": 1702591775, "time_this_iter_s": 4.601487159729004, "time_total_s": 593.4000284671783, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 593.4000284671783, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 27.057142857142857, "ram_util_percent": 78.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.27116863343959996}, "default_policy": {"total_loss": 0.27116863343959996, "policy_loss": -0.0002512436460401775, "vf_loss": 8.519993868972193, "vf_loss_unclipped": 178.20082054056846, "vf_explained_var": 0.028763622109061367, "entropy": 2.47889861877539, "mean_kl_loss": 0.022375403292926907, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 12.483793258666992}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}}, "episode_reward_max": -121873.35183508614, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -128186.69214798552, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19026628720076552, "mean_inference_ms": 0.7484902272847428, "mean_action_processing_ms": 0.04496187405905936, "mean_env_wait_ms": 0.3017095326502937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040272871653238935, "StateBufferConnector_ms": 0.002781550089518229, "ViewRequirementAgentConnector_ms": 0.15767216682434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 851.8517521837401, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 488000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 4763.309, "sample_time_ms": 2377.389, "synch_weights_time_ms": 1.912}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 122, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-40", "timestamp": 1702591780, "time_this_iter_s": 4.696743965148926, "time_total_s": 598.0967724323273, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 598.0967724323273, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 30.16666666666667, "ram_util_percent": 78.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7112846965395184}, "default_policy": {"total_loss": 0.7112846965395184, "policy_loss": 0.01438544990856256, "vf_loss": 8.311385476004594, "vf_loss_unclipped": 169.11844075412384, "vf_explained_var": -0.009695950792288221, "entropy": 2.533161584629433, "mean_kl_loss": 0.04916657791067131, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 18.725688934326172}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 580.66295093771, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 492000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 4980.65, "sample_time_ms": 2594.776, "synch_weights_time_ms": 1.917}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 123, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-47", "timestamp": 1702591787, "time_this_iter_s": 6.890737771987915, "time_total_s": 604.9875102043152, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 604.9875102043152, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 21.020000000000003, "ram_util_percent": 78.31000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.0660652497501324}, "default_policy": {"total_loss": 1.0660652497501324, "policy_loss": 0.015879198990222106, "vf_loss": 8.48461811781438, "vf_loss_unclipped": 166.85110057594935, "vf_explained_var": 0.034235333328816425, "entropy": 2.3549566587913775, "mean_kl_loss": 0.05155163469069847, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 28.088533401489258}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 861.534359742682, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 496000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 4962.532, "sample_time_ms": 2590.504, "synch_weights_time_ms": 1.934}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 124, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-52", "timestamp": 1702591792, "time_this_iter_s": 4.6456828117370605, "time_total_s": 609.6331930160522, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 609.6331930160522, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 27.74285714285714, "ram_util_percent": 78.52857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.6120038251978344}, "default_policy": {"total_loss": 0.6120038251978344, "policy_loss": 0.004801178406646002, "vf_loss": 8.439739594835716, "vf_loss_unclipped": 173.5153783257328, "vf_explained_var": 0.010108072620465048, "entropy": 2.44889126988108, "mean_kl_loss": 0.01861276424533726, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 28.088533401489258}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 846.3644983696456, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 500000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 4959.276, "sample_time_ms": 2583.773, "synch_weights_time_ms": 1.907}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 125, "trial_id": "0d28b_00000", "date": "2023-12-14_17-09-56", "timestamp": 1702591796, "time_this_iter_s": 4.727988958358765, "time_total_s": 614.361181974411, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 614.361181974411, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 28.514285714285716, "ram_util_percent": 78.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1710997455393963}, "default_policy": {"total_loss": 0.1710997455393963, "policy_loss": -0.001774037068685902, "vf_loss": 8.408254046938312, "vf_loss_unclipped": 124.084060010117, "vf_explained_var": 0.14830459549482952, "entropy": 2.294987475439938, "mean_kl_loss": 0.0031611206275765904, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.044266700744629}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 828.6722334560462, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 504000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 4963.03, "sample_time_ms": 2583.297, "synch_weights_time_ms": 1.839}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 126, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-01", "timestamp": 1702591801, "time_this_iter_s": 4.828775882720947, "time_total_s": 619.189957857132, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 619.189957857132, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 33.93333333333334, "ram_util_percent": 78.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2078041592116422}, "default_policy": {"total_loss": 0.2078041592116422, "policy_loss": -0.0019479681159864102, "vf_loss": 8.667843371820348, "vf_loss_unclipped": 265.7272604716612, "vf_explained_var": 0.005370073354066308, "entropy": 2.4439733963785395, "mean_kl_loss": 0.00876326947609666, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.044266700744629}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 801.2012180661409, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 508000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 4993.06, "sample_time_ms": 2611.052, "synch_weights_time_ms": 1.927}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 127, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-06", "timestamp": 1702591806, "time_this_iter_s": 4.994903087615967, "time_total_s": 624.1848609447479, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 624.1848609447479, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 37.425, "ram_util_percent": 79.96249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.16070483771682992}, "default_policy": {"total_loss": 0.16070483771682992, "policy_loss": -0.0022068796163079328, "vf_loss": 8.77530319502613, "vf_loss_unclipped": 277.6750820216848, "vf_explained_var": 0.012812748519596514, "entropy": 2.454710458387444, "mean_kl_loss": 0.0053515564175575835, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.044266700744629}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 821.7336922590372, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 512000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 5011.943, "sample_time_ms": 2632.098, "synch_weights_time_ms": 1.961}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 128, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-11", "timestamp": 1702591811, "time_this_iter_s": 4.870184898376465, "time_total_s": 629.0550458431244, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 629.0550458431244, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 36.97142857142857, "ram_util_percent": 80.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.4851855164342154}, "default_policy": {"total_loss": 1.4851855164342154, "policy_loss": 0.0320601450649948, "vf_loss": 9.255903019833921, "vf_loss_unclipped": 1628.514500859958, "vf_explained_var": 0.027408614913537813, "entropy": 2.4146503837886395, "mean_kl_loss": 0.09687699443260274, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.0664005279541}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 834.4080233040391, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 516000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 4991.774, "sample_time_ms": 2636.332, "synch_weights_time_ms": 1.94}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 129, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-16", "timestamp": 1702591816, "time_this_iter_s": 4.795802116394043, "time_total_s": 633.8508479595184, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 633.8508479595184, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 37.1, "ram_util_percent": 79.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5634656383522919}, "default_policy": {"total_loss": 0.5634656383522919, "policy_loss": 0.0072426337352606346, "vf_loss": 9.56035753709675, "vf_loss_unclipped": 4741.9998784014415, "vf_explained_var": 0.021589319843219032, "entropy": 2.458710274462507, "mean_kl_loss": 0.02186512257204609, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 31.59960174560547}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 840.1284277782532, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 520000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 4979.501, "sample_time_ms": 2622.696, "synch_weights_time_ms": 1.966}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 130, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-21", "timestamp": 1702591821, "time_this_iter_s": 4.762799978256226, "time_total_s": 638.6136479377747, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 638.6136479377747, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 32.32857142857143, "ram_util_percent": 79.75714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.442313386333872}, "default_policy": {"total_loss": 1.442313386333872, "policy_loss": 0.011795204372079706, "vf_loss": 9.54870011659065, "vf_loss_unclipped": 3566.1274832215136, "vf_explained_var": 0.0029657578417487235, "entropy": 2.415321224915193, "mean_kl_loss": 0.042248354798999736, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 47.3994026184082}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 840.8291389728786, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 524000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 4995.267, "sample_time_ms": 2635.467, "synch_weights_time_ms": 1.916}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 131, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-25", "timestamp": 1702591825, "time_this_iter_s": 4.759087085723877, "time_total_s": 643.3727350234985, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 643.3727350234985, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 31.82857142857143, "ram_util_percent": 79.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.40368524880440376}, "default_policy": {"total_loss": 0.40368524880440376, "policy_loss": 0.0006570162108616789, "vf_loss": 9.844006582109659, "vf_loss_unclipped": 5667.033988903835, "vf_explained_var": 0.01364690020902833, "entropy": 2.52003380433837, "mean_kl_loss": 0.0064259916106375325, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 47.3994026184082}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 846.9005112432836, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 528000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 4998.012, "sample_time_ms": 2640.746, "synch_weights_time_ms": 1.931}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 132, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-30", "timestamp": 1702591830, "time_this_iter_s": 4.724745035171509, "time_total_s": 648.09748005867, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 648.09748005867, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 30.17142857142857, "ram_util_percent": 79.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2138803442364245}, "default_policy": {"total_loss": 0.2138803442364245, "policy_loss": -0.0015837642382075792, "vf_loss": 9.814774055724968, "vf_loss_unclipped": 6341.034165746368, "vf_explained_var": 0.015072839727788083, "entropy": 2.5192943445400897, "mean_kl_loss": 0.0024750600013324544, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 23.6997013092041}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 835.6285053783461, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 532000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 4787.825, "sample_time_ms": 2427.924, "synch_weights_time_ms": 1.915}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 133, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-35", "timestamp": 1702591835, "time_this_iter_s": 4.788466930389404, "time_total_s": 652.8859469890594, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 652.8859469890594, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 33.15714285714286, "ram_util_percent": 79.74285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22456733623483796}, "default_policy": {"total_loss": 0.22456733623483796, "policy_loss": -0.0009410276506115982, "vf_loss": 9.789791399990317, "vf_loss_unclipped": 7845.441089150239, "vf_explained_var": 0.006160590313136705, "entropy": 2.5037018103894395, "mean_kl_loss": 0.005384474975840128, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 23.6997013092041}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 798.7308070462223, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 536000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 4824.332, "sample_time_ms": 2458.543, "synch_weights_time_ms": 1.945}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 134, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-40", "timestamp": 1702591840, "time_this_iter_s": 5.009237051010132, "time_total_s": 657.8951840400696, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 657.8951840400696, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 38.74285714285714, "ram_util_percent": 79.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5897472365570666}, "default_policy": {"total_loss": 0.5897472365570666, "policy_loss": 0.009200872024342513, "vf_loss": 9.551127898413489, "vf_loss_unclipped": 4434.602633136676, "vf_explained_var": 0.01796000624008016, "entropy": 2.462618079775178, "mean_kl_loss": 0.020465873274522442, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 35.54955291748047}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 821.8022400031349, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 540000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 4838.457, "sample_time_ms": 2474.426, "synch_weights_time_ms": 1.985}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 135, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-45", "timestamp": 1702591845, "time_this_iter_s": 4.869446754455566, "time_total_s": 662.7646307945251, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 662.7646307945251, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 36.48571428571429, "ram_util_percent": 79.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 2.433338531243331}, "default_policy": {"total_loss": 2.433338531243331, "policy_loss": 0.021503018136116377, "vf_loss": 9.110634659399102, "vf_loss_unclipped": 1734.332408042859, "vf_explained_var": -0.006406146707311114, "entropy": 2.435477156120577, "mean_kl_loss": 0.06528152920207325, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 53.3243293762207}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 842.9427079159476, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 544000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 4830.281, "sample_time_ms": 2474.35, "synch_weights_time_ms": 2.394}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 136, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-50", "timestamp": 1702591850, "time_this_iter_s": 4.751039028167725, "time_total_s": 667.5156698226929, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 667.5156698226929, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 36.65, "ram_util_percent": 79.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.238527041532274}, "default_policy": {"total_loss": 0.238527041532274, "policy_loss": -0.0010718041469952636, "vf_loss": 8.72310401839234, "vf_loss_unclipped": 297.6777733434746, "vf_explained_var": 0.006388926366244806, "entropy": 2.412975593924777, "mean_kl_loss": 0.0028573787958114044, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 26.66216468811035}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 833.182825679559, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 548000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 4811.118, "sample_time_ms": 2460.977, "synch_weights_time_ms": 2.28}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 137, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-55", "timestamp": 1702591855, "time_this_iter_s": 4.803096055984497, "time_total_s": 672.3187658786774, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 672.3187658786774, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 35.628571428571426, "ram_util_percent": 80.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.12833198833801568}, "default_policy": {"total_loss": 0.12833198833801568, "policy_loss": -0.001875674318788307, "vf_loss": 8.552075464842416, "vf_loss_unclipped": 256.70914580013704, "vf_explained_var": 0.03656127496060532, "entropy": 2.3591170190239765, "mean_kl_loss": 0.0016760420907519565, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.331082344055176}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 846.2406104919169, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 552000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 4797.021, "sample_time_ms": 2440.503, "synch_weights_time_ms": 2.284}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 138, "trial_id": "0d28b_00000", "date": "2023-12-14_17-10-59", "timestamp": 1702591859, "time_this_iter_s": 4.728262901306152, "time_total_s": 677.0470287799835, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 677.0470287799835, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 32.67142857142857, "ram_util_percent": 79.6857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.13230268981085339}, "default_policy": {"total_loss": 0.13230268981085339, "policy_loss": -0.0014602498197034477, "vf_loss": 8.560358204567102, "vf_loss_unclipped": 184.11972763289268, "vf_explained_var": 0.023308808488378137, "entropy": 2.264380806671785, "mean_kl_loss": 0.0036125618175232733, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 6.665541172027588}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 841.0020332266969, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 556000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 4793.262, "sample_time_ms": 2440.399, "synch_weights_time_ms": 2.319}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 139, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-04", "timestamp": 1702591864, "time_this_iter_s": 4.757741689682007, "time_total_s": 681.8047704696655, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 681.8047704696655, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 37.385714285714286, "ram_util_percent": 79.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21670052285657634}, "default_policy": {"total_loss": 0.21670052285657634, "policy_loss": 0.00272788556276767, "vf_loss": 8.406477687201265, "vf_loss_unclipped": 153.9550669737208, "vf_explained_var": 9.018691109695922e-05, "entropy": 2.255721788416539, "mean_kl_loss": 0.019489469644968713, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 6.665541172027588}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}}, "episode_reward_max": -115723.14656819163, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -126409.79528841055, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904205137923074, "mean_inference_ms": 0.7486787923894053, "mean_action_processing_ms": 0.044996220654422665, "mean_env_wait_ms": 0.2975170607612108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003990105220249721, "StateBufferConnector_ms": 0.002743516649518694, "ViewRequirementAgentConnector_ms": 0.156923702784947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 841.1902239682128, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 560000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 4792.661, "sample_time_ms": 2439.95, "synch_weights_time_ms": 2.353}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 140, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-09", "timestamp": 1702591869, "time_this_iter_s": 4.757126808166504, "time_total_s": 686.561897277832, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 686.561897277832, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 32.01428571428572, "ram_util_percent": 79.38571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21887081278078974}, "default_policy": {"total_loss": 0.21887081278078974, "policy_loss": 0.0029829970316719145, "vf_loss": 8.581042897218326, "vf_loss_unclipped": 173.2755698100336, "vf_explained_var": -0.00033199107214840234, "entropy": 2.2681686983688047, "mean_kl_loss": 0.01951490284182873, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 6.665541172027588}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 568.8337244855405, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 564000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 5020.133, "sample_time_ms": 2652.303, "synch_weights_time_ms": 2.387}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 141, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-16", "timestamp": 1702591876, "time_this_iter_s": 7.0340611934661865, "time_total_s": 693.5959584712982, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 693.5959584712982, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 27.630000000000003, "ram_util_percent": 79.41}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.342377093288976}, "default_policy": {"total_loss": 0.342377093288976, "policy_loss": 0.009003217876164009, "vf_loss": 8.647214928669715, "vf_loss_unclipped": 199.51874057468828, "vf_explained_var": -9.553264707390433e-07, "entropy": 2.174685865450007, "mean_kl_loss": 0.03704151235020862, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.998311996459961}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 837.8022787109626, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 568000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 5025.261, "sample_time_ms": 2656.576, "synch_weights_time_ms": 2.423}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 142, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-21", "timestamp": 1702591881, "time_this_iter_s": 4.7764410972595215, "time_total_s": 698.3723995685577, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 698.3723995685577, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 38.56666666666666, "ram_util_percent": 79.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19361125679511917}, "default_policy": {"total_loss": 0.19361125679511917, "policy_loss": 0.00340555497864162, "vf_loss": 8.688594741353603, "vf_loss_unclipped": 208.20042279127566, "vf_explained_var": -9.569786250718366e-07, "entropy": 2.1069954252446386, "mean_kl_loss": 0.010333719742007808, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.998311996459961}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 864.4671824101717, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 572000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 5009.292, "sample_time_ms": 2647.823, "synch_weights_time_ms": 2.431}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 143, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-25", "timestamp": 1702591885, "time_this_iter_s": 4.629010915756226, "time_total_s": 703.001410484314, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 703.001410484314, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 30.328571428571426, "ram_util_percent": 79.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17361052948703518}, "default_policy": {"total_loss": 0.17361052948703518, "policy_loss": -0.001638924030821397, "vf_loss": 8.744628512783091, "vf_loss_unclipped": 164.29423462353282, "vf_explained_var": -9.545639379700618e-07, "entropy": 2.130745534449498, "mean_kl_loss": 0.008781799170927248, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.998311996459961}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 867.9653714367485, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 576000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 4969.346, "sample_time_ms": 2614.676, "synch_weights_time_ms": 2.402}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 144, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-30", "timestamp": 1702591890, "time_this_iter_s": 4.609607219696045, "time_total_s": 707.61101770401, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 707.61101770401, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 27.085714285714285, "ram_util_percent": 79.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20293490788035556}, "default_policy": {"total_loss": 0.20293490788035556, "policy_loss": 0.002911388178044227, "vf_loss": 8.7390954021706, "vf_loss_unclipped": 253.02785532611773, "vf_explained_var": -9.5367431640625e-07, "entropy": 2.4208635274789483, "mean_kl_loss": 0.01126515824513468, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.998311996459961}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 857.3400795424744, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 580000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 4949.17, "sample_time_ms": 2596.084, "synch_weights_time_ms": 2.427}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 145, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-35", "timestamp": 1702591895, "time_this_iter_s": 4.668075084686279, "time_total_s": 712.2790927886963, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 712.2790927886963, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 29.933333333333326, "ram_util_percent": 79.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.15452660412501806}, "default_policy": {"total_loss": 0.15452660412501806, "policy_loss": -0.0038607880787880247, "vf_loss": 9.063464287247484, "vf_loss_unclipped": 587.2660098614723, "vf_explained_var": -9.57614069045988e-07, "entropy": 2.3514625705889802, "mean_kl_loss": 0.006776418816859069, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.998311996459961}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 852.8275568993405, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 584000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 4943.675, "sample_time_ms": 2593.245, "synch_weights_time_ms": 2.028}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 146, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-39", "timestamp": 1702591899, "time_this_iter_s": 4.69194483757019, "time_total_s": 716.9710376262665, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 716.9710376262665, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 29.628571428571426, "ram_util_percent": 79.07142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5381333092009144}, "default_policy": {"total_loss": 0.5381333092009144, "policy_loss": 0.003296529872219827, "vf_loss": 9.094621791514252, "vf_loss_unclipped": 1908.2013894510167, "vf_explained_var": -9.58122424225309e-07, "entropy": 2.381112707194997, "mean_kl_loss": 0.04439655104532746, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.997467994689941}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 861.9296577458413, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 588000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 4927.663, "sample_time_ms": 2578.402, "synch_weights_time_ms": 2.058}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 147, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-44", "timestamp": 1702591904, "time_this_iter_s": 4.642752170562744, "time_total_s": 721.6137897968292, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 721.6137897968292, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 28.142857142857142, "ram_util_percent": 79.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19692835922061064}, "default_policy": {"total_loss": 0.19692835922061064, "policy_loss": -0.0024390265877757755, "vf_loss": 9.92400005987204, "vf_loss_unclipped": 6149.841520785269, "vf_explained_var": -9.67526995042748e-07, "entropy": 2.353473034240544, "mean_kl_loss": 0.006676286123778625, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.997467994689941}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 854.3855406237346, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 592000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 4923.157, "sample_time_ms": 2577.634, "synch_weights_time_ms": 2.068}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 148, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-49", "timestamp": 1702591909, "time_this_iter_s": 4.683384895324707, "time_total_s": 726.2971746921539, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 726.2971746921539, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 31.566666666666666, "ram_util_percent": 79.16666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2379585021753301}, "default_policy": {"total_loss": 0.2379585021753301, "policy_loss": 0.0007825625984907658, "vf_loss": 9.639088715571585, "vf_loss_unclipped": 3771.8855104995437, "vf_explained_var": -9.611725553012353e-07, "entropy": 2.341546549471711, "mean_kl_loss": 0.009387254813484071, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.997467994689941}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 857.9471206188472, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 596000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 4913.764, "sample_time_ms": 2567.579, "synch_weights_time_ms": 2.007}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 149, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-53", "timestamp": 1702591913, "time_this_iter_s": 4.663969039916992, "time_total_s": 730.9611437320709, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 730.9611437320709, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 27.228571428571428, "ram_util_percent": 79.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.37072351646782364}, "default_policy": {"total_loss": 0.37072351646782364, "policy_loss": 0.0036826511405146263, "vf_loss": 9.787478047393279, "vf_loss_unclipped": 8766.876059656204, "vf_explained_var": -9.65112307940973e-07, "entropy": 2.411724699585677, "mean_kl_loss": 0.017947434975846797, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.997467994689941}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 791.0908949708212, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 600000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 4943.877, "sample_time_ms": 2568.111, "synch_weights_time_ms": 1.992}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 150, "trial_id": "0d28b_00000", "date": "2023-12-14_17-11-58", "timestamp": 1702591918, "time_this_iter_s": 5.05892276763916, "time_total_s": 736.0200664997101, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 736.0200664997101, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 37.714285714285715, "ram_util_percent": 79.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2965077989454717}, "default_policy": {"total_loss": 0.2965077989454717, "policy_loss": -0.0002751226749406186, "vf_loss": 9.704111047899291, "vf_loss_unclipped": 6864.859512044422, "vf_explained_var": -9.606642001219142e-07, "entropy": 2.310957297841623, "mean_kl_loss": 0.013318368898245472, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.997467994689941}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 790.2238645194005, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 604000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 604000, "timers": {"training_iteration_time_ms": 4746.87, "sample_time_ms": 2359.798, "synch_weights_time_ms": 2.015}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 151, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-03", "timestamp": 1702591923, "time_this_iter_s": 5.06356406211853, "time_total_s": 741.0836305618286, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 741.0836305618286, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 39.714285714285715, "ram_util_percent": 78.37142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24318344070554287}, "default_policy": {"total_loss": 0.24318344070554287, "policy_loss": -0.00229395725933124, "vf_loss": 9.645946266300388, "vf_loss_unclipped": 6417.87941114023, "vf_explained_var": -9.607912889167443e-07, "entropy": 2.2809422130523713, "mean_kl_loss": 0.009936206065094762, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.997467994689941}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 826.5796449512434, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 608000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 4753.353, "sample_time_ms": 2354.919, "synch_weights_time_ms": 3.047}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 152, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-08", "timestamp": 1702591928, "time_this_iter_s": 4.843642950057983, "time_total_s": 745.9272735118866, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 745.9272735118866, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 32.07142857142857, "ram_util_percent": 78.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.2944491335284163}, "default_policy": {"total_loss": 1.2944491335284163, "policy_loss": 0.022365982944110054, "vf_loss": 9.417251110076904, "vf_loss_unclipped": 3911.8529225412462, "vf_explained_var": -9.593933121736116e-07, "entropy": 2.1676924964512336, "mean_kl_loss": 0.07854063362867668, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.49620246887207}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 770.839317748217, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 612000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 4809.553, "sample_time_ms": 2383.793, "synch_weights_time_ms": 3.052}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 153, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-14", "timestamp": 1702591934, "time_this_iter_s": 5.191103219985962, "time_total_s": 751.1183767318726, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 751.1183767318726, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 39.5125, "ram_util_percent": 78.8875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7975421497530775}, "default_policy": {"total_loss": 0.7975421497530775, "policy_loss": 0.003463564731522219, "vf_loss": 8.937537324962332, "vf_loss_unclipped": 1332.1992055856342, "vf_explained_var": -9.574869802511577e-07, "entropy": 2.2750185067211386, "mean_kl_loss": 0.03132543048196433, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 33.74430465698242}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 784.4934064732194, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 616000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 4858.589, "sample_time_ms": 2401.883, "synch_weights_time_ms": 3.058}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 154, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-19", "timestamp": 1702591939, "time_this_iter_s": 5.100505113601685, "time_total_s": 756.2188818454742, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 756.2188818454742, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 36.199999999999996, "ram_util_percent": 79.58571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1231158089412968}, "default_policy": {"total_loss": 0.1231158089412968, "policy_loss": -0.001959729873176132, "vf_loss": 8.650346892220634, "vf_loss_unclipped": 215.5972885099301, "vf_explained_var": -9.54182671585571e-07, "entropy": 2.2980841614290086, "mean_kl_loss": 0.00114306906069998, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.87215232849121}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 839.5146139813687, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 620000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 4868.495, "sample_time_ms": 2410.414, "synch_weights_time_ms": 2.996}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 155, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-23", "timestamp": 1702591943, "time_this_iter_s": 4.765910863876343, "time_total_s": 760.9847927093506, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 760.9847927093506, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 30.442857142857147, "ram_util_percent": 79.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20763260774862474}, "default_policy": {"total_loss": 0.20763260774862474, "policy_loss": -0.0021092445154720025, "vf_loss": 8.679802918993333, "vf_loss_unclipped": 181.40785122934435, "vf_explained_var": -9.55580648328704e-07, "entropy": 2.2224210970945704, "mean_kl_loss": 0.007286789691003206, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.87215232849121}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 844.2142156054186, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 624000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 4873.281, "sample_time_ms": 2411.29, "synch_weights_time_ms": 2.965}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 156, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-28", "timestamp": 1702591948, "time_this_iter_s": 4.74035906791687, "time_total_s": 765.7251517772675, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 765.7251517772675, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 31.11428571428571, "ram_util_percent": 79.3142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.41574633365342106}, "default_policy": {"total_loss": 0.41574633365342106, "policy_loss": 0.004389387020257427, "vf_loss": 8.588855572600863, "vf_loss_unclipped": 206.1684926405136, "vf_explained_var": -9.578682466356484e-07, "entropy": 1.9715362811393575, "mean_kl_loss": 0.019290271042608317, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.87215232849121}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}}, "episode_reward_max": -114869.01516643351, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -124997.09812347902, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057240167984263, "mean_inference_ms": 0.7491233924674715, "mean_action_processing_ms": 0.04502979599011882, "mean_env_wait_ms": 0.2940983411295282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400543212890625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.15755146741867065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 841.6511259779547, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 628000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 628000, "timers": {"training_iteration_time_ms": 4884.462, "sample_time_ms": 2411.09, "synch_weights_time_ms": 2.984}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 157, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-33", "timestamp": 1702591953, "time_this_iter_s": 4.754008769989014, "time_total_s": 770.4791605472565, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 770.4791605472565, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 31.61666666666667, "ram_util_percent": 79.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21257357902403898}, "default_policy": {"total_loss": 0.21257357902403898, "policy_loss": -0.0005975955539245976, "vf_loss": 8.418386560004912, "vf_loss_unclipped": 151.69628832233485, "vf_explained_var": -9.554535595338736e-07, "entropy": 2.2403497495122555, "mean_kl_loss": 0.007644982643596799, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.87215232849121}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 561.5438927909129, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 632000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 5128.609, "sample_time_ms": 2656.235, "synch_weights_time_ms": 3.012}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 158, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-40", "timestamp": 1702591960, "time_this_iter_s": 7.125647068023682, "time_total_s": 777.6048076152802, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 777.6048076152802, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 29.529999999999994, "ram_util_percent": 79.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.8756170113410141}, "default_policy": {"total_loss": 0.8756170113410141, "policy_loss": 0.01815776811636635, "vf_loss": 8.578734804572328, "vf_loss_unclipped": 179.95130710154453, "vf_explained_var": -9.554535595338736e-07, "entropy": 1.9917028280717732, "mean_kl_loss": 0.04573642293837929, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.3082275390625}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 814.601044115053, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 636000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 5153.417, "sample_time_ms": 2670.294, "synch_weights_time_ms": 2.992}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 159, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-45", "timestamp": 1702591965, "time_this_iter_s": 4.911808013916016, "time_total_s": 782.5166156291962, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 782.5166156291962, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 34.24285714285715, "ram_util_percent": 78.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4467870883270304}, "default_policy": {"total_loss": 0.4467870883270304, "policy_loss": 0.005239401439101552, "vf_loss": 8.303543433960058, "vf_loss_unclipped": 160.82315704817458, "vf_explained_var": -9.527846948424382e-07, "entropy": 2.080390642319661, "mean_kl_loss": 0.014165838112428993, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.3082275390625}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 853.5676424441666, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 640000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 5116.408, "sample_time_ms": 2666.745, "synch_weights_time_ms": 2.974}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 160, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-50", "timestamp": 1702591970, "time_this_iter_s": 4.689007759094238, "time_total_s": 787.2056233882904, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 787.2056233882904, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 30.47142857142857, "ram_util_percent": 78.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.27480539443618707}, "default_policy": {"total_loss": 0.27480539443618707, "policy_loss": 0.0015258038191120825, "vf_loss": 8.435170362753146, "vf_loss_unclipped": 132.63623744948333, "vf_explained_var": -9.550722931493829e-07, "entropy": 1.795888677207646, "mean_kl_loss": 0.007465077772505115, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.3082275390625}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 864.2886918885771, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 644000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 644000, "timers": {"training_iteration_time_ms": 5073.031, "sample_time_ms": 2653.31, "synch_weights_time_ms": 2.936}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 161, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-54", "timestamp": 1702591974, "time_this_iter_s": 4.629838228225708, "time_total_s": 791.8354616165161, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 791.8354616165161, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 27.657142857142862, "ram_util_percent": 78.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.11726331565656196}, "default_policy": {"total_loss": 0.11726331565656196, "policy_loss": -0.001539747741049541, "vf_loss": 8.567764709753268, "vf_loss_unclipped": 171.03186059150613, "vf_explained_var": -9.544368491752315e-07, "entropy": 2.2070343277093443, "mean_kl_loss": 0.001308879370178878, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 12.65411376953125}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 857.1349164180325, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 648000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 5055.78, "sample_time_ms": 2644.528, "synch_weights_time_ms": 1.867}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 162, "trial_id": "0d28b_00000", "date": "2023-12-14_17-12-59", "timestamp": 1702591979, "time_this_iter_s": 4.6689229011535645, "time_total_s": 796.5043845176697, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 796.5043845176697, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 29.816666666666666, "ram_util_percent": 78.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.12388070310150255}, "default_policy": {"total_loss": 0.12388070310150255, "policy_loss": -0.0005951748713096386, "vf_loss": 8.733433229836828, "vf_loss_unclipped": 279.00719347386473, "vf_explained_var": -9.549452043545526e-07, "entropy": 2.1865541019927717, "mean_kl_loss": 0.0029351360223374098, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 6.327056884765625}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 839.0409001292128, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 652000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 652000, "timers": {"training_iteration_time_ms": 5013.602, "sample_time_ms": 2619.677, "synch_weights_time_ms": 1.891}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 163, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-04", "timestamp": 1702591984, "time_this_iter_s": 4.769051790237427, "time_total_s": 801.2734363079071, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 801.2734363079071, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 31.757142857142856, "ram_util_percent": 78.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2039870666896007}, "default_policy": {"total_loss": 0.2039870666896007, "policy_loss": -0.004742071179966969, "vf_loss": 9.076689670843356, "vf_loss_unclipped": 1434.5930160571263, "vf_explained_var": -9.578682466356484e-07, "entropy": 1.9858656512903, "mean_kl_loss": 0.018644094208827806, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 6.327056884765625}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 824.0899760866187, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 656000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 4989.102, "sample_time_ms": 2615.468, "synch_weights_time_ms": 1.905}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 164, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-09", "timestamp": 1702591989, "time_this_iter_s": 4.855859756469727, "time_total_s": 806.1292960643768, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 806.1292960643768, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 33.00000000000001, "ram_util_percent": 78.85714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3411181019321243}, "default_policy": {"total_loss": 0.3411181019321243, "policy_loss": 0.010547268495305196, "vf_loss": 9.509826412587278, "vf_loss_unclipped": 3711.470817171434, "vf_explained_var": -9.602829337374235e-07, "entropy": 2.0091579200616523, "mean_kl_loss": 0.03721676147115955, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.490585327148438}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 833.7969841558248, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 660000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 4992.37, "sample_time_ms": 2614.849, "synch_weights_time_ms": 1.911}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 165, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-14", "timestamp": 1702591994, "time_this_iter_s": 4.799675226211548, "time_total_s": 810.9289712905884, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 810.9289712905884, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 29.32857142857143, "ram_util_percent": 78.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.392704518849471}, "default_policy": {"total_loss": 0.392704518849471, "policy_loss": 0.011337672019186718, "vf_loss": 9.539951463243854, "vf_loss_unclipped": 3298.2284673027902, "vf_explained_var": -9.633330648133494e-07, "entropy": 1.9308966090684252, "mean_kl_loss": 0.030131686074192077, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.235877990722656}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 839.4962986981145, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 664000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 4995.032, "sample_time_ms": 2620.212, "synch_weights_time_ms": 1.893}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 166, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-18", "timestamp": 1702591998, "time_this_iter_s": 4.767023086547852, "time_total_s": 815.6959943771362, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 815.6959943771362, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 30.157142857142855, "ram_util_percent": 78.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20136302008009604}, "default_policy": {"total_loss": 0.20136302008009604, "policy_loss": -0.00028349924485074053, "vf_loss": 9.77807322239825, "vf_loss_unclipped": 5840.390282279139, "vf_explained_var": -9.640955975823312e-07, "entropy": 2.0937282463380775, "mean_kl_loss": 0.007296057621529425, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.235877990722656}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 845.6883379431332, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 668000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 668000, "timers": {"training_iteration_time_ms": 4992.762, "sample_time_ms": 2628.043, "synch_weights_time_ms": 1.884}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 167, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-23", "timestamp": 1702592003, "time_this_iter_s": 4.733114957809448, "time_total_s": 820.4291093349457, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 820.4291093349457, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 29.014285714285716, "ram_util_percent": 78.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17506200617659828}, "default_policy": {"total_loss": 0.17506200617659828, "policy_loss": -0.003578111376943015, "vf_loss": 9.75132577759879, "vf_loss_unclipped": 6196.353604062534, "vf_explained_var": -9.6358724240301e-07, "entropy": 2.0709344960733262, "mean_kl_loss": 0.005698760297031795, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.235877990722656}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 854.8374991497337, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 672000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 4748.368, "sample_time_ms": 2384.012, "synch_weights_time_ms": 1.841}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 168, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-28", "timestamp": 1702592008, "time_this_iter_s": 4.681344032287598, "time_total_s": 825.1104533672333, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 825.1104533672333, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 31.349999999999998, "ram_util_percent": 78.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21718187641693967}, "default_policy": {"total_loss": 0.21718187641693967, "policy_loss": -0.0018078247775266101, "vf_loss": 9.736028289489909, "vf_loss_unclipped": 4978.149369554987, "vf_explained_var": -9.604100225322536e-07, "entropy": 2.131079083947993, "mean_kl_loss": 0.008543864834590069, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.235877990722656}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 842.8022066595537, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 676000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 676000, "timers": {"training_iteration_time_ms": 4731.937, "sample_time_ms": 2378.667, "synch_weights_time_ms": 1.916}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 169, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-33", "timestamp": 1702592013, "time_this_iter_s": 4.747813940048218, "time_total_s": 829.8582673072815, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 829.8582673072815, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 33.18571428571428, "ram_util_percent": 78.58571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2640314102053706}, "default_policy": {"total_loss": 0.2640314102053706, "policy_loss": 0.001984038334617864, "vf_loss": 9.495466566289158, "vf_loss_unclipped": 3449.2034522017943, "vf_explained_var": -9.643497751719916e-07, "entropy": 2.009994929660358, "mean_kl_loss": 0.011737435490318906, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.235877990722656}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 840.84452039251, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 680000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 4739.028, "sample_time_ms": 2385.993, "synch_weights_time_ms": 1.902}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 170, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-37", "timestamp": 1702592017, "time_this_iter_s": 4.759419918060303, "time_total_s": 834.6176872253418, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 834.6176872253418, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 30.82857142857143, "ram_util_percent": 78.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1989161270017277}, "default_policy": {"total_loss": 0.1989161270017277, "policy_loss": -0.004631208496412504, "vf_loss": 9.086842220729348, "vf_loss_unclipped": 1616.0023248424409, "vf_explained_var": -9.572328026614973e-07, "entropy": 2.034309235717188, "mean_kl_loss": 0.007915136719197136, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.235877990722656}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 856.5464717575856, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 684000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 4743.212, "sample_time_ms": 2386.912, "synch_weights_time_ms": 1.944}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 171, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-42", "timestamp": 1702592022, "time_this_iter_s": 4.671872854232788, "time_total_s": 839.2895600795746, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 839.2895600795746, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 34.21666666666667, "ram_util_percent": 78.71666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.11821036459183071}, "default_policy": {"total_loss": 0.11821036459183071, "policy_loss": -0.00047236574051190796, "vf_loss": 8.747555062714925, "vf_loss_unclipped": 215.5558263050722, "vf_explained_var": -9.5367431640625e-07, "entropy": 2.090253965941065, "mean_kl_loss": 0.0021921499197911478, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 7.117938995361328}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 857.3737279583127, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 688000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 4743.081, "sample_time_ms": 2389.925, "synch_weights_time_ms": 1.989}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 172, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-47", "timestamp": 1702592027, "time_this_iter_s": 4.6673407554626465, "time_total_s": 843.9569008350372, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 843.9569008350372, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 32.15714285714286, "ram_util_percent": 78.58571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.12067967723769102}, "default_policy": {"total_loss": 0.12067967723769102, "policy_loss": -0.004540624956328319, "vf_loss": 8.592763133140515, "vf_loss_unclipped": 189.31061026892428, "vf_explained_var": -9.543097603804014e-07, "entropy": 2.138682006010369, "mean_kl_loss": 0.005520231824075943, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 7.117938995361328}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 853.1560264320881, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 692000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 692000, "timers": {"training_iteration_time_ms": 4735.194, "sample_time_ms": 2388.117, "synch_weights_time_ms": 1.924}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 173, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-51", "timestamp": 1702592031, "time_this_iter_s": 4.690339803695679, "time_total_s": 848.6472406387329, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 848.6472406387329, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 29.028571428571432, "ram_util_percent": 78.74285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.13171702406720628}, "default_policy": {"total_loss": 0.13171702406720628, "policy_loss": -0.0031560338300857336, "vf_loss": 8.552428876921566, "vf_loss_unclipped": 165.75573578775564, "vf_explained_var": -9.545639379700618e-07, "entropy": 2.0742525769703426, "mean_kl_loss": 0.0069330141754445325, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 7.117938995361328}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 819.8784013373565, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 696000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 4737.687, "sample_time_ms": 2392.053, "synch_weights_time_ms": 1.911}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 174, "trial_id": "0d28b_00000", "date": "2023-12-14_17-13-56", "timestamp": 1702592036, "time_this_iter_s": 4.880835056304932, "time_total_s": 853.5280756950378, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 853.5280756950378, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 35.08571428571428, "ram_util_percent": 79.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3263470449451127}, "default_policy": {"total_loss": 0.3263470449451127, "policy_loss": 0.00491894351473368, "vf_loss": 8.460412584134001, "vf_loss_unclipped": 143.3617820536404, "vf_explained_var": -9.55199381944213e-07, "entropy": 2.024287952161801, "mean_kl_loss": 0.03327142545166969, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.676908493041992}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}}, "episode_reward_max": -112891.50637128027, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -123652.08714208053, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907123406026998, "mean_inference_ms": 0.7495139321922626, "mean_action_processing_ms": 0.04506239624452755, "mean_env_wait_ms": 0.29127777735038757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004070334964328342, "StateBufferConnector_ms": 0.0027974446614583335, "ViewRequirementAgentConnector_ms": 0.15883445739746094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 827.8920581219423, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 700000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 4741.109, "sample_time_ms": 2399.748, "synch_weights_time_ms": 1.899}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 175, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-01", "timestamp": 1702592041, "time_this_iter_s": 4.83331298828125, "time_total_s": 858.3613886833191, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 858.3613886833191, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 33.74285714285715, "ram_util_percent": 79.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.37341147814112813}, "default_policy": {"total_loss": 0.37341147814112813, "policy_loss": 0.007158788494459951, "vf_loss": 8.489339922536919, "vf_loss_unclipped": 153.62808712306563, "vf_explained_var": -9.534201388165895e-07, "entropy": 2.078772658605311, "mean_kl_loss": 0.026352131011391514, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 16.015361785888672}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 563.7883698042507, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 704000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 4974.119, "sample_time_ms": 2624.061, "synch_weights_time_ms": 1.949}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 176, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-08", "timestamp": 1702592048, "time_this_iter_s": 7.0968968868255615, "time_total_s": 865.4582855701447, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 865.4582855701447, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 27.119999999999997, "ram_util_percent": 79.03}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.5735150905592101}, "default_policy": {"total_loss": 1.5735150905592101, "policy_loss": 0.02220408897896581, "vf_loss": 8.536059254013907, "vf_loss_unclipped": 181.38952117789782, "vf_explained_var": -9.582495130201392e-07, "entropy": 1.8909993499580986, "mean_kl_loss": 0.09153401782277641, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 24.023042678833008}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 830.4211468425248, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 708000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 4982.816, "sample_time_ms": 2623.998, "synch_weights_time_ms": 1.966}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 177, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-13", "timestamp": 1702592053, "time_this_iter_s": 4.8187010288238525, "time_total_s": 870.2769865989685, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 870.2769865989685, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 35.614285714285714, "ram_util_percent": 79.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1547455584187545}, "default_policy": {"total_loss": 0.1547455584187545, "policy_loss": -0.0014424211606740762, "vf_loss": 8.38522178328622, "vf_loss_unclipped": 144.3025084131562, "vf_explained_var": -9.546910267648921e-07, "entropy": 2.0483775755235634, "mean_kl_loss": 0.0030110991613724446, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 12.011521339416504}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 851.4301223238176, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 712000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 4984.689, "sample_time_ms": 2625.943, "synch_weights_time_ms": 1.942}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 178, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-18", "timestamp": 1702592058, "time_this_iter_s": 4.700105905532837, "time_total_s": 874.9770925045013, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 874.9770925045013, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 37.26666666666667, "ram_util_percent": 80.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1522705616848444}, "default_policy": {"total_loss": 0.1522705616848444, "policy_loss": -0.0024047261888363847, "vf_loss": 8.414461757074287, "vf_loss_unclipped": 149.35848894098928, "vf_explained_var": -9.559619147131947e-07, "entropy": 2.0116248617548425, "mean_kl_loss": 0.005871918124124047, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 12.011521339416504}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 861.2850893947175, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 716000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 716000, "timers": {"training_iteration_time_ms": 4974.504, "sample_time_ms": 2616.248, "synch_weights_time_ms": 1.925}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 179, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-22", "timestamp": 1702592062, "time_this_iter_s": 4.645761013031006, "time_total_s": 879.6228535175323, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 879.6228535175323, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 31.35714285714286, "ram_util_percent": 80.25714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.11075130575545021}, "default_policy": {"total_loss": 0.11075130575545021, "policy_loss": -0.0015197898373444643, "vf_loss": 8.605087319416786, "vf_loss_unclipped": 171.75606197283975, "vf_explained_var": -9.546910267648921e-07, "entropy": 2.1663705390145274, "mean_kl_loss": 0.0021829226939296194, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 6.005760669708252}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 843.5158264397907, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 720000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 4972.997, "sample_time_ms": 2611.586, "synch_weights_time_ms": 1.983}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 180, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-27", "timestamp": 1702592067, "time_this_iter_s": 4.743626117706299, "time_total_s": 884.3664796352386, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 884.3664796352386, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 31.714285714285715, "ram_util_percent": 80.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.11722622442045319}, "default_policy": {"total_loss": 0.11722622442045319, "policy_loss": -0.005363710277251152, "vf_loss": 9.009823581048929, "vf_loss_unclipped": 529.271712358064, "vf_explained_var": -9.553264707390433e-07, "entropy": 1.947430554356402, "mean_kl_loss": 0.0054100890843665475, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 6.005760669708252}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 867.9423812044704, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 724000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 724000, "timers": {"training_iteration_time_ms": 4966.866, "sample_time_ms": 2610.313, "synch_weights_time_ms": 1.971}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 181, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-32", "timestamp": 1702592072, "time_this_iter_s": 4.610935211181641, "time_total_s": 888.9774148464203, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 888.9774148464203, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 30.283333333333335, "ram_util_percent": 80.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.45891810422227075}, "default_policy": {"total_loss": 0.45891810422227075, "policy_loss": 0.0108913617041796, "vf_loss": 9.11664406678824, "vf_loss_unclipped": 1506.576546536834, "vf_explained_var": -9.554535595338736e-07, "entropy": 2.0844631533124556, "mean_kl_loss": 0.05941966859352873, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.008641242980957}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 843.1721076206861, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 728000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 4974.724, "sample_time_ms": 2619.774, "synch_weights_time_ms": 1.948}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 182, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-37", "timestamp": 1702592077, "time_this_iter_s": 4.745627164840698, "time_total_s": 893.723042011261, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 893.723042011261, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 30.27142857142857, "ram_util_percent": 80.07142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.14172822769596252}, "default_policy": {"total_loss": 0.14172822769596252, "policy_loss": -0.005334212123525581, "vf_loss": 9.774261432415894, "vf_loss_unclipped": 4110.510827583036, "vf_explained_var": -9.65112307940973e-07, "entropy": 2.0636985073211607, "mean_kl_loss": 0.005474724033638946, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.008641242980957}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 841.9064386370916, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 732000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 4980.989, "sample_time_ms": 2626.863, "synch_weights_time_ms": 2.002}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 183, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-41", "timestamp": 1702592081, "time_this_iter_s": 4.753713846206665, "time_total_s": 898.4767558574677, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 898.4767558574677, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 29.8, "ram_util_percent": 80.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2455519047786178}, "default_policy": {"total_loss": 0.2455519047786178, "policy_loss": -0.003343012480031469, "vf_loss": 9.539160666943614, "vf_loss_unclipped": 2694.20219101733, "vf_explained_var": -9.59647489763272e-07, "entropy": 2.0623061794207804, "mean_kl_loss": 0.01703956329508647, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.008641242980957}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 824.1179884804751, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 736000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 4978.479, "sample_time_ms": 2622.001, "synch_weights_time_ms": 2.021}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 184, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-46", "timestamp": 1702592086, "time_this_iter_s": 4.855798006057739, "time_total_s": 903.3325538635254, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 903.3325538635254, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 35.542857142857144, "ram_util_percent": 80.07142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3570638136950129}, "default_policy": {"total_loss": 0.3570638136950129, "policy_loss": 0.0029438746922305905, "vf_loss": 9.894401677381763, "vf_loss_unclipped": 8233.802095490479, "vf_explained_var": -9.637143311978404e-07, "entropy": 2.324989011292773, "mean_kl_loss": 0.028325683539255932, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.512962341308594}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 837.889727700082, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 740000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 740000, "timers": {"training_iteration_time_ms": 4972.714, "sample_time_ms": 2621.673, "synch_weights_time_ms": 2.045}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 185, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-51", "timestamp": 1702592091, "time_this_iter_s": 4.775987863540649, "time_total_s": 908.108541727066, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 908.108541727066, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 35.08571428571429, "ram_util_percent": 80.12857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17519200364473278}, "default_policy": {"total_loss": 0.17519200364473278, "policy_loss": -0.004352663735003232, "vf_loss": 9.622269452507815, "vf_loss_unclipped": 5413.09084078498, "vf_explained_var": -9.64985219146143e-07, "entropy": 2.163147044461419, "mean_kl_loss": 0.006166077677443721, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.512962341308594}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 849.1547205576967, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 744000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 4734.285, "sample_time_ms": 2394.028, "synch_weights_time_ms": 1.997}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 186, "trial_id": "0d28b_00000", "date": "2023-12-14_17-14-56", "timestamp": 1702592096, "time_this_iter_s": 4.712849140167236, "time_total_s": 912.8213908672333, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 912.8213908672333, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 34.85, "ram_util_percent": 80.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.18467213614567765}, "default_policy": {"total_loss": 0.18467213614567765, "policy_loss": -0.000355863858308238, "vf_loss": 9.583536029116177, "vf_loss_unclipped": 5374.456200622038, "vf_explained_var": -9.592662233787813e-07, "entropy": 2.2077418352240947, "mean_kl_loss": 0.0066005246106540846, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.512962341308594}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 833.074845277097, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 748000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 748000, "timers": {"training_iteration_time_ms": 4732.75, "sample_time_ms": 2394.848, "synch_weights_time_ms": 1.932}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 187, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-01", "timestamp": 1702592101, "time_this_iter_s": 4.803067922592163, "time_total_s": 917.6244587898254, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 917.6244587898254, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 31.928571428571427, "ram_util_percent": 80.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.8488772484793592}, "default_policy": {"total_loss": 0.8488772484793592, "policy_loss": 0.01606956625810024, "vf_loss": 9.47998295308176, "vf_loss_unclipped": 3281.3561208517567, "vf_explained_var": -9.595204009684418e-07, "entropy": 1.9683527666876819, "mean_kl_loss": 0.054614808515767874, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 20.26944351196289}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 815.5698777662336, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 752000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 4753.407, "sample_time_ms": 2411.986, "synch_weights_time_ms": 2.033}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 188, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-05", "timestamp": 1702592105, "time_this_iter_s": 4.905850172042847, "time_total_s": 922.5303089618683, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 922.5303089618683, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 35.82857142857143, "ram_util_percent": 80.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5502315209205471}, "default_policy": {"total_loss": 0.5502315209205471, "policy_loss": 0.0004075301775355329, "vf_loss": 8.955885807842588, "vf_loss_unclipped": 1378.54710808695, "vf_explained_var": -9.579953354304788e-07, "entropy": 2.065186086621112, "mean_kl_loss": 0.022707339785619528, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 30.404165267944336}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 840.886411276123, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 756000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 4764.673, "sample_time_ms": 2429.577, "synch_weights_time_ms": 1.978}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 189, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-10", "timestamp": 1702592110, "time_this_iter_s": 4.7586753368377686, "time_total_s": 927.288984298706, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 927.288984298706, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 34.55714285714286, "ram_util_percent": 79.87142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1096493675311936}, "default_policy": {"total_loss": 0.1096493675311936, "policy_loss": -0.0010513441819848537, "vf_loss": 8.688456416892599, "vf_loss_unclipped": 193.62899182447745, "vf_explained_var": -9.529117836372685e-07, "entropy": 2.057829174659908, "mean_kl_loss": 0.0007833186361876908, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.202082633972168}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 837.1153308236995, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 760000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 4768.299, "sample_time_ms": 2431.685, "synch_weights_time_ms": 1.97}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 190, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-15", "timestamp": 1702592115, "time_this_iter_s": 4.780764102935791, "time_total_s": 932.0697484016418, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 932.0697484016418, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 31.528571428571432, "ram_util_percent": 80.11428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.8397665188716316}, "default_policy": {"total_loss": 0.8397665188716316, "policy_loss": 0.012406017701538688, "vf_loss": 8.4509691836229, "vf_loss_unclipped": 174.53463787819024, "vf_explained_var": -9.515138068941356e-07, "entropy": 1.9721522234650308, "mean_kl_loss": 0.04886506873185923, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.803123474121094}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 834.1229399946832, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 764000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 764000, "timers": {"training_iteration_time_ms": 4786.984, "sample_time_ms": 2440.856, "synch_weights_time_ms": 1.964}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 191, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-20", "timestamp": 1702592120, "time_this_iter_s": 4.797979116439819, "time_total_s": 936.8677275180817, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 936.8677275180817, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 36.02857142857143, "ram_util_percent": 79.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.31634418061698105}, "default_policy": {"total_loss": 0.31634418061698105, "policy_loss": 0.0023573488687107496, "vf_loss": 8.5191701134639, "vf_loss_unclipped": 172.85743381524645, "vf_explained_var": -9.516408956889658e-07, "entropy": 1.717942362909378, "mean_kl_loss": 0.01003349969654827, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.803123474121094}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}}, "episode_reward_max": -111487.71323626627, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -122436.38031873867, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908318458802624, "mean_inference_ms": 0.7499025756829021, "mean_action_processing_ms": 0.045087285863141494, "mean_env_wait_ms": 0.28880935718515566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004057884216308594, "StateBufferConnector_ms": 0.0027740001678466797, "ViewRequirementAgentConnector_ms": 0.18972039222717285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 844.4847305113132, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 768000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 4786.247, "sample_time_ms": 2441.344, "synch_weights_time_ms": 1.962}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 192, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-25", "timestamp": 1702592125, "time_this_iter_s": 4.738723993301392, "time_total_s": 941.606451511383, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 941.606451511383, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 37.61666666666667, "ram_util_percent": 80.11666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.40222279909751946}, "default_policy": {"total_loss": 0.40222279909751946, "policy_loss": 0.007248999692424179, "vf_loss": 8.406542608224507, "vf_loss_unclipped": 162.3401574620814, "vf_explained_var": -9.572328026614973e-07, "entropy": 2.053083905151912, "mean_kl_loss": 0.013634464366087432, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 22.803123474121094}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 572.1261686840303, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 772000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 772000, "timers": {"training_iteration_time_ms": 5010.281, "sample_time_ms": 2663.019, "synch_weights_time_ms": 1.952}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 193, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-32", "timestamp": 1702592132, "time_this_iter_s": 6.993596076965332, "time_total_s": 948.6000475883484, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 948.6000475883484, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 26.820000000000004, "ram_util_percent": 80.17}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.0258350732055173}, "default_policy": {"total_loss": 1.0258350732055173, "policy_loss": 0.014776784266386903, "vf_loss": 8.479951245952517, "vf_loss_unclipped": 146.4508181492657, "vf_explained_var": -9.569786250718366e-07, "entropy": 1.793531514307075, "mean_kl_loss": 0.04061982023357754, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 34.20468521118164}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 843.8485779823089, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 776000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 4998.932, "sample_time_ms": 2656.698, "synch_weights_time_ms": 1.937}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 194, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-36", "timestamp": 1702592136, "time_this_iter_s": 4.741962909698486, "time_total_s": 953.3420104980469, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 953.3420104980469, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 30.82857142857143, "ram_util_percent": 80.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.30167286993383663}, "default_policy": {"total_loss": 0.30167286993383663, "policy_loss": 0.001785238341950595, "vf_loss": 8.337350904306115, "vf_loss_unclipped": 139.08465656695336, "vf_explained_var": -9.55580648328704e-07, "entropy": 1.8642438478561352, "mean_kl_loss": 0.0063299551501584455, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 34.20468521118164}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 840.8349964882548, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 780000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 4997.26, "sample_time_ms": 2650.257, "synch_weights_time_ms": 1.945}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 195, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-41", "timestamp": 1702592141, "time_this_iter_s": 4.758865833282471, "time_total_s": 958.1008763313293, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 958.1008763313293, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 33.128571428571426, "ram_util_percent": 80.58571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.0467934829593977}, "default_policy": {"total_loss": 1.0467934829593977, "policy_loss": 0.010864197625530396, "vf_loss": 8.478333165650684, "vf_loss_unclipped": 136.00155377337165, "vf_explained_var": -9.544368491752315e-07, "entropy": 1.4373773277949677, "mean_kl_loss": 0.027807475846039684, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 51.307029724121094}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 827.6104293455624, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 784000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 5009.521, "sample_time_ms": 2654.225, "synch_weights_time_ms": 1.99}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 196, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-46", "timestamp": 1702592146, "time_this_iter_s": 4.835216045379639, "time_total_s": 962.936092376709, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 962.936092376709, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 33.25714285714285, "ram_util_percent": 80.37142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.13746701181034193}, "default_policy": {"total_loss": 0.13746701181034193, "policy_loss": -0.0008862006253620454, "vf_loss": 8.474628115513685, "vf_loss_unclipped": 211.07238571069388, "vf_explained_var": -9.5863077940463e-07, "entropy": 2.010013866907498, "mean_kl_loss": 0.0010448262433853195, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 25.653514862060547}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 828.9336153624614, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 788000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 788000, "timers": {"training_iteration_time_ms": 5011.92, "sample_time_ms": 2658.436, "synch_weights_time_ms": 2.011}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 197, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-51", "timestamp": 1702592151, "time_this_iter_s": 4.827651023864746, "time_total_s": 967.7637434005737, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 967.7637434005737, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 34.34285714285714, "ram_util_percent": 80.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.12495519554039944}, "default_policy": {"total_loss": 0.12495519554039944, "policy_loss": -0.0006547519844819678, "vf_loss": 8.679717725782252, "vf_loss_unclipped": 261.2530750933486, "vf_explained_var": -9.550722931493829e-07, "entropy": 2.0507990261639106, "mean_kl_loss": 0.001512961159763153, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 12.826757431030273}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 807.1754505585061, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 792000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 5017.02, "sample_time_ms": 2655.541, "synch_weights_time_ms": 1.952}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 198, "trial_id": "0d28b_00000", "date": "2023-12-14_17-15-56", "timestamp": 1702592156, "time_this_iter_s": 4.957686185836792, "time_total_s": 972.7214295864105, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 972.7214295864105, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 38.08571428571428, "ram_util_percent": 80.07142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.23615934915626163}, "default_policy": {"total_loss": 0.23615934915626163, "policy_loss": -0.0059320894884132246, "vf_loss": 9.097211829634873, "vf_loss_unclipped": 992.5697456961756, "vf_explained_var": -9.563431810976854e-07, "entropy": 1.9855176012144922, "mean_kl_loss": 0.011781568866900925, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 12.826757431030273}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 843.5968794205992, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 796000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 796000, "timers": {"training_iteration_time_ms": 5015.492, "sample_time_ms": 2648.837, "synch_weights_time_ms": 1.978}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 199, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-01", "timestamp": 1702592161, "time_this_iter_s": 4.744490146636963, "time_total_s": 977.4659197330475, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 977.4659197330475, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 36.26666666666667, "ram_util_percent": 79.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 1.0195293016572877}, "default_policy": {"total_loss": 1.0195293016572877, "policy_loss": 0.023768558895695947, "vf_loss": 9.544282121698993, "vf_loss_unclipped": 4050.915003868054, "vf_explained_var": -9.6358724240301e-07, "entropy": 2.0866595579108704, "mean_kl_loss": 0.07019060939650122, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 19.240135192871094}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 847.1858838844616, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 800000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 5009.812, "sample_time_ms": 2647.586, "synch_weights_time_ms": 2.003}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 200, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-05", "timestamp": 1702592165, "time_this_iter_s": 4.723004341125488, "time_total_s": 982.188924074173, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 982.188924074173, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 32.885714285714286, "ram_util_percent": 80.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5731982218026161}, "default_policy": {"total_loss": 0.5731982218026161, "policy_loss": 0.009142946046558636, "vf_loss": 9.555222346584426, "vf_loss_unclipped": 3431.2113040688196, "vf_explained_var": -9.605371113270839e-07, "entropy": 1.9717295556180259, "mean_kl_loss": 0.024350299583765358, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 28.86020278930664}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 804000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 831.4539174940915, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 804000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 5011.351, "sample_time_ms": 2650.466, "synch_weights_time_ms": 2.047}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 201, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-10", "timestamp": 1702592170, "time_this_iter_s": 4.812755823135376, "time_total_s": 987.0016798973083, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 987.0016798973083, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 34.2, "ram_util_percent": 79.82857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.18354928479400842}, "default_policy": {"total_loss": 0.18354928479400842, "policy_loss": -0.0016357317717789587, "vf_loss": 9.923290221167525, "vf_loss_unclipped": 8204.038710409135, "vf_explained_var": -9.623163544547075e-07, "entropy": 2.262573366861608, "mean_kl_loss": 0.0029782227042919472, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.43010139465332}}, "num_env_steps_sampled": 808000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 808000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 822.3468822023967, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 808000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 5024.103, "sample_time_ms": 2653.873, "synch_weights_time_ms": 2.028}, "counters": {"num_env_steps_sampled": 808000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 202, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-15", "timestamp": 1702592175, "time_this_iter_s": 4.867040157318115, "time_total_s": 991.8687200546265, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 991.8687200546265, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 35.49999999999999, "ram_util_percent": 79.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22759665040843396}, "default_policy": {"total_loss": 0.22759665040843396, "policy_loss": 0.0006611491275478655, "vf_loss": 9.807095041153019, "vf_loss_unclipped": 6925.276354442019, "vf_explained_var": -9.6358724240301e-07, "entropy": 2.14891983794251, "mean_kl_loss": 0.008930259368394712, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.43010139465332}}, "num_env_steps_sampled": 812000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 812000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 834.232727099868, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 812000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 812000, "timers": {"training_iteration_time_ms": 4804.439, "sample_time_ms": 2436.61, "synch_weights_time_ms": 2.053}, "counters": {"num_env_steps_sampled": 812000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 203, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-20", "timestamp": 1702592180, "time_this_iter_s": 4.796917915344238, "time_total_s": 996.6656379699707, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 996.6656379699707, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 34.27142857142858, "ram_util_percent": 79.74285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22889062816670327}, "default_policy": {"total_loss": 0.22889062816670327, "policy_loss": -0.00020940029876493314, "vf_loss": 9.764452799042658, "vf_loss_unclipped": 8702.327219379482, "vf_explained_var": -9.607912889167443e-07, "entropy": 2.291181155994757, "mean_kl_loss": 0.009109811098285035, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.43010139465332}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 816000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 798.8579482961718, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 816000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 4831.135, "sample_time_ms": 2465.317, "synch_weights_time_ms": 2.093}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 204, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-25", "timestamp": 1702592185, "time_this_iter_s": 5.008767127990723, "time_total_s": 1001.6744050979614, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1001.6744050979614, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 38.08571428571429, "ram_util_percent": 80.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.21819987854580764}, "default_policy": {"total_loss": 0.21819987854580764, "policy_loss": -0.0012321827748516347, "vf_loss": 9.533832775250172, "vf_loss_unclipped": 5293.692339882922, "vf_explained_var": -9.628247096340286e-07, "entropy": 2.116478749683925, "mean_kl_loss": 0.008599643668183176, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 14.43010139465332}}, "num_env_steps_sampled": 820000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 820000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 802.0606531138312, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 820000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 820000, "timers": {"training_iteration_time_ms": 4854.133, "sample_time_ms": 2471.904, "synch_weights_time_ms": 2.14}, "counters": {"num_env_steps_sampled": 820000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 205, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-30", "timestamp": 1702592190, "time_this_iter_s": 4.989538192749023, "time_total_s": 1006.6639432907104, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1006.6639432907104, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 35.68571428571428, "ram_util_percent": 80.12857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.40692094147110036}, "default_policy": {"total_loss": 0.40692094147110036, "policy_loss": 0.005982879676353703, "vf_loss": 8.981159377453933, "vf_loss_unclipped": 1844.9168527802424, "vf_explained_var": -9.579953354304788e-07, "entropy": 2.037500300768342, "mean_kl_loss": 0.02156093493470959, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 21.645153045654297}}, "num_env_steps_sampled": 824000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 824000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 810.7002747222347, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 824000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 4864.214, "sample_time_ms": 2481.478, "synch_weights_time_ms": 2.211}, "counters": {"num_env_steps_sampled": 824000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 206, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-35", "timestamp": 1702592195, "time_this_iter_s": 4.936324834823608, "time_total_s": 1011.6002681255341, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1011.6002681255341, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 80.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.13577382575208222}, "default_policy": {"total_loss": 0.13577382575208222, "policy_loss": -0.002119821494818528, "vf_loss": 8.707363160688486, "vf_loss_unclipped": 245.59037854778234, "vf_explained_var": -9.544368491752315e-07, "entropy": 2.07098695121086, "mean_kl_loss": 0.002347870588350922, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 10.822576522827148}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 828000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 803.0125914410021, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 828000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 4879.79, "sample_time_ms": 2496.415, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 207, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-40", "timestamp": 1702592200, "time_this_iter_s": 4.983777046203613, "time_total_s": 1016.5840451717377, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1016.5840451717377, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 37.614285714285714, "ram_util_percent": 80.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.10698205995996957}, "default_policy": {"total_loss": 0.10698205995996957, "policy_loss": -0.0024091232645470323, "vf_loss": 8.638190223209893, "vf_loss_unclipped": 196.73950463724034, "vf_explained_var": -9.554535595338736e-07, "entropy": 2.088680393151891, "mean_kl_loss": 0.0021260448148051844, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 5.411288261413574}}, "num_env_steps_sampled": 832000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 832000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 825.2580306184151, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 832000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 4868.932, "sample_time_ms": 2486.993, "synch_weights_time_ms": 2.273}, "counters": {"num_env_steps_sampled": 832000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 208, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-45", "timestamp": 1702592205, "time_this_iter_s": 4.848735094070435, "time_total_s": 1021.4327802658081, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1021.4327802658081, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 32.15714285714286, "ram_util_percent": 80.27142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.12198129962029647}, "default_policy": {"total_loss": 0.12198129962029647, "policy_loss": -0.0020798691940595157, "vf_loss": 8.45109578338005, "vf_loss_unclipped": 194.60158271626878, "vf_explained_var": -9.567244474821762e-07, "entropy": 1.829194297668522, "mean_kl_loss": 0.007308835165800558, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 5.411288261413574}}, "num_env_steps_sampled": 836000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 836000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 830.3106758157869, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 836000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 836000, "timers": {"training_iteration_time_ms": 4876.518, "sample_time_ms": 2498.464, "synch_weights_time_ms": 2.255}, "counters": {"num_env_steps_sampled": 836000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 209, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-49", "timestamp": 1702592209, "time_this_iter_s": 4.818927049636841, "time_total_s": 1026.251707315445, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1026.251707315445, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 36.628571428571426, "ram_util_percent": 81.12857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.20077061794126339}, "default_policy": {"total_loss": 0.20077061794126339, "policy_loss": 0.004099398106733746, "vf_loss": 8.305671943530346, "vf_loss_unclipped": 171.52550804691273, "vf_explained_var": -9.574869802511577e-07, "entropy": 1.794212520757972, "mean_kl_loss": 0.020995832838594953, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.116931915283203}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -121336.5256031462, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909316590115067, "mean_inference_ms": 0.7502638837445325, "mean_action_processing_ms": 0.04510503780873113, "mean_env_wait_ms": 0.2867490626272989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093213514848189, "StateBufferConnector_ms": 0.0028220089999112215, "ViewRequirementAgentConnector_ms": 0.1884948123585094}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 840000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 818.166744888194, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 840000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 4893.265, "sample_time_ms": 2507.854, "synch_weights_time_ms": 2.178}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 210, "trial_id": "0d28b_00000", "date": "2023-12-14_17-16-54", "timestamp": 1702592214, "time_this_iter_s": 4.891016960144043, "time_total_s": 1031.142724275589, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1031.142724275589, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 32.48571428571428, "ram_util_percent": 80.1857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19310404321770552}, "default_policy": {"total_loss": 0.19310404321770552, "policy_loss": 0.0033430071375859, "vf_loss": 8.454364461431117, "vf_loss_unclipped": 167.07439653197332, "vf_explained_var": -9.543097603804014e-07, "entropy": 1.9329368292904103, "mean_kl_loss": 0.012962705165954248, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.116931915283203}}, "num_env_steps_sampled": 844000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 844000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 565.6732373986082, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 844000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 844000, "timers": {"training_iteration_time_ms": 5119.302, "sample_time_ms": 2725.971, "synch_weights_time_ms": 2.114}, "counters": {"num_env_steps_sampled": 844000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 211, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-01", "timestamp": 1702592221, "time_this_iter_s": 7.073700189590454, "time_total_s": 1038.2164244651794, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1038.2164244651794, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 25.02, "ram_util_percent": 79.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.19293653852105744}, "default_policy": {"total_loss": 0.19293653852105744, "policy_loss": 0.0005966416403238199, "vf_loss": 8.543553463177386, "vf_loss_unclipped": 202.78191734427836, "vf_explained_var": -9.582495130201392e-07, "entropy": 1.6595255832936464, "mean_kl_loss": 0.013170538273837809, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.116931915283203}}, "num_env_steps_sampled": 848000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 848000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 820.2086403616947, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 848000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 5120.57, "sample_time_ms": 2720.068, "synch_weights_time_ms": 2.099}, "counters": {"num_env_steps_sampled": 848000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 212, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-06", "timestamp": 1702592226, "time_this_iter_s": 4.8787078857421875, "time_total_s": 1043.0951323509216, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1043.0951323509216, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 33.05714285714286, "ram_util_percent": 79.77142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.12709780317097744}, "default_policy": {"total_loss": 0.12709780317097744, "policy_loss": -0.0022680783919346676, "vf_loss": 8.532143345773855, "vf_loss_unclipped": 151.39565907460033, "vf_explained_var": -9.583766018149695e-07, "entropy": 1.5999324756390505, "mean_kl_loss": 0.005426243421500799, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.116931915283203}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 852000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 847.9912489764164, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 852000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 5112.79, "sample_time_ms": 2709.179, "synch_weights_time_ms": 2.043}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 213, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-11", "timestamp": 1702592231, "time_this_iter_s": 4.719181060791016, "time_total_s": 1047.8143134117126, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1047.8143134117126, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 30.04285714285714, "ram_util_percent": 79.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.12220613230099238}, "default_policy": {"total_loss": 0.12220613230099238, "policy_loss": -0.002635453585416142, "vf_loss": 8.65508491601517, "vf_loss_unclipped": 153.57432166548935, "vf_explained_var": -9.560890035080248e-07, "entropy": 1.6181877809546903, "mean_kl_loss": 0.004717390134656156, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 4.058465957641602}}, "num_env_steps_sampled": 856000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 856000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 828.120532164124, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 856000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 5095.097, "sample_time_ms": 2683.269, "synch_weights_time_ms": 2.032}, "counters": {"num_env_steps_sampled": 856000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 214, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-16", "timestamp": 1702592236, "time_this_iter_s": 4.832166910171509, "time_total_s": 1052.6464803218842, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1052.6464803218842, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 30.642857142857142, "ram_util_percent": 79.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1428775096665631}, "default_policy": {"total_loss": 0.1428775096665631, "policy_loss": 0.002544502320606063, "vf_loss": 8.671789269457493, "vf_loss_unclipped": 177.24032993764004, "vf_explained_var": -9.558348259183644e-07, "entropy": 2.088718777907683, "mean_kl_loss": 0.013210685308291501, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 4.058465957641602}}, "num_env_steps_sampled": 860000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 860000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 822.8801385571644, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 860000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 860000, "timers": {"training_iteration_time_ms": 5082.48, "sample_time_ms": 2676.394, "synch_weights_time_ms": 1.984}, "counters": {"num_env_steps_sampled": 860000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 215, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-21", "timestamp": 1702592241, "time_this_iter_s": 4.863085746765137, "time_total_s": 1057.5095660686493, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1057.5095660686493, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 30.2, "ram_util_percent": 79.5142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.15818089872066463}, "default_policy": {"total_loss": 0.15818089872066463, "policy_loss": -0.006023605201226562, "vf_loss": 9.019474809866216, "vf_loss_unclipped": 546.9101965035965, "vf_explained_var": -9.559619147131947e-07, "entropy": 2.0513067484410334, "mean_kl_loss": 0.01823589401971667, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 4.058465957641602}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 864000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 820.4628236879048, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 864000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 5076.61, "sample_time_ms": 2662.447, "synch_weights_time_ms": 1.852}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 216, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-26", "timestamp": 1702592246, "time_this_iter_s": 4.876993179321289, "time_total_s": 1062.3865592479706, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1062.3865592479706, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 29.442857142857143, "ram_util_percent": 79.3142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4511857439380592}, "default_policy": {"total_loss": 0.4511857439380592, "policy_loss": 0.014498520178843472, "vf_loss": 9.12356483605879, "vf_loss_unclipped": 1645.469762749255, "vf_explained_var": -9.549452043545526e-07, "entropy": 2.0910230178568665, "mean_kl_loss": 0.08511875878920613, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 6.087698936462402}}, "num_env_steps_sampled": 868000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 868000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 847.2701682372972, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 868000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 868000, "timers": {"training_iteration_time_ms": 5050.59, "sample_time_ms": 2637.277, "synch_weights_time_ms": 1.86}, "counters": {"num_env_steps_sampled": 868000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 217, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-30", "timestamp": 1702592250, "time_this_iter_s": 4.7229979038238525, "time_total_s": 1067.1095571517944, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1067.1095571517944, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 32.00000000000001, "ram_util_percent": 79.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1546638397507862}, "default_policy": {"total_loss": 0.1546638397507862, "policy_loss": -0.0066416939300522684, "vf_loss": 9.874604323779597, "vf_loss_unclipped": 5853.387388298506, "vf_explained_var": -9.661290182996152e-07, "entropy": 2.317807276620031, "mean_kl_loss": 0.010276377343419152, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 6.087698936462402}}, "num_env_steps_sampled": 872000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 872000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 807.3430944060992, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 872000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 5061.346, "sample_time_ms": 2646.96, "synch_weights_time_ms": 1.785}, "counters": {"num_env_steps_sampled": 872000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 218, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-35", "timestamp": 1702592255, "time_this_iter_s": 4.956381797790527, "time_total_s": 1072.065938949585, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1072.065938949585, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 34.885714285714286, "ram_util_percent": 79.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.28639053757479194}, "default_policy": {"total_loss": 0.28639053757479194, "policy_loss": 0.002051631929223805, "vf_loss": 9.56649577744734, "vf_loss_unclipped": 3032.757546268292, "vf_explained_var": -9.59012045789121e-07, "entropy": 2.063998106191916, "mean_kl_loss": 0.030992654245483305, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.131547927856445}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 876000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 843.7903497920375, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 876000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 5053.651, "sample_time_ms": 2632.721, "synch_weights_time_ms": 1.827}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 219, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-40", "timestamp": 1702592260, "time_this_iter_s": 4.742013216018677, "time_total_s": 1076.8079521656036, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1076.8079521656036, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 29.95714285714286, "ram_util_percent": 79.4857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.42271096386841495}, "default_policy": {"total_loss": 0.42271096386841495, "policy_loss": 0.006047250083915746, "vf_loss": 9.889760979203018, "vf_loss_unclipped": 8013.203548406996, "vf_explained_var": -9.618079992753865e-07, "entropy": 2.5096673988330083, "mean_kl_loss": 0.03479871156808574, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.697321891784668}}, "num_env_steps_sampled": 880000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 880000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 846.2362994028908, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 880000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 5037.434, "sample_time_ms": 2622.878, "synch_weights_time_ms": 1.846}, "counters": {"num_env_steps_sampled": 880000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 220, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-45", "timestamp": 1702592265, "time_this_iter_s": 4.728442907333374, "time_total_s": 1081.536395072937, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1081.536395072937, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 29.38571428571429, "ram_util_percent": 79.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17942872886528086}, "default_policy": {"total_loss": 0.17942872886528086, "policy_loss": -0.0027642068140375526, "vf_loss": 9.643691562640388, "vf_loss_unclipped": 5381.729778338597, "vf_explained_var": -9.585036906097998e-07, "entropy": 2.309930583815585, "mean_kl_loss": 0.006260787247334047, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.697321891784668}}, "num_env_steps_sampled": 884000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 884000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 857.9176387170581, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 884000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 884000, "timers": {"training_iteration_time_ms": 4796.557, "sample_time_ms": 2396.204, "synch_weights_time_ms": 1.833}, "counters": {"num_env_steps_sampled": 884000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 221, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-50", "timestamp": 1702592270, "time_this_iter_s": 4.664345979690552, "time_total_s": 1086.2007410526276, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1086.2007410526276, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 28.11428571428571, "ram_util_percent": 79.11428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2741861537948791}, "default_policy": {"total_loss": 0.2741861537948791, "policy_loss": 0.0005808525097204932, "vf_loss": 9.607817099801004, "vf_loss_unclipped": 7198.033701914968, "vf_explained_var": -9.597745785581024e-07, "entropy": 2.36989614424675, "mean_kl_loss": 0.012960718013896933, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.697321891784668}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 888000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 861.4741076628001, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 888000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 4773.197, "sample_time_ms": 2386.925, "synch_weights_time_ms": 1.848}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 222, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-54", "timestamp": 1702592274, "time_this_iter_s": 4.644995212554932, "time_total_s": 1090.8457362651825, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1090.8457362651825, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 29.666666666666668, "ram_util_percent": 79.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.792689639292578}, "default_policy": {"total_loss": 0.792689639292578, "policy_loss": 0.012924507863001465, "vf_loss": 9.414247352177146, "vf_loss_unclipped": 4653.798188418976, "vf_explained_var": -9.621892656598772e-07, "entropy": 2.1080548182479353, "mean_kl_loss": 0.05005523433431826, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 20.545982360839844}}, "num_env_steps_sampled": 892000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 892000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 846.3311962026414, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 892000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 892000, "timers": {"training_iteration_time_ms": 4774.122, "sample_time_ms": 2387.305, "synch_weights_time_ms": 1.88}, "counters": {"num_env_steps_sampled": 892000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 223, "trial_id": "0d28b_00000", "date": "2023-12-14_17-17-59", "timestamp": 1702592279, "time_this_iter_s": 4.728256940841675, "time_total_s": 1095.5739932060242, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1095.5739932060242, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 29.085714285714285, "ram_util_percent": 78.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5575556429559743}, "default_policy": {"total_loss": 0.5575556429559743, "policy_loss": 0.0037815175183030015, "vf_loss": 8.929330433355466, "vf_loss_unclipped": 1699.010453807774, "vf_explained_var": -9.577411578408183e-07, "entropy": 2.0270232607815055, "mean_kl_loss": 0.022606893042098734, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 30.818973541259766}}, "num_env_steps_sampled": 896000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 896000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 854.4812295651894, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 896000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 4759.221, "sample_time_ms": 2379.649, "synch_weights_time_ms": 1.877}, "counters": {"num_env_steps_sampled": 896000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 224, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-04", "timestamp": 1702592284, "time_this_iter_s": 4.683568239212036, "time_total_s": 1100.2575614452362, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1100.2575614452362, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 78.87142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.14414647196743216}, "default_policy": {"total_loss": 0.14414647196743216, "policy_loss": 0.0003055081422776302, "vf_loss": 8.647753821253014, "vf_loss_unclipped": 240.3619833012888, "vf_explained_var": -9.486543090104548e-07, "entropy": 1.866250018066943, "mean_kl_loss": 0.0018613022922144855, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 15.409486770629883}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 900000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 853.3325520840486, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 900000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 4741.874, "sample_time_ms": 2376.081, "synch_weights_time_ms": 1.871}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 225, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-08", "timestamp": 1702592288, "time_this_iter_s": 4.689656019210815, "time_total_s": 1104.947217464447, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1104.947217464447, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 29.916666666666668, "ram_util_percent": 78.71666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1346648086442241}, "default_policy": {"total_loss": 0.1346648086442241, "policy_loss": -0.00028842777710781295, "vf_loss": 8.578797464940086, "vf_loss_unclipped": 189.38644951696335, "vf_explained_var": -9.499251969587574e-07, "entropy": 1.6555903045607527, "mean_kl_loss": 0.0031905840865421, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 7.704743385314941}}, "num_env_steps_sampled": 904000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 904000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 859.4051816593811, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 904000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 4719.783, "sample_time_ms": 2373.027, "synch_weights_time_ms": 1.863}, "counters": {"num_env_steps_sampled": 904000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 226, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-13", "timestamp": 1702592293, "time_this_iter_s": 4.656665086746216, "time_total_s": 1109.6038825511932, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1109.6038825511932, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 27.671428571428574, "ram_util_percent": 78.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1523406565912179}, "default_policy": {"total_loss": 0.1523406565912179, "policy_loss": -0.0021512225053823197, "vf_loss": 8.582194101073341, "vf_loss_unclipped": 151.01357023243202, "vf_explained_var": -9.55199381944213e-07, "entropy": 1.191947585928923, "mean_kl_loss": 0.008912683698235488, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 7.704743385314941}}, "num_env_steps_sampled": 908000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -120473.93468630717, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102873831473968, "mean_inference_ms": 0.7506704062051773, "mean_action_processing_ms": 0.0451226484359572, "mean_env_wait_ms": 0.2850875710531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040084123611450195, "StateBufferConnector_ms": 0.002749760945638021, "ViewRequirementAgentConnector_ms": 0.18320182959238687}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 908000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 849.7153183917314, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 908000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 908000, "timers": {"training_iteration_time_ms": 4718.425, "sample_time_ms": 2376.225, "synch_weights_time_ms": 1.864}, "counters": {"num_env_steps_sampled": 908000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 24, "training_iteration": 227, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-18", "timestamp": 1702592298, "time_this_iter_s": 4.709861993789673, "time_total_s": 1114.313744544983, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1114.313744544983, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 27.78571428571429, "ram_util_percent": 78.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1275964189571009}, "default_policy": {"total_loss": 0.1275964189571009, "policy_loss": 0.0019847600857840417, "vf_loss": 8.507776449992459, "vf_loss_unclipped": 150.0710047862169, "vf_explained_var": -9.554535595338736e-07, "entropy": 1.7815767466894854, "mean_kl_loss": 0.0052609015844681285, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 7.704743385314941}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 912000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 582.0840331586213, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 912000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 4910.159, "sample_time_ms": 2579.435, "synch_weights_time_ms": 1.855}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 228, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-25", "timestamp": 1702592305, "time_this_iter_s": 6.873723745346069, "time_total_s": 1121.187468290329, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1121.187468290329, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 21.67777777777778, "ram_util_percent": 78.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.44025773583337474}, "default_policy": {"total_loss": 0.44025773583337474, "policy_loss": 0.014246814303906329, "vf_loss": 8.436803228057016, "vf_loss_unclipped": 152.8697452057145, "vf_explained_var": -9.546910267648921e-07, "entropy": 1.3244923365586347, "mean_kl_loss": 0.0443418909756092, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 11.55711555480957}}, "num_env_steps_sampled": 916000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 916000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 848.8397172742907, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 916000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 916000, "timers": {"training_iteration_time_ms": 4907.339, "sample_time_ms": 2578.557, "synch_weights_time_ms": 1.868}, "counters": {"num_env_steps_sampled": 916000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 229, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-29", "timestamp": 1702592309, "time_this_iter_s": 4.713779926300049, "time_total_s": 1125.901248216629, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1125.901248216629, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 27.88571428571429, "ram_util_percent": 78.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2876987847199699}, "default_policy": {"total_loss": 0.2876987847199699, "policy_loss": 0.004056592685615283, "vf_loss": 8.407255631265864, "vf_loss_unclipped": 161.3903245783564, "vf_explained_var": -9.565973586873459e-07, "entropy": 1.5737270422454581, "mean_kl_loss": 0.017268118164657377, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 11.55711555480957}}, "num_env_steps_sampled": 920000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 920000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 850.3739275679497, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 920000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 4905.039, "sample_time_ms": 2577.467, "synch_weights_time_ms": 1.858}, "counters": {"num_env_steps_sampled": 920000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 230, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-34", "timestamp": 1702592314, "time_this_iter_s": 4.705552816390991, "time_total_s": 1130.60680103302, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1130.60680103302, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 27.814285714285717, "ram_util_percent": 78.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.5293981481625486}, "default_policy": {"total_loss": 0.5293981481625486, "policy_loss": 0.01250093256675406, "vf_loss": 8.576961600704234, "vf_loss_unclipped": 143.16073723083366, "vf_explained_var": -9.55707737123534e-07, "entropy": 1.0530786398949146, "mean_kl_loss": 0.037304083230897525, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 17.335674285888672}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 924000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 843.4059144730955, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 924000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 4913.06, "sample_time_ms": 2584.149, "synch_weights_time_ms": 1.877}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 231, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-39", "timestamp": 1702592319, "time_this_iter_s": 4.744709253311157, "time_total_s": 1135.3515102863312, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1135.3515102863312, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 28.971428571428568, "ram_util_percent": 78.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1151970392748364}, "default_policy": {"total_loss": 0.1151970392748364, "policy_loss": -0.0016083393999532277, "vf_loss": 8.466789478940496, "vf_loss_unclipped": 190.0713423503233, "vf_explained_var": -9.530388724320987e-07, "entropy": 1.6417980342785687, "mean_kl_loss": 0.001853835341737808, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.667837142944336}}, "num_env_steps_sampled": 928000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 928000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 854.0582976750641, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 928000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 4917.091, "sample_time_ms": 2588.722, "synch_weights_time_ms": 1.876}, "counters": {"num_env_steps_sampled": 928000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 232, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-44", "timestamp": 1702592324, "time_this_iter_s": 4.68575119972229, "time_total_s": 1140.0372614860535, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1140.0372614860535, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 29.933333333333334, "ram_util_percent": 78.71666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.14475405705409614}, "default_policy": {"total_loss": 0.14475405705409614, "policy_loss": -1.0891926230620474e-05, "vf_loss": 8.330623407607902, "vf_loss_unclipped": 210.41731810010572, "vf_explained_var": -9.540555827907407e-07, "entropy": 1.7143436170844382, "mean_kl_loss": 0.007090432846456125, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.667837142944336}}, "num_env_steps_sampled": 932000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 932000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 851.8384739670405, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 932000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 932000, "timers": {"training_iteration_time_ms": 4914.035, "sample_time_ms": 2591.379, "synch_weights_time_ms": 1.816}, "counters": {"num_env_steps_sampled": 932000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 233, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-48", "timestamp": 1702592328, "time_this_iter_s": 4.698429822921753, "time_total_s": 1144.7356913089752, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1144.7356913089752, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 27.700000000000006, "ram_util_percent": 78.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1439741554954}, "default_policy": {"total_loss": 0.1439741554954, "policy_loss": -0.0075775513302352125, "vf_loss": 8.921440346662932, "vf_loss_unclipped": 544.6961214110287, "vf_explained_var": -9.54182671585571e-07, "entropy": 1.8529757972973495, "mean_kl_loss": 0.00719179499639086, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.667837142944336}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 936000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 858.4262221402654, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 936000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 4911.884, "sample_time_ms": 2600.095, "synch_weights_time_ms": 1.794}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 234, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-53", "timestamp": 1702592333, "time_this_iter_s": 4.6622350215911865, "time_total_s": 1149.3979263305664, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1149.3979263305664, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 27.985714285714284, "ram_util_percent": 78.61428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.7163967911972166}, "default_policy": {"total_loss": 0.7163967911972166, "policy_loss": 0.01996884626576673, "vf_loss": 9.455288453396959, "vf_loss_unclipped": 4012.4738032456908, "vf_explained_var": -9.624434432495378e-07, "entropy": 2.08250324507512, "mean_kl_loss": 0.06943774450686187, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.001755714416504}}, "num_env_steps_sampled": 940000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 940000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 844.8914663082148, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 940000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 940000, "timers": {"training_iteration_time_ms": 4916.567, "sample_time_ms": 2606.664, "synch_weights_time_ms": 1.778}, "counters": {"num_env_steps_sampled": 940000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 235, "trial_id": "0d28b_00000", "date": "2023-12-14_17-18-58", "timestamp": 1702592338, "time_this_iter_s": 4.736233949661255, "time_total_s": 1154.1341602802277, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1154.1341602802277, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 30.98333333333333, "ram_util_percent": 78.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.275187683845761}, "default_policy": {"total_loss": 0.275187683845761, "policy_loss": 8.252035997220194e-05, "vf_loss": 9.363905708418725, "vf_loss_unclipped": 2868.8230961065556, "vf_explained_var": -9.605371113270839e-07, "entropy": 2.110664471888593, "mean_kl_loss": 0.013957046581262688, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 13.001755714416504}}, "num_env_steps_sampled": 944000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 944000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 845.3011920472677, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 944000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 4924.333, "sample_time_ms": 2612.348, "synch_weights_time_ms": 1.821}, "counters": {"num_env_steps_sampled": 944000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 236, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-02", "timestamp": 1702592342, "time_this_iter_s": 4.733666896820068, "time_total_s": 1158.8678271770477, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1158.8678271770477, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 28.185714285714287, "ram_util_percent": 78.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1422713658472559}, "default_policy": {"total_loss": 0.1422713658472559, "policy_loss": -0.004549410310325655, "vf_loss": 9.755670779295313, "vf_loss_unclipped": 5529.3748877877115, "vf_explained_var": -0.0028453697400814943, "entropy": 2.3654828558344323, "mean_kl_loss": 0.003789031985236321, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 6.500877857208252}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 948000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 844.3257405721403, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 948000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 4927.338, "sample_time_ms": 2615.14, "synch_weights_time_ms": 1.84}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 237, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-07", "timestamp": 1702592347, "time_this_iter_s": 4.739187002182007, "time_total_s": 1163.6070141792297, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1163.6070141792297, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 27.95714285714286, "ram_util_percent": 78.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.22849607489494753}, "default_policy": {"total_loss": 0.22849607489494753, "policy_loss": 0.0014369839267221404, "vf_loss": 9.660673695586638, "vf_loss_unclipped": 4847.045445017215, "vf_explained_var": 0.004443016769026897, "entropy": 2.332442706327703, "mean_kl_loss": 0.0200668827075171, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.751317024230957}}, "num_env_steps_sampled": 952000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 952000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 841.3954617587752, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 952000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 4715.553, "sample_time_ms": 2400.525, "synch_weights_time_ms": 1.843}, "counters": {"num_env_steps_sampled": 952000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 238, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-12", "timestamp": 1702592352, "time_this_iter_s": 4.756373167037964, "time_total_s": 1168.3633873462677, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1168.3633873462677, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 28.6, "ram_util_percent": 78.72857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24385717131102136}, "default_policy": {"total_loss": 0.24385717131102136, "policy_loss": -0.0006243828649340725, "vf_loss": 9.745075298016513, "vf_loss_unclipped": 5435.027081064578, "vf_explained_var": 2.3870135167005982e-05, "entropy": 2.3835172367248454, "mean_kl_loss": 0.015078045176708875, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.751317024230957}}, "num_env_steps_sampled": 956000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 956000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 848.3573546457725, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 956000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 956000, "timers": {"training_iteration_time_ms": 4715.821, "sample_time_ms": 2400.989, "synch_weights_time_ms": 1.794}, "counters": {"num_env_steps_sampled": 956000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 239, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-17", "timestamp": 1702592357, "time_this_iter_s": 4.717052936553955, "time_total_s": 1173.0804402828217, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1173.0804402828217, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 30.099999999999998, "ram_util_percent": 78.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.2827490960388804}, "default_policy": {"total_loss": 0.2827490960388804, "policy_loss": -0.001642945743819226, "vf_loss": 9.435092239745899, "vf_loss_unclipped": 4504.641118942293, "vf_explained_var": -0.00024754171178284994, "entropy": 2.2500361200334673, "mean_kl_loss": 0.019488763829781566, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.751317024230957}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 960000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 841.5717973092621, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 960000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 4720.741, "sample_time_ms": 2406.25, "synch_weights_time_ms": 1.77}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 240, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-21", "timestamp": 1702592361, "time_this_iter_s": 4.754613161087036, "time_total_s": 1177.8350534439087, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1177.8350534439087, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 29.185714285714287, "ram_util_percent": 78.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.23577856484538456}, "default_policy": {"total_loss": 0.23577856484538456, "policy_loss": -0.002269055710227759, "vf_loss": 9.080867509089554, "vf_loss_unclipped": 1037.80274802332, "vf_explained_var": -0.0002939950174360133, "entropy": 1.848432080450851, "mean_kl_loss": 0.015099391524046935, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.751317024230957}}, "num_env_steps_sampled": 964000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 964000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 839.8119290001891, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 964000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 964000, "timers": {"training_iteration_time_ms": 4722.771, "sample_time_ms": 2406.536, "synch_weights_time_ms": 1.786}, "counters": {"num_env_steps_sampled": 964000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 241, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-26", "timestamp": 1702592366, "time_this_iter_s": 4.764373779296875, "time_total_s": 1182.5994272232056, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1182.5994272232056, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 28.014285714285712, "ram_util_percent": 78.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.17564122118095535}, "default_policy": {"total_loss": 0.17564122118095535, "policy_loss": -0.004772594628998561, "vf_loss": 8.574862988010398, "vf_loss_unclipped": 448.7712738142847, "vf_explained_var": 0.0005230300589156812, "entropy": 1.5961088571212947, "mean_kl_loss": 0.009707938847583789, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 9.751317024230957}}, "num_env_steps_sampled": 968000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 968000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 814.9698369833574, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 968000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 4745.235, "sample_time_ms": 2429.417, "synch_weights_time_ms": 1.812}, "counters": {"num_env_steps_sampled": 968000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 242, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-31", "timestamp": 1702592371, "time_this_iter_s": 4.909738063812256, "time_total_s": 1187.5091652870178, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1187.5091652870178, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 30.14285714285714, "ram_util_percent": 78.1857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.10008498201214237}, "default_policy": {"total_loss": 0.10008498201214237, "policy_loss": -0.002596979948884643, "vf_loss": 8.28351447831339, "vf_loss_unclipped": 165.69558710940103, "vf_explained_var": 0.0014354615831680135, "entropy": 1.471916873826147, "mean_kl_loss": 0.0020352965024753727, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 4.8756585121154785}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 972000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 847.8850097356182, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 972000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 4747.425, "sample_time_ms": 2429.252, "synch_weights_time_ms": 1.872}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 243, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-36", "timestamp": 1702592376, "time_this_iter_s": 4.718858003616333, "time_total_s": 1192.2280232906342, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1192.2280232906342, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 27.61428571428571, "ram_util_percent": 78.11428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.1285692627088967}, "default_policy": {"total_loss": 0.1285692627088967, "policy_loss": -0.0005856030809281986, "vf_loss": 8.531743857397961, "vf_loss_unclipped": 187.54801562701715, "vf_explained_var": 0.002296126473432919, "entropy": 1.1336417299216743, "mean_kl_loss": 0.008991077976461695, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 4.8756585121154785}}, "num_env_steps_sampled": 976000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 976000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 849.4890118742625, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 976000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 4752.327, "sample_time_ms": 2427.865, "synch_weights_time_ms": 1.874}, "counters": {"num_env_steps_sampled": 976000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 244, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-41", "timestamp": 1702592381, "time_this_iter_s": 4.710244178771973, "time_total_s": 1196.9382674694061, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1196.9382674694061, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 30.41666666666666, "ram_util_percent": 78.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.4802869916943186}, "default_policy": {"total_loss": 0.4802869916943186, "policy_loss": 0.017128301013920353, "vf_loss": 8.43664388920961, "vf_loss_unclipped": 147.9381450091852, "vf_explained_var": 0.0002932474176004243, "entropy": 1.0977908814036008, "mean_kl_loss": 0.07769048029586857, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 7.313488006591797}}, "num_env_steps_sampled": 980000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119838.6557284897, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910989056217375, "mean_inference_ms": 0.750959159702166, "mean_action_processing_ms": 0.04513579567314982, "mean_env_wait_ms": 0.2836471618021706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405586682833158, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.18109449973473182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 980000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 854.2859581169513, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 980000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 980000, "timers": {"training_iteration_time_ms": 4747.121, "sample_time_ms": 2422.906, "synch_weights_time_ms": 1.876}, "counters": {"num_env_steps_sampled": 980000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 245, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-45", "timestamp": 1702592385, "time_this_iter_s": 4.6844940185546875, "time_total_s": 1201.6227614879608, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1201.6227614879608, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 27.24285714285714, "ram_util_percent": 78.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.11493934585210452}, "default_policy": {"total_loss": 0.11493934585210452, "policy_loss": -6.720353402435653e-05, "vf_loss": 8.22661969249945, "vf_loss_unclipped": 140.77205237854264, "vf_explained_var": -0.00042098455591750805, "entropy": 1.3133524756378203, "mean_kl_loss": 0.004476708731447001, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 3.6567440032958984}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119946.95299484675, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232, -121289.93584997908, -121419.69906499804], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1911525628317717, "mean_inference_ms": 0.751166011978935, "mean_action_processing_ms": 0.04514281465982777, "mean_env_wait_ms": 0.2824290999229598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120383943830218, "StateBufferConnector_ms": 0.002793754850115095, "ViewRequirementAgentConnector_ms": 0.18094778060913086}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119946.95299484675, "episode_len_mean": 35039.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232, -121289.93584997908, -121419.69906499804], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1911525628317717, "mean_inference_ms": 0.751166011978935, "mean_action_processing_ms": 0.04514281465982777, "mean_env_wait_ms": 0.2824290999229598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120383943830218, "StateBufferConnector_ms": 0.002793754850115095, "ViewRequirementAgentConnector_ms": 0.18094778060913086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 984000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 583.6825717800816, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 984000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 4959.22, "sample_time_ms": 2636.856, "synch_weights_time_ms": 1.861}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 246, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-52", "timestamp": 1702592392, "time_this_iter_s": 6.854701042175293, "time_total_s": 1208.477462530136, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1208.477462530136, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 20.529999999999998, "ram_util_percent": 78.61999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.24206129263149206}, "default_policy": {"total_loss": 0.24206129263149206, "policy_loss": 0.017163808060400902, "vf_loss": 8.519486585913945, "vf_loss_unclipped": 150.94921840025162, "vf_explained_var": 0.0010701077325003488, "entropy": 0.9623233712177033, "mean_kl_loss": 0.03820410167522319, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 5.485116004943848}}, "num_env_steps_sampled": 988000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119946.95299484675, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232, -121289.93584997908, -121419.69906499804], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1911525628317717, "mean_inference_ms": 0.751166011978935, "mean_action_processing_ms": 0.04514281465982777, "mean_env_wait_ms": 0.2824290999229598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120383943830218, "StateBufferConnector_ms": 0.002793754850115095, "ViewRequirementAgentConnector_ms": 0.18094778060913086}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119946.95299484675, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232, -121289.93584997908, -121419.69906499804], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1911525628317717, "mean_inference_ms": 0.751166011978935, "mean_action_processing_ms": 0.04514281465982777, "mean_env_wait_ms": 0.2824290999229598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120383943830218, "StateBufferConnector_ms": 0.002793754850115095, "ViewRequirementAgentConnector_ms": 0.18094778060913086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 988000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 854.8901179449862, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 988000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 988000, "timers": {"training_iteration_time_ms": 4953.366, "sample_time_ms": 2633.078, "synch_weights_time_ms": 1.85}, "counters": {"num_env_steps_sampled": 988000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 247, "trial_id": "0d28b_00000", "date": "2023-12-14_17-19-57", "timestamp": 1702592397, "time_this_iter_s": 4.680778980255127, "time_total_s": 1213.1582415103912, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1213.1582415103912, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 27.71428571428571, "ram_util_percent": 78.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.3408584123783147}, "default_policy": {"total_loss": 0.3408584123783147, "policy_loss": 0.016331004289620275, "vf_loss": 8.443251451703786, "vf_loss_unclipped": 148.72579134146034, "vf_explained_var": 8.991405145445866e-05, "entropy": 0.9843006466688123, "mean_kl_loss": 0.04377207187638466, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 8.22767448425293}}, "num_env_steps_sampled": 992000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119946.95299484675, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232, -121289.93584997908, -121419.69906499804], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1911525628317717, "mean_inference_ms": 0.751166011978935, "mean_action_processing_ms": 0.04514281465982777, "mean_env_wait_ms": 0.2824290999229598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120383943830218, "StateBufferConnector_ms": 0.002793754850115095, "ViewRequirementAgentConnector_ms": 0.18094778060913086}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119946.95299484675, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232, -121289.93584997908, -121419.69906499804], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1911525628317717, "mean_inference_ms": 0.751166011978935, "mean_action_processing_ms": 0.04514281465982777, "mean_env_wait_ms": 0.2824290999229598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120383943830218, "StateBufferConnector_ms": 0.002793754850115095, "ViewRequirementAgentConnector_ms": 0.18094778060913086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 992000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 854.3398141874293, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 992000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 4946.162, "sample_time_ms": 2624.802, "synch_weights_time_ms": 1.846}, "counters": {"num_env_steps_sampled": 992000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 248, "trial_id": "0d28b_00000", "date": "2023-12-14_17-20-02", "timestamp": 1702592402, "time_this_iter_s": 4.683142900466919, "time_total_s": 1217.8413844108582, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1217.8413844108582, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 29.866666666666664, "ram_util_percent": 78.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.11407086631354652}, "default_policy": {"total_loss": 0.11407086631354652, "policy_loss": -0.0005426076786922239, "vf_loss": 8.646289170169627, "vf_loss_unclipped": 172.49462788953963, "vf_explained_var": -0.00017977281928316616, "entropy": 0.8672281286355529, "mean_kl_loss": 0.003421450807558589, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 4.113837242126465}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119946.95299484675, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232, -121289.93584997908, -121419.69906499804], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1911525628317717, "mean_inference_ms": 0.751166011978935, "mean_action_processing_ms": 0.04514281465982777, "mean_env_wait_ms": 0.2824290999229598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120383943830218, "StateBufferConnector_ms": 0.002793754850115095, "ViewRequirementAgentConnector_ms": 0.18094778060913086}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119946.95299484675, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232, -121289.93584997908, -121419.69906499804], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1911525628317717, "mean_inference_ms": 0.751166011978935, "mean_action_processing_ms": 0.04514281465982777, "mean_env_wait_ms": 0.2824290999229598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120383943830218, "StateBufferConnector_ms": 0.002793754850115095, "ViewRequirementAgentConnector_ms": 0.18094778060913086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 996000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 853.9088079684235, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 996000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 4943.097, "sample_time_ms": 2622.792, "synch_weights_time_ms": 1.91}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 28, "training_iteration": 249, "trial_id": "0d28b_00000", "date": "2023-12-14_17-20-06", "timestamp": 1702592406, "time_this_iter_s": 4.685871839523315, "time_total_s": 1222.5272562503815, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1222.5272562503815, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 28.114285714285717, "ram_util_percent": 78.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 0.11814449420635666}, "default_policy": {"total_loss": 0.11814449420635666, "policy_loss": 0.0001459366042238436, "vf_loss": 8.280565369612118, "vf_loss_unclipped": 176.27888812083424, "vf_explained_var": 0.0018939180160636334, "entropy": 1.387271919357243, "mean_kl_loss": 0.008554763607295126, "default_optimizer_lr": 0.003, "curr_lr": 0.003, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 4.113837242126465}}, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119946.95299484675, "episode_len_mean": 35039.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232, -121289.93584997908, -121419.69906499804], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1911525628317717, "mean_inference_ms": 0.751166011978935, "mean_action_processing_ms": 0.04514281465982777, "mean_env_wait_ms": 0.2824290999229598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120383943830218, "StateBufferConnector_ms": 0.002793754850115095, "ViewRequirementAgentConnector_ms": 0.18094778060913086}}, "episode_reward_max": -110283.58087642223, "episode_reward_min": -142918.1014036208, "episode_reward_mean": -119946.95299484675, "episode_len_mean": 35039.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-142918.1014036208, -142082.91449141712, -131663.65053870084, -131500.6084504827, -126582.81184586037, -126142.6957084097, -122433.15920061221, -122817.9551145368, -121873.35183508614, -122448.00886868805, -123640.70026902693, -124136.34804938475, -115723.14656819163, -115773.68169372965, -114869.01516643351, -115347.42077148329, -112892.49221050502, -112891.50637128027, -111487.71323626627, -111502.32458105711, -110392.37601802147, -110283.58087642223, -110709.42355527462, -111261.44564688047, -112185.76679319753, -112244.84967616232, -121289.93584997908, -121419.69906499804], "episode_lengths": [35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039, 35039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1911525628317717, "mean_inference_ms": 0.751166011978935, "mean_action_processing_ms": 0.04514281465982777, "mean_env_wait_ms": 0.2824290999229598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120383943830218, "StateBufferConnector_ms": 0.002793754850115095, "ViewRequirementAgentConnector_ms": 0.18094778060913086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 858.8326527482317, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1000000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 4933.544, "sample_time_ms": 2614.369, "synch_weights_time_ms": 1.961}, "counters": {"num_env_steps_sampled": 1000000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 0}, "done": true, "episodes_total": 28, "training_iteration": 250, "trial_id": "0d28b_00000", "date": "2023-12-14_17-20-11", "timestamp": 1702592411, "time_this_iter_s": 4.659243106842041, "time_total_s": 1227.1864993572235, "pid": 33010, "hostname": "dhcp-vl2041-20415.eduroam.cornell.edu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class '__main__.EnergyPlusEnv'>", "env_config": {"idf": "models/datacenter.idf", "epw": "models/weather/LUX_LU_Luxembourg.AP.065900_TMYx.2004-2018.epw", "csv": false, "output": "/var/folders/08/893lwtz12fb0vd7w3h3k1mch0000gn/T/tmptka7_wjj", "timesteps": 1000000.0, "num_workers": 2, "num_gpus": 0, "alg": "PPO", "framework": "torch", "use_lstm": false}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.95, "lr": 0.003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f2ab6a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.3, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1227.1864993572235, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 27.27142857142857, "ram_util_percent": 78.7}}
